import{g as ai,a as hi,r as X,o as sr,j as Q,P as on,u as Di,b as nr,c as an,d as li,e as as,f as ci,s as jt,h as hn,i as hs,k as Be,l as nt,B as ln,m as cn,n as Ae,p as Ti,C as ls,q as un,t as We,v as fn,w as or,x as dn,y as ze,G as pn,T as _n,z as ar,A as vn,D as se}from"./index-CUvxblkU.js";var gt="top",kt="bottom",Bt="right",mt="left",Wi="auto",Pe=[gt,kt,Bt,mt],fe="start",Re="end",gn="clippingParents",cs="viewport",me="popper",mn="reference",hr=Pe.reduce(function(i,t){return i.concat([t+"-"+fe,t+"-"+Re])},[]),us=[].concat(Pe,[Wi]).reduce(function(i,t){return i.concat([t,t+"-"+fe,t+"-"+Re])},[]),yn="beforeRead",Sn="read",bn="afterRead",wn="beforeMain",Cn="main",En="afterMain",Mn="beforeWrite",xn="write",kn="afterWrite",Bn=[yn,Sn,bn,wn,Cn,En,Mn,xn,kn];function Nt(i){return i?(i.nodeName||"").toLowerCase():null}function St(i){if(i==null)return window;if(i.toString()!=="[object Window]"){var t=i.ownerDocument;return t&&t.defaultView||window}return i}function te(i){var t=St(i).Element;return i instanceof t||i instanceof Element}function xt(i){var t=St(i).HTMLElement;return i instanceof t||i instanceof HTMLElement}function zi(i){if(typeof ShadowRoot>"u")return!1;var t=St(i).ShadowRoot;return i instanceof t||i instanceof ShadowRoot}function Rn(i){var t=i.state;Object.keys(t.elements).forEach(function(e){var r=t.styles[e]||{},s=t.attributes[e]||{},d=t.elements[e];!xt(d)||!Nt(d)||(Object.assign(d.style,r),Object.keys(s).forEach(function(_){var n=s[_];n===!1?d.removeAttribute(_):d.setAttribute(_,n===!0?"":n)}))})}function Ln(i){var t=i.state,e={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,e.popper),t.styles=e,t.elements.arrow&&Object.assign(t.elements.arrow.style,e.arrow),function(){Object.keys(t.elements).forEach(function(r){var s=t.elements[r],d=t.attributes[r]||{},_=Object.keys(t.styles.hasOwnProperty(r)?t.styles[r]:e[r]),n=_.reduce(function(a,u){return a[u]="",a},{});!xt(s)||!Nt(s)||(Object.assign(s.style,n),Object.keys(d).forEach(function(a){s.removeAttribute(a)}))})}}const Dn={name:"applyStyles",enabled:!0,phase:"write",fn:Rn,effect:Ln,requires:["computeStyles"]};function Wt(i){return i.split("-")[0]}var Qt=Math.max,ei=Math.min,de=Math.round;function Ai(){var i=navigator.userAgentData;return i!=null&&i.brands&&Array.isArray(i.brands)?i.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function fs(){return!/^((?!chrome|android).)*safari/i.test(Ai())}function pe(i,t,e){t===void 0&&(t=!1),e===void 0&&(e=!1);var r=i.getBoundingClientRect(),s=1,d=1;t&&xt(i)&&(s=i.offsetWidth>0&&de(r.width)/i.offsetWidth||1,d=i.offsetHeight>0&&de(r.height)/i.offsetHeight||1);var _=te(i)?St(i):window,n=_.visualViewport,a=!fs()&&e,u=(r.left+(a&&n?n.offsetLeft:0))/s,p=(r.top+(a&&n?n.offsetTop:0))/d,c=r.width/s,g=r.height/d;return{width:c,height:g,top:p,right:u+c,bottom:p+g,left:u,x:u,y:p}}function Ni(i){var t=pe(i),e=i.offsetWidth,r=i.offsetHeight;return Math.abs(t.width-e)<=1&&(e=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:i.offsetLeft,y:i.offsetTop,width:e,height:r}}function ds(i,t){var e=t.getRootNode&&t.getRootNode();if(i.contains(t))return!0;if(e&&zi(e)){var r=t;do{if(r&&i.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Xt(i){return St(i).getComputedStyle(i)}function Tn(i){return["table","td","th"].indexOf(Nt(i))>=0}function Yt(i){return((te(i)?i.ownerDocument:i.document)||window.document).documentElement}function ui(i){return Nt(i)==="html"?i:i.assignedSlot||i.parentNode||(zi(i)?i.host:null)||Yt(i)}function lr(i){return!xt(i)||Xt(i).position==="fixed"?null:i.offsetParent}function An(i){var t=/firefox/i.test(Ai()),e=/Trident/i.test(Ai());if(e&&xt(i)){var r=Xt(i);if(r.position==="fixed")return null}var s=ui(i);for(zi(s)&&(s=s.host);xt(s)&&["html","body"].indexOf(Nt(s))<0;){var d=Xt(s);if(d.transform!=="none"||d.perspective!=="none"||d.contain==="paint"||["transform","perspective"].indexOf(d.willChange)!==-1||t&&d.willChange==="filter"||t&&d.filter&&d.filter!=="none")return s;s=s.parentNode}return null}function Oe(i){for(var t=St(i),e=lr(i);e&&Tn(e)&&Xt(e).position==="static";)e=lr(e);return e&&(Nt(e)==="html"||Nt(e)==="body"&&Xt(e).position==="static")?t:e||An(i)||t}function $i(i){return["top","bottom"].indexOf(i)>=0?"x":"y"}function we(i,t,e){return Qt(i,ei(t,e))}function Pn(i,t,e){var r=we(i,t,e);return r>e?e:r}function ps(){return{top:0,right:0,bottom:0,left:0}}function _s(i){return Object.assign({},ps(),i)}function vs(i,t){return t.reduce(function(e,r){return e[r]=i,e},{})}var On=function(t,e){return t=typeof t=="function"?t(Object.assign({},e.rects,{placement:e.placement})):t,_s(typeof t!="number"?t:vs(t,Pe))};function In(i){var t,e=i.state,r=i.name,s=i.options,d=e.elements.arrow,_=e.modifiersData.popperOffsets,n=Wt(e.placement),a=$i(n),u=[mt,Bt].indexOf(n)>=0,p=u?"height":"width";if(!(!d||!_)){var c=On(s.padding,e),g=Ni(d),S=a==="y"?gt:mt,w=a==="y"?kt:Bt,m=e.rects.reference[p]+e.rects.reference[a]-_[a]-e.rects.popper[p],o=_[a]-e.rects.reference[a],h=Oe(d),l=h?a==="y"?h.clientHeight||0:h.clientWidth||0:0,f=m/2-o/2,v=c[S],b=l-g[p]-c[w],C=l/2-g[p]/2+f,M=we(v,C,b),y=a;e.modifiersData[r]=(t={},t[y]=M,t.centerOffset=M-C,t)}}function Hn(i){var t=i.state,e=i.options,r=e.element,s=r===void 0?"[data-popper-arrow]":r;s!=null&&(typeof s=="string"&&(s=t.elements.popper.querySelector(s),!s)||ds(t.elements.popper,s)&&(t.elements.arrow=s))}const Fn={name:"arrow",enabled:!0,phase:"main",fn:In,effect:Hn,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function _e(i){return i.split("-")[1]}var Wn={top:"auto",right:"auto",bottom:"auto",left:"auto"};function zn(i,t){var e=i.x,r=i.y,s=t.devicePixelRatio||1;return{x:de(e*s)/s||0,y:de(r*s)/s||0}}function cr(i){var t,e=i.popper,r=i.popperRect,s=i.placement,d=i.variation,_=i.offsets,n=i.position,a=i.gpuAcceleration,u=i.adaptive,p=i.roundOffsets,c=i.isFixed,g=_.x,S=g===void 0?0:g,w=_.y,m=w===void 0?0:w,o=typeof p=="function"?p({x:S,y:m}):{x:S,y:m};S=o.x,m=o.y;var h=_.hasOwnProperty("x"),l=_.hasOwnProperty("y"),f=mt,v=gt,b=window;if(u){var C=Oe(e),M="clientHeight",y="clientWidth";if(C===St(e)&&(C=Yt(e),Xt(C).position!=="static"&&n==="absolute"&&(M="scrollHeight",y="scrollWidth")),C=C,s===gt||(s===mt||s===Bt)&&d===Re){v=kt;var E=c&&C===b&&b.visualViewport?b.visualViewport.height:C[M];m-=E-r.height,m*=a?1:-1}if(s===mt||(s===gt||s===kt)&&d===Re){f=Bt;var B=c&&C===b&&b.visualViewport?b.visualViewport.width:C[y];S-=B-r.width,S*=a?1:-1}}var T=Object.assign({position:n},u&&Wn),R=p===!0?zn({x:S,y:m},St(e)):{x:S,y:m};if(S=R.x,m=R.y,a){var D;return Object.assign({},T,(D={},D[v]=l?"0":"",D[f]=h?"0":"",D.transform=(b.devicePixelRatio||1)<=1?"translate("+S+"px, "+m+"px)":"translate3d("+S+"px, "+m+"px, 0)",D))}return Object.assign({},T,(t={},t[v]=l?m+"px":"",t[f]=h?S+"px":"",t.transform="",t))}function Nn(i){var t=i.state,e=i.options,r=e.gpuAcceleration,s=r===void 0?!0:r,d=e.adaptive,_=d===void 0?!0:d,n=e.roundOffsets,a=n===void 0?!0:n,u={placement:Wt(t.placement),variation:_e(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:s,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,cr(Object.assign({},u,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:_,roundOffsets:a})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,cr(Object.assign({},u,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:a})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const $n={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Nn,data:{}};var Ne={passive:!0};function jn(i){var t=i.state,e=i.instance,r=i.options,s=r.scroll,d=s===void 0?!0:s,_=r.resize,n=_===void 0?!0:_,a=St(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return d&&u.forEach(function(p){p.addEventListener("scroll",e.update,Ne)}),n&&a.addEventListener("resize",e.update,Ne),function(){d&&u.forEach(function(p){p.removeEventListener("scroll",e.update,Ne)}),n&&a.removeEventListener("resize",e.update,Ne)}}const Un={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:jn,data:{}};var Vn={left:"right",right:"left",bottom:"top",top:"bottom"};function Ze(i){return i.replace(/left|right|bottom|top/g,function(t){return Vn[t]})}var Kn={start:"end",end:"start"};function ur(i){return i.replace(/start|end/g,function(t){return Kn[t]})}function ji(i){var t=St(i),e=t.pageXOffset,r=t.pageYOffset;return{scrollLeft:e,scrollTop:r}}function Ui(i){return pe(Yt(i)).left+ji(i).scrollLeft}function Gn(i,t){var e=St(i),r=Yt(i),s=e.visualViewport,d=r.clientWidth,_=r.clientHeight,n=0,a=0;if(s){d=s.width,_=s.height;var u=fs();(u||!u&&t==="fixed")&&(n=s.offsetLeft,a=s.offsetTop)}return{width:d,height:_,x:n+Ui(i),y:a}}function Xn(i){var t,e=Yt(i),r=ji(i),s=(t=i.ownerDocument)==null?void 0:t.body,d=Qt(e.scrollWidth,e.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),_=Qt(e.scrollHeight,e.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),n=-r.scrollLeft+Ui(i),a=-r.scrollTop;return Xt(s||e).direction==="rtl"&&(n+=Qt(e.clientWidth,s?s.clientWidth:0)-d),{width:d,height:_,x:n,y:a}}function Vi(i){var t=Xt(i),e=t.overflow,r=t.overflowX,s=t.overflowY;return/auto|scroll|overlay|hidden/.test(e+s+r)}function gs(i){return["html","body","#document"].indexOf(Nt(i))>=0?i.ownerDocument.body:xt(i)&&Vi(i)?i:gs(ui(i))}function Ce(i,t){var e;t===void 0&&(t=[]);var r=gs(i),s=r===((e=i.ownerDocument)==null?void 0:e.body),d=St(r),_=s?[d].concat(d.visualViewport||[],Vi(r)?r:[]):r,n=t.concat(_);return s?n:n.concat(Ce(ui(_)))}function Pi(i){return Object.assign({},i,{left:i.x,top:i.y,right:i.x+i.width,bottom:i.y+i.height})}function qn(i,t){var e=pe(i,!1,t==="fixed");return e.top=e.top+i.clientTop,e.left=e.left+i.clientLeft,e.bottom=e.top+i.clientHeight,e.right=e.left+i.clientWidth,e.width=i.clientWidth,e.height=i.clientHeight,e.x=e.left,e.y=e.top,e}function fr(i,t,e){return t===cs?Pi(Gn(i,e)):te(t)?qn(t,e):Pi(Xn(Yt(i)))}function Yn(i){var t=Ce(ui(i)),e=["absolute","fixed"].indexOf(Xt(i).position)>=0,r=e&&xt(i)?Oe(i):i;return te(r)?t.filter(function(s){return te(s)&&ds(s,r)&&Nt(s)!=="body"}):[]}function Jn(i,t,e,r){var s=t==="clippingParents"?Yn(i):[].concat(t),d=[].concat(s,[e]),_=d[0],n=d.reduce(function(a,u){var p=fr(i,u,r);return a.top=Qt(p.top,a.top),a.right=ei(p.right,a.right),a.bottom=ei(p.bottom,a.bottom),a.left=Qt(p.left,a.left),a},fr(i,_,r));return n.width=n.right-n.left,n.height=n.bottom-n.top,n.x=n.left,n.y=n.top,n}function ms(i){var t=i.reference,e=i.element,r=i.placement,s=r?Wt(r):null,d=r?_e(r):null,_=t.x+t.width/2-e.width/2,n=t.y+t.height/2-e.height/2,a;switch(s){case gt:a={x:_,y:t.y-e.height};break;case kt:a={x:_,y:t.y+t.height};break;case Bt:a={x:t.x+t.width,y:n};break;case mt:a={x:t.x-e.width,y:n};break;default:a={x:t.x,y:t.y}}var u=s?$i(s):null;if(u!=null){var p=u==="y"?"height":"width";switch(d){case fe:a[u]=a[u]-(t[p]/2-e[p]/2);break;case Re:a[u]=a[u]+(t[p]/2-e[p]/2);break}}return a}function Le(i,t){t===void 0&&(t={});var e=t,r=e.placement,s=r===void 0?i.placement:r,d=e.strategy,_=d===void 0?i.strategy:d,n=e.boundary,a=n===void 0?gn:n,u=e.rootBoundary,p=u===void 0?cs:u,c=e.elementContext,g=c===void 0?me:c,S=e.altBoundary,w=S===void 0?!1:S,m=e.padding,o=m===void 0?0:m,h=_s(typeof o!="number"?o:vs(o,Pe)),l=g===me?mn:me,f=i.rects.popper,v=i.elements[w?l:g],b=Jn(te(v)?v:v.contextElement||Yt(i.elements.popper),a,p,_),C=pe(i.elements.reference),M=ms({reference:C,element:f,placement:s}),y=Pi(Object.assign({},f,M)),E=g===me?y:C,B={top:b.top-E.top+h.top,bottom:E.bottom-b.bottom+h.bottom,left:b.left-E.left+h.left,right:E.right-b.right+h.right},T=i.modifiersData.offset;if(g===me&&T){var R=T[s];Object.keys(B).forEach(function(D){var I=[Bt,kt].indexOf(D)>=0?1:-1,F=[gt,kt].indexOf(D)>=0?"y":"x";B[D]+=R[F]*I})}return B}function Zn(i,t){t===void 0&&(t={});var e=t,r=e.placement,s=e.boundary,d=e.rootBoundary,_=e.padding,n=e.flipVariations,a=e.allowedAutoPlacements,u=a===void 0?us:a,p=_e(r),c=p?n?hr:hr.filter(function(w){return _e(w)===p}):Pe,g=c.filter(function(w){return u.indexOf(w)>=0});g.length===0&&(g=c);var S=g.reduce(function(w,m){return w[m]=Le(i,{placement:m,boundary:s,rootBoundary:d,padding:_})[Wt(m)],w},{});return Object.keys(S).sort(function(w,m){return S[w]-S[m]})}function Qn(i){if(Wt(i)===Wi)return[];var t=Ze(i);return[ur(i),t,ur(t)]}function to(i){var t=i.state,e=i.options,r=i.name;if(!t.modifiersData[r]._skip){for(var s=e.mainAxis,d=s===void 0?!0:s,_=e.altAxis,n=_===void 0?!0:_,a=e.fallbackPlacements,u=e.padding,p=e.boundary,c=e.rootBoundary,g=e.altBoundary,S=e.flipVariations,w=S===void 0?!0:S,m=e.allowedAutoPlacements,o=t.options.placement,h=Wt(o),l=h===o,f=a||(l||!w?[Ze(o)]:Qn(o)),v=[o].concat(f).reduce(function(G,K){return G.concat(Wt(K)===Wi?Zn(t,{placement:K,boundary:p,rootBoundary:c,padding:u,flipVariations:w,allowedAutoPlacements:m}):K)},[]),b=t.rects.reference,C=t.rects.popper,M=new Map,y=!0,E=v[0],B=0;B<v.length;B++){var T=v[B],R=Wt(T),D=_e(T)===fe,I=[gt,kt].indexOf(R)>=0,F=I?"width":"height",W=Le(t,{placement:T,boundary:p,rootBoundary:c,altBoundary:g,padding:u}),H=I?D?Bt:mt:D?kt:gt;b[F]>C[F]&&(H=Ze(H));var x=Ze(H),L=[];if(d&&L.push(W[R]<=0),n&&L.push(W[H]<=0,W[x]<=0),L.every(function(G){return G})){E=T,y=!1;break}M.set(T,L)}if(y)for(var A=w?3:1,P=function(K){var et=v.find(function(k){var O=M.get(k);if(O)return O.slice(0,K).every(function(z){return z})});if(et)return E=et,"break"},$=A;$>0;$--){var V=P($);if(V==="break")break}t.placement!==E&&(t.modifiersData[r]._skip=!0,t.placement=E,t.reset=!0)}}const eo={name:"flip",enabled:!0,phase:"main",fn:to,requiresIfExists:["offset"],data:{_skip:!1}};function dr(i,t,e){return e===void 0&&(e={x:0,y:0}),{top:i.top-t.height-e.y,right:i.right-t.width+e.x,bottom:i.bottom-t.height+e.y,left:i.left-t.width-e.x}}function pr(i){return[gt,Bt,kt,mt].some(function(t){return i[t]>=0})}function io(i){var t=i.state,e=i.name,r=t.rects.reference,s=t.rects.popper,d=t.modifiersData.preventOverflow,_=Le(t,{elementContext:"reference"}),n=Le(t,{altBoundary:!0}),a=dr(_,r),u=dr(n,s,d),p=pr(a),c=pr(u);t.modifiersData[e]={referenceClippingOffsets:a,popperEscapeOffsets:u,isReferenceHidden:p,hasPopperEscaped:c},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":p,"data-popper-escaped":c})}const ro={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:io};function so(i,t,e){var r=Wt(i),s=[mt,gt].indexOf(r)>=0?-1:1,d=typeof e=="function"?e(Object.assign({},t,{placement:i})):e,_=d[0],n=d[1];return _=_||0,n=(n||0)*s,[mt,Bt].indexOf(r)>=0?{x:n,y:_}:{x:_,y:n}}function no(i){var t=i.state,e=i.options,r=i.name,s=e.offset,d=s===void 0?[0,0]:s,_=us.reduce(function(p,c){return p[c]=so(c,t.rects,d),p},{}),n=_[t.placement],a=n.x,u=n.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=a,t.modifiersData.popperOffsets.y+=u),t.modifiersData[r]=_}const oo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:no};function ao(i){var t=i.state,e=i.name;t.modifiersData[e]=ms({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const ho={name:"popperOffsets",enabled:!0,phase:"read",fn:ao,data:{}};function lo(i){return i==="x"?"y":"x"}function co(i){var t=i.state,e=i.options,r=i.name,s=e.mainAxis,d=s===void 0?!0:s,_=e.altAxis,n=_===void 0?!1:_,a=e.boundary,u=e.rootBoundary,p=e.altBoundary,c=e.padding,g=e.tether,S=g===void 0?!0:g,w=e.tetherOffset,m=w===void 0?0:w,o=Le(t,{boundary:a,rootBoundary:u,padding:c,altBoundary:p}),h=Wt(t.placement),l=_e(t.placement),f=!l,v=$i(h),b=lo(v),C=t.modifiersData.popperOffsets,M=t.rects.reference,y=t.rects.popper,E=typeof m=="function"?m(Object.assign({},t.rects,{placement:t.placement})):m,B=typeof E=="number"?{mainAxis:E,altAxis:E}:Object.assign({mainAxis:0,altAxis:0},E),T=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,R={x:0,y:0};if(C){if(d){var D,I=v==="y"?gt:mt,F=v==="y"?kt:Bt,W=v==="y"?"height":"width",H=C[v],x=H+o[I],L=H-o[F],A=S?-y[W]/2:0,P=l===fe?M[W]:y[W],$=l===fe?-y[W]:-M[W],V=t.elements.arrow,G=S&&V?Ni(V):{width:0,height:0},K=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:ps(),et=K[I],k=K[F],O=we(0,M[W],G[W]),z=f?M[W]/2-A-O-et-B.mainAxis:P-O-et-B.mainAxis,N=f?-M[W]/2+A+O+k+B.mainAxis:$+O+k+B.mainAxis,q=t.elements.arrow&&Oe(t.elements.arrow),U=q?v==="y"?q.clientTop||0:q.clientLeft||0:0,tt=(D=T==null?void 0:T[v])!=null?D:0,ot=H+z-tt-U,ht=H+N-tt,bt=we(S?ei(x,ot):x,H,S?Qt(L,ht):L);C[v]=bt,R[v]=bt-H}if(n){var Y,wt=v==="x"?gt:mt,Ut=v==="x"?kt:Bt,_t=C[b],Lt=b==="y"?"height":"width",Pt=_t+o[wt],lt=_t-o[Ut],Dt=[gt,mt].indexOf(h)!==-1,pt=(Y=T==null?void 0:T[b])!=null?Y:0,Ot=Dt?Pt:_t-M[Lt]-y[Lt]-pt+B.altAxis,It=Dt?_t+M[Lt]+y[Lt]-pt-B.altAxis:lt,yt=S&&Dt?Pn(Ot,_t,It):we(S?Ot:Pt,_t,S?It:lt);C[b]=yt,R[b]=yt-_t}t.modifiersData[r]=R}}const uo={name:"preventOverflow",enabled:!0,phase:"main",fn:co,requiresIfExists:["offset"]};function fo(i){return{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}}function po(i){return i===St(i)||!xt(i)?ji(i):fo(i)}function _o(i){var t=i.getBoundingClientRect(),e=de(t.width)/i.offsetWidth||1,r=de(t.height)/i.offsetHeight||1;return e!==1||r!==1}function vo(i,t,e){e===void 0&&(e=!1);var r=xt(t),s=xt(t)&&_o(t),d=Yt(t),_=pe(i,s,e),n={scrollLeft:0,scrollTop:0},a={x:0,y:0};return(r||!r&&!e)&&((Nt(t)!=="body"||Vi(d))&&(n=po(t)),xt(t)?(a=pe(t,!0),a.x+=t.clientLeft,a.y+=t.clientTop):d&&(a.x=Ui(d))),{x:_.left+n.scrollLeft-a.x,y:_.top+n.scrollTop-a.y,width:_.width,height:_.height}}function go(i){var t=new Map,e=new Set,r=[];i.forEach(function(d){t.set(d.name,d)});function s(d){e.add(d.name);var _=[].concat(d.requires||[],d.requiresIfExists||[]);_.forEach(function(n){if(!e.has(n)){var a=t.get(n);a&&s(a)}}),r.push(d)}return i.forEach(function(d){e.has(d.name)||s(d)}),r}function mo(i){var t=go(i);return Bn.reduce(function(e,r){return e.concat(t.filter(function(s){return s.phase===r}))},[])}function yo(i){var t;return function(){return t||(t=new Promise(function(e){Promise.resolve().then(function(){t=void 0,e(i())})})),t}}function So(i){var t=i.reduce(function(e,r){var s=e[r.name];return e[r.name]=s?Object.assign({},s,r,{options:Object.assign({},s.options,r.options),data:Object.assign({},s.data,r.data)}):r,e},{});return Object.keys(t).map(function(e){return t[e]})}var _r={placement:"bottom",modifiers:[],strategy:"absolute"};function vr(){for(var i=arguments.length,t=new Array(i),e=0;e<i;e++)t[e]=arguments[e];return!t.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function bo(i){i===void 0&&(i={});var t=i,e=t.defaultModifiers,r=e===void 0?[]:e,s=t.defaultOptions,d=s===void 0?_r:s;return function(n,a,u){u===void 0&&(u=d);var p={placement:"bottom",orderedModifiers:[],options:Object.assign({},_r,d),modifiersData:{},elements:{reference:n,popper:a},attributes:{},styles:{}},c=[],g=!1,S={state:p,setOptions:function(h){var l=typeof h=="function"?h(p.options):h;m(),p.options=Object.assign({},d,p.options,l),p.scrollParents={reference:te(n)?Ce(n):n.contextElement?Ce(n.contextElement):[],popper:Ce(a)};var f=mo(So([].concat(r,p.options.modifiers)));return p.orderedModifiers=f.filter(function(v){return v.enabled}),w(),S.update()},forceUpdate:function(){if(!g){var h=p.elements,l=h.reference,f=h.popper;if(vr(l,f)){p.rects={reference:vo(l,Oe(f),p.options.strategy==="fixed"),popper:Ni(f)},p.reset=!1,p.placement=p.options.placement,p.orderedModifiers.forEach(function(B){return p.modifiersData[B.name]=Object.assign({},B.data)});for(var v=0;v<p.orderedModifiers.length;v++){if(p.reset===!0){p.reset=!1,v=-1;continue}var b=p.orderedModifiers[v],C=b.fn,M=b.options,y=M===void 0?{}:M,E=b.name;typeof C=="function"&&(p=C({state:p,options:y,name:E,instance:S})||p)}}}},update:yo(function(){return new Promise(function(o){S.forceUpdate(),o(p)})}),destroy:function(){m(),g=!0}};if(!vr(n,a))return S;S.setOptions(u).then(function(o){!g&&u.onFirstUpdate&&u.onFirstUpdate(o)});function w(){p.orderedModifiers.forEach(function(o){var h=o.name,l=o.options,f=l===void 0?{}:l,v=o.effect;if(typeof v=="function"){var b=v({state:p,name:h,instance:S,options:f}),C=function(){};c.push(b||C)}})}function m(){c.forEach(function(o){return o()}),c=[]}return S}}var wo=[Un,ho,$n,Dn,oo,eo,uo,Fn,ro],Co=bo({defaultModifiers:wo});function Eo(i){return ai("MuiPopper",i)}hi("MuiPopper",["root"]);function Mo(i,t){if(t==="ltr")return i;switch(i){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return i}}function Oi(i){return typeof i=="function"?i():i}function xo(i){return i.nodeType!==void 0}const ko=i=>{const{classes:t}=i;return li({root:["root"]},Eo,t)},Bo={},Ro=X.forwardRef(function(t,e){const{anchorEl:r,children:s,direction:d,disablePortal:_,modifiers:n,open:a,placement:u,popperOptions:p,popperRef:c,slotProps:g={},slots:S={},TransitionProps:w,ownerState:m,...o}=t,h=X.useRef(null),l=Di(h,e),f=X.useRef(null),v=Di(f,c),b=X.useRef(v);nr(()=>{b.current=v},[v]),X.useImperativeHandle(c,()=>f.current,[]);const C=Mo(u,d),[M,y]=X.useState(C),[E,B]=X.useState(Oi(r));X.useEffect(()=>{f.current&&f.current.forceUpdate()}),X.useEffect(()=>{r&&B(Oi(r))},[r]),nr(()=>{if(!E||!a)return;const F=x=>{y(x.placement)};let W=[{name:"preventOverflow",options:{altBoundary:_}},{name:"flip",options:{altBoundary:_}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:x})=>{F(x)}}];n!=null&&(W=W.concat(n)),p&&p.modifiers!=null&&(W=W.concat(p.modifiers));const H=Co(E,h.current,{placement:C,...p,modifiers:W});return b.current(H),()=>{H.destroy(),b.current(null)}},[E,_,n,a,p,C]);const T={placement:M};w!==null&&(T.TransitionProps=w);const R=ko(t),D=S.root??"div",I=an({elementType:D,externalSlotProps:g.root,externalForwardedProps:o,additionalProps:{role:"tooltip",ref:l},ownerState:t,className:R.root});return Q.jsx(D,{...I,children:typeof s=="function"?s(T):s})}),Lo=X.forwardRef(function(t,e){const{anchorEl:r,children:s,container:d,direction:_="ltr",disablePortal:n=!1,keepMounted:a=!1,modifiers:u,open:p,placement:c="bottom",popperOptions:g=Bo,popperRef:S,style:w,transition:m=!1,slotProps:o={},slots:h={},...l}=t,[f,v]=X.useState(!0),b=()=>{v(!1)},C=()=>{v(!0)};if(!a&&!p&&(!m||f))return null;let M;if(d)M=d;else if(r){const B=Oi(r);M=B&&xo(B)?sr(B).body:sr(null).body}const y=!p&&a&&(!m||f)?"none":void 0,E=m?{in:p,onEnter:b,onExited:C}:void 0;return Q.jsx(on,{disablePortal:n,container:M,children:Q.jsx(Ro,{anchorEl:r,direction:_,disablePortal:n,modifiers:u,ref:e,open:m?!f:p,placement:c,popperOptions:g,popperRef:S,slotProps:o,slots:h,...l,style:{position:"fixed",top:0,left:0,display:y,...w},TransitionProps:E,children:s})})}),Do=jt(Lo,{name:"MuiPopper",slot:"Root"})({}),ys=X.forwardRef(function(t,e){const r=as(),s=ci({props:t,name:"MuiPopper"}),{anchorEl:d,component:_,components:n,componentsProps:a,container:u,disablePortal:p,keepMounted:c,modifiers:g,open:S,placement:w,popperOptions:m,popperRef:o,transition:h,slots:l,slotProps:f,...v}=s,b=(l==null?void 0:l.root)??(n==null?void 0:n.Root),C={anchorEl:d,container:u,disablePortal:p,keepMounted:c,modifiers:g,open:S,placement:w,popperOptions:m,popperRef:o,transition:h,...v};return Q.jsx(Do,{as:_,direction:r?"rtl":"ltr",slots:{root:b},slotProps:f??a,...C,ref:e})});function To(i){return ai("MuiButton",i)}const Jt=hi("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),Ss=X.createContext({}),bs=X.createContext(void 0),Ao=i=>{const{color:t,disableElevation:e,fullWidth:r,size:s,variant:d,loading:_,loadingPosition:n,classes:a}=i,u={root:["root",_&&"loading",d,`${d}${nt(t)}`,`size${nt(s)}`,`${d}Size${nt(s)}`,`color${nt(t)}`,e&&"disableElevation",r&&"fullWidth",_&&`loadingPosition${nt(n)}`],startIcon:["icon","startIcon",`iconSize${nt(s)}`],endIcon:["icon","endIcon",`iconSize${nt(s)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},p=li(u,To,a);return{...a,...p}},ws=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],Po=jt(ln,{shouldForwardProp:i=>cn(i)||i==="classes",name:"MuiButton",slot:"Root",overridesResolver:(i,t)=>{const{ownerState:e}=i;return[t.root,t[e.variant],t[`${e.variant}${nt(e.color)}`],t[`size${nt(e.size)}`],t[`${e.variant}Size${nt(e.size)}`],e.color==="inherit"&&t.colorInherit,e.disableElevation&&t.disableElevation,e.fullWidth&&t.fullWidth,e.loading&&t.loading]}})(Ae(({theme:i})=>{const t=i.palette.mode==="light"?i.palette.grey[300]:i.palette.grey[800],e=i.palette.mode==="light"?i.palette.grey.A100:i.palette.grey[700];return{...i.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(i.vars||i).shape.borderRadius,transition:i.transitions.create(["background-color","box-shadow","border-color","color"],{duration:i.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${Jt.disabled}`]:{color:(i.vars||i).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(i.vars||i).shadows[2],"&:hover":{boxShadow:(i.vars||i).shadows[4],"@media (hover: none)":{boxShadow:(i.vars||i).shadows[2]}},"&:active":{boxShadow:(i.vars||i).shadows[8]},[`&.${Jt.focusVisible}`]:{boxShadow:(i.vars||i).shadows[6]},[`&.${Jt.disabled}`]:{color:(i.vars||i).palette.action.disabled,boxShadow:(i.vars||i).shadows[0],backgroundColor:(i.vars||i).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${Jt.disabled}`]:{border:`1px solid ${(i.vars||i).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(i.palette).filter(Ti()).map(([r])=>({props:{color:r},style:{"--variant-textColor":(i.vars||i).palette[r].main,"--variant-outlinedColor":(i.vars||i).palette[r].main,"--variant-outlinedBorder":i.alpha((i.vars||i).palette[r].main,.5),"--variant-containedColor":(i.vars||i).palette[r].contrastText,"--variant-containedBg":(i.vars||i).palette[r].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(i.vars||i).palette[r].dark,"--variant-textBg":i.alpha((i.vars||i).palette[r].main,(i.vars||i).palette.action.hoverOpacity),"--variant-outlinedBorder":(i.vars||i).palette[r].main,"--variant-outlinedBg":i.alpha((i.vars||i).palette[r].main,(i.vars||i).palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":i.vars?i.vars.palette.Button.inheritContainedBg:t,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":i.vars?i.vars.palette.Button.inheritContainedHoverBg:e,"--variant-textBg":i.alpha((i.vars||i).palette.text.primary,(i.vars||i).palette.action.hoverOpacity),"--variant-outlinedBg":i.alpha((i.vars||i).palette.text.primary,(i.vars||i).palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:i.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:i.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:i.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:i.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:i.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:i.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${Jt.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${Jt.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:i.transitions.create(["background-color","box-shadow","border-color"],{duration:i.transitions.duration.short}),[`&.${Jt.loading}`]:{color:"transparent"}}}]}})),Oo=jt("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(i,t)=>{const{ownerState:e}=i;return[t.startIcon,e.loading&&t.startIconLoadingStart,t[`iconSize${nt(e.size)}`]]}})(({theme:i})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:i.transitions.create(["opacity"],{duration:i.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...ws]})),Io=jt("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(i,t)=>{const{ownerState:e}=i;return[t.endIcon,e.loading&&t.endIconLoadingEnd,t[`iconSize${nt(e.size)}`]]}})(({theme:i})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:i.transitions.create(["opacity"],{duration:i.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...ws]})),Ho=jt("span",{name:"MuiButton",slot:"LoadingIndicator"})(({theme:i})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(i.vars||i).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]})),gr=jt("span",{name:"MuiButton",slot:"LoadingIconPlaceholder"})({display:"inline-block",width:"1em",height:"1em"}),mr=X.forwardRef(function(t,e){const r=X.useContext(Ss),s=X.useContext(bs),d=hn(r,t),_=ci({props:d,name:"MuiButton"}),{children:n,color:a="primary",component:u="button",className:p,disabled:c=!1,disableElevation:g=!1,disableFocusRipple:S=!1,endIcon:w,focusVisibleClassName:m,fullWidth:o=!1,id:h,loading:l=null,loadingIndicator:f,loadingPosition:v="center",size:b="medium",startIcon:C,type:M,variant:y="text",...E}=_,B=hs(h),T=f??Q.jsx(ls,{"aria-labelledby":B,color:"inherit",size:16}),R={..._,color:a,component:u,disabled:c,disableElevation:g,disableFocusRipple:S,fullWidth:o,loading:l,loadingIndicator:T,loadingPosition:v,size:b,type:M,variant:y},D=Ao(R),I=(C||l&&v==="start")&&Q.jsx(Oo,{className:D.startIcon,ownerState:R,children:C||Q.jsx(gr,{className:D.loadingIconPlaceholder,ownerState:R})}),F=(w||l&&v==="end")&&Q.jsx(Io,{className:D.endIcon,ownerState:R,children:w||Q.jsx(gr,{className:D.loadingIconPlaceholder,ownerState:R})}),W=s||"",H=typeof l=="boolean"?Q.jsx("span",{className:D.loadingWrapper,style:{display:"contents"},children:l&&Q.jsx(Ho,{className:D.loadingIndicator,ownerState:R,children:T})}):null;return Q.jsxs(Po,{ownerState:R,className:Be(r.className,D.root,p,W),component:u,disabled:c||l,focusRipple:!S,focusVisibleClassName:Be(D.focusVisible,m),ref:e,type:M,id:l?B:h,...E,classes:D,children:[I,v!=="end"&&H,n,v==="end"&&H,F]})});function Fo(i){return X.Children.toArray(i).filter(t=>X.isValidElement(t))}function Wo(i){return ai("MuiButtonGroup",i)}const J=hi("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","horizontal","vertical","colorPrimary","colorSecondary","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),zo=(i,t)=>{const{ownerState:e}=i;return[{[`& .${J.grouped}`]:t.grouped},{[`& .${J.grouped}`]:t[`grouped${nt(e.orientation)}`]},{[`& .${J.grouped}`]:t[`grouped${nt(e.variant)}`]},{[`& .${J.grouped}`]:t[`grouped${nt(e.variant)}${nt(e.orientation)}`]},{[`& .${J.grouped}`]:t[`grouped${nt(e.variant)}${nt(e.color)}`]},{[`& .${J.firstButton}`]:t.firstButton},{[`& .${J.lastButton}`]:t.lastButton},{[`& .${J.middleButton}`]:t.middleButton},t.root,t[e.variant],e.disableElevation===!0&&t.disableElevation,e.fullWidth&&t.fullWidth,e.orientation==="vertical"&&t.vertical]},No=i=>{const{classes:t,color:e,disabled:r,disableElevation:s,fullWidth:d,orientation:_,variant:n}=i,a={root:["root",n,_,d&&"fullWidth",s&&"disableElevation",`color${nt(e)}`],grouped:["grouped",`grouped${nt(_)}`,`grouped${nt(n)}`,`grouped${nt(n)}${nt(_)}`,`grouped${nt(n)}${nt(e)}`,r&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return li(a,Wo,t)},$o=jt("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:zo})(Ae(({theme:i})=>({display:"inline-flex",borderRadius:(i.vars||i).shape.borderRadius,variants:[{props:{variant:"contained"},style:{boxShadow:(i.vars||i).shadows[2]}},{props:{disableElevation:!0},style:{boxShadow:"none"}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${J.lastButton},& .${J.middleButton}`]:{borderTopRightRadius:0,borderTopLeftRadius:0},[`& .${J.firstButton},& .${J.middleButton}`]:{borderBottomRightRadius:0,borderBottomLeftRadius:0}}},{props:{orientation:"horizontal"},style:{[`& .${J.firstButton},& .${J.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${J.lastButton},& .${J.middleButton}`]:{borderTopLeftRadius:0,borderBottomLeftRadius:0}}},{props:{variant:"text",orientation:"horizontal"},style:{[`& .${J.firstButton},& .${J.middleButton}`]:{borderRight:i.vars?`1px solid ${i.alpha(i.vars.palette.common.onBackground,.23)}`:`1px solid ${i.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${J.disabled}`]:{borderRight:`1px solid ${(i.vars||i).palette.action.disabled}`}}}},{props:{variant:"text",orientation:"vertical"},style:{[`& .${J.firstButton},& .${J.middleButton}`]:{borderBottom:i.vars?`1px solid ${i.alpha(i.vars.palette.common.onBackground,.23)}`:`1px solid ${i.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${J.disabled}`]:{borderBottom:`1px solid ${(i.vars||i).palette.action.disabled}`}}}},...Object.entries(i.palette).filter(Ti()).flatMap(([t])=>[{props:{variant:"text",color:t},style:{[`& .${J.firstButton},& .${J.middleButton}`]:{borderColor:i.alpha((i.vars||i).palette[t].main,.5)}}}]),{props:{variant:"outlined",orientation:"horizontal"},style:{[`& .${J.firstButton},& .${J.middleButton}`]:{borderRightColor:"transparent","&:hover":{borderRightColor:"currentColor"}},[`& .${J.lastButton},& .${J.middleButton}`]:{marginLeft:-1}}},{props:{variant:"outlined",orientation:"vertical"},style:{[`& .${J.firstButton},& .${J.middleButton}`]:{borderBottomColor:"transparent","&:hover":{borderBottomColor:"currentColor"}},[`& .${J.lastButton},& .${J.middleButton}`]:{marginTop:-1}}},{props:{variant:"contained",orientation:"horizontal"},style:{[`& .${J.firstButton},& .${J.middleButton}`]:{borderRight:`1px solid ${(i.vars||i).palette.grey[400]}`,[`&.${J.disabled}`]:{borderRight:`1px solid ${(i.vars||i).palette.action.disabled}`}}}},{props:{variant:"contained",orientation:"vertical"},style:{[`& .${J.firstButton},& .${J.middleButton}`]:{borderBottom:`1px solid ${(i.vars||i).palette.grey[400]}`,[`&.${J.disabled}`]:{borderBottom:`1px solid ${(i.vars||i).palette.action.disabled}`}}}},...Object.entries(i.palette).filter(Ti(["dark"])).map(([t])=>({props:{variant:"contained",color:t},style:{[`& .${J.firstButton},& .${J.middleButton}`]:{borderColor:(i.vars||i).palette[t].dark}}}))],[`& .${J.grouped}`]:{minWidth:40,boxShadow:"none",props:{variant:"contained"},style:{"&:hover":{boxShadow:"none"}}}}))),jo=X.forwardRef(function(t,e){const r=ci({props:t,name:"MuiButtonGroup"}),{children:s,className:d,color:_="primary",component:n="div",disabled:a=!1,disableElevation:u=!1,disableFocusRipple:p=!1,disableRipple:c=!1,fullWidth:g=!1,orientation:S="horizontal",size:w="medium",variant:m="outlined",...o}=r,h={...r,color:_,component:n,disabled:a,disableElevation:u,disableFocusRipple:p,disableRipple:c,fullWidth:g,orientation:S,size:w,variant:m},l=No(h),f=X.useMemo(()=>({className:l.grouped,color:_,disabled:a,disableElevation:u,disableFocusRipple:p,disableRipple:c,fullWidth:g,size:w,variant:m}),[_,a,u,p,c,g,w,m,l.grouped]),v=Fo(s),b=v.length,C=M=>{const y=M===0,E=M===b-1;return y&&E?"":y?l.firstButton:E?l.lastButton:l.middleButton};return Q.jsx($o,{as:n,role:"group",className:Be(l.root,d),ref:e,ownerState:h,...o,children:Q.jsx(Ss.Provider,{value:f,children:v.map((M,y)=>Q.jsx(bs.Provider,{value:C(y),children:M},y))})})});function Uo(i){return ai("MuiTooltip",i)}const at=hi("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function Vo(i){return Math.round(i*1e5)/1e5}const Ko=i=>{const{classes:t,disableInteractive:e,arrow:r,touch:s,placement:d}=i,_={popper:["popper",!e&&"popperInteractive",r&&"popperArrow"],tooltip:["tooltip",r&&"tooltipArrow",s&&"touch",`tooltipPlacement${nt(d.split("-")[0])}`],arrow:["arrow"]};return li(_,Uo,t)},Go=jt(ys,{name:"MuiTooltip",slot:"Popper",overridesResolver:(i,t)=>{const{ownerState:e}=i;return[t.popper,!e.disableInteractive&&t.popperInteractive,e.arrow&&t.popperArrow,!e.open&&t.popperClose]}})(Ae(({theme:i})=>({zIndex:(i.vars||i).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:t})=>!t.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:t})=>!t,style:{pointerEvents:"none"}},{props:({ownerState:t})=>t.arrow,style:{[`&[data-popper-placement*="bottom"] .${at.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${at.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${at.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${at.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:t})=>t.arrow&&!t.isRtl,style:{[`&[data-popper-placement*="right"] .${at.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:t})=>t.arrow&&!!t.isRtl,style:{[`&[data-popper-placement*="right"] .${at.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:t})=>t.arrow&&!t.isRtl,style:{[`&[data-popper-placement*="left"] .${at.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:t})=>t.arrow&&!!t.isRtl,style:{[`&[data-popper-placement*="left"] .${at.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),Xo=jt("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(i,t)=>{const{ownerState:e}=i;return[t.tooltip,e.touch&&t.touch,e.arrow&&t.tooltipArrow,t[`tooltipPlacement${nt(e.placement.split("-")[0])}`]]}})(Ae(({theme:i})=>({backgroundColor:i.vars?i.vars.palette.Tooltip.bg:i.alpha(i.palette.grey[700],.92),borderRadius:(i.vars||i).shape.borderRadius,color:(i.vars||i).palette.common.white,fontFamily:i.typography.fontFamily,padding:"4px 8px",fontSize:i.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:i.typography.fontWeightMedium,[`.${at.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${at.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${at.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${at.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:t})=>t.arrow,style:{position:"relative",margin:0}},{props:({ownerState:t})=>t.touch,style:{padding:"8px 16px",fontSize:i.typography.pxToRem(14),lineHeight:`${Vo(16/14)}em`,fontWeight:i.typography.fontWeightRegular}},{props:({ownerState:t})=>!t.isRtl,style:{[`.${at.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${at.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:t})=>!t.isRtl&&t.touch,style:{[`.${at.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${at.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:t})=>!!t.isRtl,style:{[`.${at.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${at.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:t})=>!!t.isRtl&&t.touch,style:{[`.${at.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${at.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:t})=>t.touch,style:{[`.${at.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:t})=>t.touch,style:{[`.${at.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),qo=jt("span",{name:"MuiTooltip",slot:"Arrow"})(Ae(({theme:i})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:i.vars?i.vars.palette.Tooltip.bg:i.alpha(i.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let $e=!1;const yr=new _n;let ye={x:0,y:0};function je(i,t){return(e,...r)=>{t&&t(e,...r),i(e,...r)}}const Yo=X.forwardRef(function(t,e){const r=ci({props:t,name:"MuiTooltip"}),{arrow:s=!1,children:d,classes:_,components:n={},componentsProps:a={},describeChild:u=!1,disableFocusListener:p=!1,disableHoverListener:c=!1,disableInteractive:g=!1,disableTouchListener:S=!1,enterDelay:w=100,enterNextDelay:m=0,enterTouchDelay:o=700,followCursor:h=!1,id:l,leaveDelay:f=0,leaveTouchDelay:v=1500,onClose:b,onOpen:C,open:M,placement:y="bottom",PopperComponent:E,PopperProps:B={},slotProps:T={},slots:R={},title:D,TransitionComponent:I,TransitionProps:F,...W}=r,H=X.isValidElement(d)?d:Q.jsx("span",{children:d}),x=un(),L=as(),[A,P]=X.useState(),[$,V]=X.useState(null),G=X.useRef(!1),K=g||h,et=We(),k=We(),O=We(),z=We(),[N,q]=fn({controlled:M,default:!1,name:"Tooltip",state:"open"});let U=N;const tt=hs(l),ot=X.useRef(),ht=or(()=>{ot.current!==void 0&&(document.body.style.WebkitUserSelect=ot.current,ot.current=void 0),z.clear()});X.useEffect(()=>ht,[ht]);const bt=Z=>{yr.clear(),$e=!0,q(!0),C&&!U&&C(Z)},Y=or(Z=>{yr.start(800+f,()=>{$e=!1}),q(!1),b&&U&&b(Z),et.start(x.transitions.duration.shortest,()=>{G.current=!1})}),wt=Z=>{G.current&&Z.type!=="touchstart"||(A&&A.removeAttribute("title"),k.clear(),O.clear(),w||$e&&m?k.start($e?m:w,()=>{bt(Z)}):bt(Z))},Ut=Z=>{k.clear(),O.start(f,()=>{Y(Z)})},[,_t]=X.useState(!1),Lt=Z=>{ar(Z.target)||(_t(!1),Ut(Z))},Pt=Z=>{A||P(Z.currentTarget),ar(Z.target)&&(_t(!0),wt(Z))},lt=Z=>{G.current=!0;const At=H.props;At.onTouchStart&&At.onTouchStart(Z)},Dt=Z=>{lt(Z),O.clear(),et.clear(),ht(),ot.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",z.start(o,()=>{document.body.style.WebkitUserSelect=ot.current,wt(Z)})},pt=Z=>{H.props.onTouchEnd&&H.props.onTouchEnd(Z),ht(),O.start(v,()=>{Y(Z)})};X.useEffect(()=>{if(!U)return;function Z(At){At.key==="Escape"&&Y(At)}return document.addEventListener("keydown",Z),()=>{document.removeEventListener("keydown",Z)}},[Y,U]);const Ot=Di(dn(H),P,e);!D&&D!==0&&(U=!1);const It=X.useRef(),yt=Z=>{const At=H.props;At.onMouseMove&&At.onMouseMove(Z),ye={x:Z.clientX,y:Z.clientY},It.current&&It.current.update()},Vt={},Ct=typeof D=="string";u?(Vt.title=!U&&Ct&&!c?D:null,Vt["aria-describedby"]=U?tt:null):(Vt["aria-label"]=Ct?D:null,Vt["aria-labelledby"]=U&&!Ct?tt:null);const ct={...Vt,...W,...H.props,className:Be(W.className,H.props.className),onTouchStart:lt,ref:Ot,...h?{onMouseMove:yt}:{}},it={};S||(ct.onTouchStart=Dt,ct.onTouchEnd=pt),c||(ct.onMouseOver=je(wt,ct.onMouseOver),ct.onMouseLeave=je(Ut,ct.onMouseLeave),K||(it.onMouseOver=wt,it.onMouseLeave=Ut)),p||(ct.onFocus=je(Pt,ct.onFocus),ct.onBlur=je(Lt,ct.onBlur),K||(it.onFocus=Pt,it.onBlur=Lt));const Kt={...r,isRtl:L,arrow:s,disableInteractive:K,placement:y,PopperComponentProp:E,touch:G.current},Tt=typeof T.popper=="function"?T.popper(Kt):T.popper,qs=X.useMemo(()=>{var At,rr;let Z=[{name:"arrow",enabled:!!$,options:{element:$,padding:4}}];return(At=B.popperOptions)!=null&&At.modifiers&&(Z=Z.concat(B.popperOptions.modifiers)),(rr=Tt==null?void 0:Tt.popperOptions)!=null&&rr.modifiers&&(Z=Z.concat(Tt.popperOptions.modifiers)),{...B.popperOptions,...Tt==null?void 0:Tt.popperOptions,modifiers:Z}},[$,B.popperOptions,Tt==null?void 0:Tt.popperOptions]),mi=Ko(Kt),Ys=typeof T.transition=="function"?T.transition(Kt):T.transition,Fe={slots:{popper:n.Popper,transition:n.Transition??I,tooltip:n.Tooltip,arrow:n.Arrow,...R},slotProps:{arrow:T.arrow??a.arrow,popper:{...B,...Tt??a.popper},tooltip:T.tooltip??a.tooltip,transition:{...F,...Ys??a.transition}}},[Js,Zs]=ze("popper",{elementType:Go,externalForwardedProps:Fe,ownerState:Kt,className:Be(mi.popper,B==null?void 0:B.className)}),[Qs,tn]=ze("transition",{elementType:pn,externalForwardedProps:Fe,ownerState:Kt}),[en,rn]=ze("tooltip",{elementType:Xo,className:mi.tooltip,externalForwardedProps:Fe,ownerState:Kt}),[sn,nn]=ze("arrow",{elementType:qo,className:mi.arrow,externalForwardedProps:Fe,ownerState:Kt,ref:V});return Q.jsxs(X.Fragment,{children:[X.cloneElement(H,ct),Q.jsx(Js,{as:E??ys,placement:y,anchorEl:h?{getBoundingClientRect:()=>({top:ye.y,left:ye.x,right:ye.x,bottom:ye.y,width:0,height:0})}:A,popperRef:It,open:A?U:!1,id:tt,transition:!0,...it,...Zs,popperOptions:qs,children:({TransitionProps:Z})=>Q.jsx(Qs,{timeout:x.transitions.duration.shorter,...Z,...tn,children:Q.jsxs(en,{...rn,children:[D,s?Q.jsx(sn,{...nn}):null]})})})]})});var Jo={allowDownsampling:!0};function Zo(i,t){return t===void 0&&(t=Jo),new Qo(i,t)}var Qo=function(){function i(t,e){var r=this;this._resolutionMediaQueryList=null,this._resolutionListener=function(s){return r._onResolutionChanged()},this._canvasConfiguredListeners=[],this.canvas=t,this._canvasSize={width:this.canvas.clientWidth,height:this.canvas.clientHeight},this._options=e,this._configureCanvas(),this._installResolutionListener()}return i.prototype.destroy=function(){this._canvasConfiguredListeners.length=0,this._uninstallResolutionListener(),this.canvas=null},Object.defineProperty(i.prototype,"canvasSize",{get:function(){return{width:this._canvasSize.width,height:this._canvasSize.height}},enumerable:!0,configurable:!0}),i.prototype.resizeCanvas=function(t){this._canvasSize={width:t.width,height:t.height},this._configureCanvas()},Object.defineProperty(i.prototype,"pixelRatio",{get:function(){var t=this.canvas.ownerDocument.defaultView;if(t==null)throw new Error("No window is associated with the canvas");return t.devicePixelRatio>1||this._options.allowDownsampling?t.devicePixelRatio:1},enumerable:!0,configurable:!0}),i.prototype.subscribeCanvasConfigured=function(t){this._canvasConfiguredListeners.push(t)},i.prototype.unsubscribeCanvasConfigured=function(t){this._canvasConfiguredListeners=this._canvasConfiguredListeners.filter(function(e){return e!=t})},i.prototype._configureCanvas=function(){var t=this.pixelRatio;this.canvas.style.width=this._canvasSize.width+"px",this.canvas.style.height=this._canvasSize.height+"px",this.canvas.width=this._canvasSize.width*t,this.canvas.height=this._canvasSize.height*t,this._emitCanvasConfigured()},i.prototype._emitCanvasConfigured=function(){var t=this;this._canvasConfiguredListeners.forEach(function(e){return e.call(t)})},i.prototype._installResolutionListener=function(){if(this._resolutionMediaQueryList!==null)throw new Error("Resolution listener is already installed");var t=this.canvas.ownerDocument.defaultView;if(t==null)throw new Error("No window is associated with the canvas");var e=t.devicePixelRatio;this._resolutionMediaQueryList=t.matchMedia("all and (resolution: "+e+"dppx)"),this._resolutionMediaQueryList.addListener(this._resolutionListener)},i.prototype._uninstallResolutionListener=function(){this._resolutionMediaQueryList!==null&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},i.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},i.prototype._onResolutionChanged=function(){this._configureCanvas(),this._reinstallResolutionListener()},i}();/*!
 * @license
 * TradingView Lightweight Charts v3.8.0
 * Copyright (c) 2020 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */var Sr,br;function ee(i,t){var e,r=((e={})[0]=[],e[1]=[i.lineWidth,i.lineWidth],e[2]=[2*i.lineWidth,2*i.lineWidth],e[3]=[6*i.lineWidth,6*i.lineWidth],e[4]=[i.lineWidth,4*i.lineWidth],e)[t];i.setLineDash(r)}function Cs(i,t,e,r){i.beginPath();var s=i.lineWidth%2?.5:0;i.moveTo(e,t+s),i.lineTo(r,t+s),i.stroke()}function ge(i,t){if(!i)throw new Error("Assertion failed"+(t?": "+t:""))}function Rt(i){if(i===void 0)throw new Error("Value is undefined");return i}function j(i){if(i===null)throw new Error("Value is null");return i}function be(i){return j(Rt(i))}(function(i){i[i.Simple=0]="Simple",i[i.WithSteps=1]="WithSteps"})(Sr||(Sr={})),function(i){i[i.Solid=0]="Solid",i[i.Dotted=1]="Dotted",i[i.Dashed=2]="Dashed",i[i.LargeDashed=3]="LargeDashed",i[i.SparseDotted=4]="SparseDotted"}(br||(br={}));var wr={khaki:"#f0e68c",azure:"#f0ffff",aliceblue:"#f0f8ff",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",gray:"#808080",green:"#008000",honeydew:"#f0fff0",floralwhite:"#fffaf0",lightblue:"#add8e6",lightcoral:"#f08080",lemonchiffon:"#fffacd",hotpink:"#ff69b4",lightyellow:"#ffffe0",greenyellow:"#adff2f",lightgoldenrodyellow:"#fafad2",limegreen:"#32cd32",linen:"#faf0e6",lightcyan:"#e0ffff",magenta:"#f0f",maroon:"#800000",olive:"#808000",orange:"#ffa500",oldlace:"#fdf5e6",mediumblue:"#0000cd",transparent:"#0000",lime:"#0f0",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",midnightblue:"#191970",orchid:"#da70d6",mediumorchid:"#ba55d3",mediumturquoise:"#48d1cc",orangered:"#ff4500",royalblue:"#4169e1",powderblue:"#b0e0e6",red:"#f00",coral:"#ff7f50",turquoise:"#40e0d0",white:"#fff",whitesmoke:"#f5f5f5",wheat:"#f5deb3",teal:"#008080",steelblue:"#4682b4",bisque:"#ffe4c4",aquamarine:"#7fffd4",aqua:"#0ff",sienna:"#a0522d",silver:"#c0c0c0",springgreen:"#00ff7f",antiquewhite:"#faebd7",burlywood:"#deb887",brown:"#a52a2a",beige:"#f5f5dc",chocolate:"#d2691e",chartreuse:"#7fff00",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cadetblue:"#5f9ea0",tomato:"#ff6347",fuchsia:"#f0f",blue:"#00f",salmon:"#fa8072",blanchedalmond:"#ffebcd",slateblue:"#6a5acd",slategray:"#708090",thistle:"#d8bfd8",tan:"#d2b48c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",blueviolet:"#8a2be2",black:"#000",darkmagenta:"#8b008b",darkslateblue:"#483d8b",darkkhaki:"#bdb76b",darkorchid:"#9932cc",darkorange:"#ff8c00",darkgreen:"#006400",darkred:"#8b0000",dodgerblue:"#1e90ff",darkslategray:"#2f4f4f",dimgray:"#696969",deepskyblue:"#00bfff",firebrick:"#b22222",forestgreen:"#228b22",indigo:"#4b0082",ivory:"#fffff0",lavenderblush:"#fff0f5",feldspar:"#d19275",indianred:"#cd5c5c",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightskyblue:"#87cefa",lightslategray:"#789",lightslateblue:"#8470ff",snow:"#fffafa",lightseagreen:"#20b2aa",lightsalmon:"#ffa07a",darksalmon:"#e9967a",darkviolet:"#9400d3",mediumpurple:"#9370d8",mediumaquamarine:"#66cdaa",skyblue:"#87ceeb",lavender:"#e6e6fa",lightsteelblue:"#b0c4de",mediumvioletred:"#c71585",mintcream:"#f5fffa",navajowhite:"#ffdead",navy:"#000080",olivedrab:"#6b8e23",palevioletred:"#d87093",violetred:"#d02090",yellow:"#ff0",yellowgreen:"#9acd32",lawngreen:"#7cfc00",pink:"#ffc0cb",paleturquoise:"#afeeee",palegoldenrod:"#eee8aa",darkolivegreen:"#556b2f",darkseagreen:"#8fbc8f",darkturquoise:"#00ced1",peachpuff:"#ffdab9",deeppink:"#ff1493",violet:"#ee82ee",palegreen:"#98fb98",mediumseagreen:"#3cb371",peru:"#cd853f",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",purple:"#800080",seagreen:"#2e8b57",seashell:"#fff5ee",papayawhip:"#ffefd5",mediumslateblue:"#7b68ee",plum:"#dda0dd",mediumspringgreen:"#00fa9a"};function Mt(i){return i<0?0:i>255?255:Math.round(i)||0}function Es(i){return i<=0||i>0?i<0?0:i>1?1:Math.round(1e4*i)/1e4:0}var ta=/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])?$/i,ea=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,ia=/^rgb\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*\)$/,ra=/^rgba\(\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?\d{1,10})\s*,\s*(-?[\d]{0,10}(?:\.\d+)?)\s*\)$/;function ii(i){var t;if((i=i.toLowerCase())in wr&&(i=wr[i]),t=ra.exec(i)||ia.exec(i))return[Mt(parseInt(t[1],10)),Mt(parseInt(t[2],10)),Mt(parseInt(t[3],10)),Es(t.length<5?1:parseFloat(t[4]))];if(t=ea.exec(i))return[Mt(parseInt(t[1],16)),Mt(parseInt(t[2],16)),Mt(parseInt(t[3],16)),1];if(t=ta.exec(i))return[Mt(17*parseInt(t[1],16)),Mt(17*parseInt(t[2],16)),Mt(17*parseInt(t[3],16)),1];throw new Error("Cannot parse color: ".concat(i))}function fi(i){var t,e=ii(i);return{t:"rgb(".concat(e[0],", ").concat(e[1],", ").concat(e[2],")"),i:(t=e,.199*t[0]+.687*t[1]+.114*t[2]>160?"black":"white")}}var Ii=function(i,t){return Ii=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])},Ii(i,t)};function rt(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=i}Ii(i,t),i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var st=function(){return st=Object.assign||function(i){for(var t,e=1,r=arguments.length;e<r;e++)for(var s in t=arguments[e])Object.prototype.hasOwnProperty.call(t,s)&&(i[s]=t[s]);return i},st.apply(this,arguments)};function Ms(i,t,e){for(var r,s=0,d=t.length;s<d;s++)!r&&s in t||(r||(r=Array.prototype.slice.call(t,0,s)),r[s]=t[s]);return i.concat(r||Array.prototype.slice.call(t))}var dt=function(){function i(){this.h=[]}return i.prototype.u=function(t,e,r){var s={o:t,l:e,v:r===!0};this.h.push(s)},i.prototype._=function(t){var e=this.h.findIndex(function(r){return t===r.o});e>-1&&this.h.splice(e,1)},i.prototype.M=function(t){this.h=this.h.filter(function(e){return e.l!==t})},i.prototype.m=function(t,e){var r=Ms([],this.h);this.h=this.h.filter(function(s){return!s.v}),r.forEach(function(s){return s.o(t,e)})},i.prototype.p=function(){return this.h.length>0},i.prototype.g=function(){this.h=[]},i}();function ut(i){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];for(var r=0,s=t;r<s.length;r++){var d=s[r];for(var _ in d)d[_]!==void 0&&(typeof d[_]!="object"||i[_]===void 0?i[_]=d[_]:ut(i[_],d[_]))}return i}function Ft(i){return typeof i=="number"&&isFinite(i)}function De(i){return typeof i=="number"&&i%1==0}function Ki(i){return typeof i=="string"}function yi(i){return typeof i=="boolean"}function vt(i){var t,e,r,s=i;if(!s||typeof s!="object")return s;for(e in t=Array.isArray(s)?[]:{},s)s.hasOwnProperty(e)&&(r=s[e],t[e]=r&&typeof r=="object"?vt(r):r);return t}function sa(i){return i!==null}function ri(i){return i===null?void 0:i}var Gi="'Trebuchet MS', Roboto, Ubuntu, sans-serif";function ie(i,t,e){return e=e!==void 0?"".concat(e," "):"",t===void 0&&(t=Gi),"".concat(e).concat(i,"px ").concat(t)}var na=function(){function i(t){this.k={N:1,C:4,S:NaN,T:"",D:"",A:"",B:0,L:0,F:0,O:0,V:0},this.P=t}return i.prototype.W=function(){var t=this.k,e=this.R(),r=this.I();return t.S===e&&t.D===r||(t.S=e,t.D=r,t.T=ie(e,r),t.O=Math.floor(e/3.5),t.B=t.O,t.L=Math.max(Math.ceil(e/2-t.C/2),0),t.F=Math.ceil(e/2+t.C/2),t.V=Math.round(e/10)),t.A=this.j(),this.k},i.prototype.j=function(){return this.P.W().layout.textColor},i.prototype.R=function(){return this.P.W().layout.fontSize},i.prototype.I=function(){return this.P.W().layout.fontFamily},i}(),di=function(){function i(){this.q=[]}return i.prototype.U=function(t){this.q=t},i.prototype.H=function(t,e,r,s){this.q.forEach(function(d){t.save(),d.H(t,e,r,s),t.restore()})},i}(),Ie=function(){function i(){}return i.prototype.H=function(t,e,r,s){t.save(),t.scale(e,e),this.Y(t,r,s),t.restore()},i.prototype.$=function(t,e,r,s){t.save(),t.scale(e,e),this.K(t,r,s),t.restore()},i.prototype.K=function(t,e,r){},i}(),oa=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.X=null,e}return rt(t,i),t.prototype.Z=function(e){this.X=e},t.prototype.Y=function(e){if(this.X!==null&&this.X.J!==null){var r=this.X.J,s=this.X,d=function(_){e.beginPath();for(var n=r.to-1;n>=r.from;--n){var a=s.G[n];e.moveTo(a.tt,a.it),e.arc(a.tt,a.it,_,0,2*Math.PI)}e.fill()};e.fillStyle=s.nt,d(s.st+2),e.fillStyle=s.ht,d(s.st)}},t}(Ie);function aa(){return{G:[{tt:0,it:0,rt:0,et:0}],ht:"",nt:"",st:0,J:null}}var ha={from:0,to:1},la=function(){function i(t,e){this.ut=new di,this.ot=[],this.lt=[],this.ft=!0,this.P=t,this.ct=e,this.ut.U(this.ot)}return i.prototype.vt=function(t){var e=this.P._t();e.length!==this.ot.length&&(this.lt=e.map(aa),this.ot=this.lt.map(function(r){var s=new oa;return s.Z(r),s}),this.ut.U(this.ot)),this.ft=!0},i.prototype.dt=function(t,e,r){return this.ft&&(this.wt(t),this.ft=!1),this.ut},i.prototype.wt=function(t){var e=this,r=this.P._t(),s=this.ct.Mt(),d=this.P.bt();r.forEach(function(_,n){var a,u=e.lt[n],p=_.gt(s);if(p!==null&&_.yt()){var c=j(_.kt());u.ht=p.Nt,u.st=p.st,u.G[0].et=p.et,u.G[0].it=_.Ct().xt(p.et,c.St),u.nt=(a=p.Tt)!==null&&a!==void 0?a:e.P.Dt(u.G[0].it/t),u.G[0].rt=s,u.G[0].tt=d.At(s),u.J=ha}else u.J=null})},i}(),ca=function(){function i(t){this.Bt=t}return i.prototype.H=function(t,e,r,s){if(this.Bt!==null){var d=this.Bt.Lt.yt,_=this.Bt.Et.yt;if(d||_){t.save();var n=Math.round(this.Bt.tt*e),a=Math.round(this.Bt.it*e),u=Math.ceil(this.Bt.Ft*e),p=Math.ceil(this.Bt.Ot*e);t.lineCap="butt",d&&n>=0&&(t.lineWidth=Math.floor(this.Bt.Lt.Vt*e),t.strokeStyle=this.Bt.Lt.A,t.fillStyle=this.Bt.Lt.A,ee(t,this.Bt.Lt.Pt),function(c,g,S,w){c.beginPath();var m=c.lineWidth%2?.5:0;c.moveTo(g+m,S),c.lineTo(g+m,w),c.stroke()}(t,n,0,p)),_&&a>=0&&(t.lineWidth=Math.floor(this.Bt.Et.Vt*e),t.strokeStyle=this.Bt.Et.A,t.fillStyle=this.Bt.Et.A,ee(t,this.Bt.Et.Pt),Cs(t,a,0,u)),t.restore()}}},i}(),ua=function(){function i(t){this.ft=!0,this.Wt={Lt:{Vt:1,Pt:0,A:"",yt:!1},Et:{Vt:1,Pt:0,A:"",yt:!1},Ft:0,Ot:0,tt:0,it:0},this.zt=new ca(this.Wt),this.Rt=t}return i.prototype.vt=function(){this.ft=!0},i.prototype.dt=function(t,e){return this.ft&&(this.wt(),this.ft=!1),this.zt},i.prototype.wt=function(){var t=this.Rt.yt(),e=j(this.Rt.It()),r=e.jt().W().crosshair,s=this.Wt;s.Et.yt=t&&this.Rt.qt(e),s.Lt.yt=t&&this.Rt.Ut(),s.Et.Vt=r.horzLine.width,s.Et.Pt=r.horzLine.style,s.Et.A=r.horzLine.color,s.Lt.Vt=r.vertLine.width,s.Lt.Pt=r.vertLine.style,s.Lt.A=r.vertLine.color,s.Ft=e.Ht(),s.Ot=e.Yt(),s.tt=this.Rt.$t(),s.it=this.Rt.Kt()},i}();function fa(i,t,e,r,s,d){i.fillRect(t+d,e,r-2*d,d),i.fillRect(t+d,e+s-d,r-2*d,d),i.fillRect(t,e,d,s),i.fillRect(t+r-d,e,d,s)}function $t(i,t,e){i.save(),i.scale(t,t),e(),i.restore()}function pi(i,t,e,r,s,d){i.save(),i.globalCompositeOperation="copy",i.fillStyle=d,i.fillRect(t,e,r,s),i.restore()}function xs(i,t,e,r,s,d,_){i.save(),i.globalCompositeOperation="copy";var n=i.createLinearGradient(0,0,0,s);n.addColorStop(0,d),n.addColorStop(1,_),i.fillStyle=n,i.fillRect(t,e,r,s),i.restore()}var Cr,Er=function(){function i(t,e){this.Z(t,e)}return i.prototype.Z=function(t,e){this.Bt=t,this.Xt=e},i.prototype.H=function(t,e,r,s,d,_){if(this.Bt.yt){t.font=e.T;var n=this.Bt.Zt||!this.Bt.Jt?e.C:0,a=e.N,u=e.O,p=e.B,c=e.L,g=e.F,S=this.Bt.Gt,w=Math.ceil(r.Qt(t,S)),m=e.V,o=e.S+u+p,h=Math.ceil(.5*o),l=a+w+c+g+n,f=this.Xt.ti;this.Xt.ii&&(f=this.Xt.ii);var v,b,C=(f=Math.round(f))-h,M=C+o,y=d==="right",E=y?s:0,B=Math.ceil(s*_),T=E;if(t.fillStyle=this.Xt.t,t.lineWidth=1,t.lineCap="butt",S){y?(v=E-n,b=(T=E-l)+g):(T=E+l,v=E+n,b=E+a+n+c);var R=Math.max(1,Math.floor(_)),D=Math.max(1,Math.floor(a*_)),I=y?B:0,F=Math.round(C*_),W=Math.round(T*_),H=Math.round(f*_)-Math.floor(.5*_),x=H+R+(H-F),L=Math.round(v*_);t.save(),t.beginPath(),t.moveTo(I,F),t.lineTo(W,F),t.lineTo(W,x),t.lineTo(I,x),t.fill(),t.fillStyle=this.Bt.Tt,t.fillRect(y?B-D:0,F,D,x-F),this.Bt.Zt&&(t.fillStyle=this.Xt.A,t.fillRect(I,H,L-I,R)),t.textAlign="left",t.fillStyle=this.Xt.A,$t(t,_,function(){t.fillText(S,b,M-p-m)}),t.restore()}}},i.prototype.Yt=function(t,e){return this.Bt.yt?t.S+t.O+t.B:0},i}(),Xi=function(){function i(t){this.ni={ti:0,A:"#FFF",t:"#000"},this.si={Gt:"",yt:!1,Zt:!0,Jt:!1,Tt:""},this.hi={Gt:"",yt:!1,Zt:!1,Jt:!0,Tt:""},this.ft=!0,this.ri=new(t||Er)(this.si,this.ni),this.ei=new(t||Er)(this.hi,this.ni)}return i.prototype.Gt=function(){return this.ui(),this.si.Gt},i.prototype.ti=function(){return this.ui(),this.ni.ti},i.prototype.vt=function(){this.ft=!0},i.prototype.Yt=function(t,e){return e===void 0&&(e=!1),Math.max(this.ri.Yt(t,e),this.ei.Yt(t,e))},i.prototype.ai=function(){return this.ni.ii||0},i.prototype.oi=function(t){this.ni.ii=t},i.prototype.li=function(){return this.ui(),this.si.yt||this.hi.yt},i.prototype.fi=function(){return this.ui(),this.si.yt},i.prototype.dt=function(t){return this.ui(),this.si.Zt=this.si.Zt&&t.W().drawTicks,this.hi.Zt=this.hi.Zt&&t.W().drawTicks,this.ri.Z(this.si,this.ni),this.ei.Z(this.hi,this.ni),this.ri},i.prototype.ci=function(){return this.ui(),this.ri.Z(this.si,this.ni),this.ei.Z(this.hi,this.ni),this.ei},i.prototype.ui=function(){this.ft&&(this.si.Zt=!0,this.hi.Zt=!1,this.vi(this.si,this.hi,this.ni))},i}(),da=function(i){function t(e,r,s){var d=i.call(this)||this;return d.Rt=e,d._i=r,d.di=s,d}return rt(t,i),t.prototype.vi=function(e,r,s){e.yt=!1;var d=this.Rt.W().horzLine;if(d.labelVisible){var _=this._i.kt();if(this.Rt.yt()&&!this._i.wi()&&_!==null){var n=fi(d.labelBackgroundColor);s.t=n.t,s.A=n.i;var a=this.di(this._i);s.ti=a.ti,e.Gt=this._i.Mi(a.et,_),e.yt=!0}}},t}(Xi),pa=/[1-9]/g,_a=function(){function i(){this.Bt=null}return i.prototype.Z=function(t){this.Bt=t},i.prototype.H=function(t,e,r){var s=this;if(this.Bt!==null&&this.Bt.yt!==!1&&this.Bt.Gt.length!==0){t.font=e.T;var d=Math.round(e.bi.Qt(t,this.Bt.Gt,pa));if(!(d<=0)){t.save();var _=e.mi,n=d+2*_,a=n/2,u=this.Bt.Ht,p=this.Bt.ti,c=Math.floor(p-a)+.5;c<0?(p+=Math.abs(0-c),c=Math.floor(p-a)+.5):c+n>u&&(p-=Math.abs(u-(c+n)),c=Math.floor(p-a)+.5);var g=c+n,S=0+e.N+e.O+e.S+e.B;t.fillStyle=this.Bt.t;var w=Math.round(c*r),m=Math.round(0*r),o=Math.round(g*r),h=Math.round(S*r);t.fillRect(w,m,o-w,h-m);var l=Math.round(this.Bt.ti*r),f=m,v=Math.round((f+e.N+e.C)*r);t.fillStyle=this.Bt.A;var b=Math.max(1,Math.floor(r)),C=Math.floor(.5*r);t.fillRect(l-C,f,b,v-f);var M=S-e.V-e.B;t.textAlign="left",t.fillStyle=this.Bt.A,$t(t,r,function(){t.fillText(j(s.Bt).Gt,c+_,M)}),t.restore()}}},i}(),va=function(){function i(t,e,r){this.ft=!0,this.zt=new _a,this.Wt={yt:!1,t:"#4c525e",A:"white",Gt:"",Ht:0,ti:NaN},this.ct=t,this.pi=e,this.di=r}return i.prototype.vt=function(){this.ft=!0},i.prototype.dt=function(){return this.ft&&(this.wt(),this.ft=!1),this.zt.Z(this.Wt),this.zt},i.prototype.wt=function(){var t=this.Wt;t.yt=!1;var e=this.ct.W().vertLine;if(e.labelVisible){var r=this.pi.bt();if(!r.wi()){var s=r.gi(this.ct.Mt());t.Ht=r.Ht();var d=this.di();if(d.rt){t.ti=d.ti,t.Gt=r.yi(j(s)),t.yt=!0;var _=fi(e.labelBackgroundColor);t.t=_.t,t.A=_.i}}}},i}(),qi=function(){function i(){this.ki=null,this.Ni=0}return i.prototype.xi=function(){return this.Ni},i.prototype.Ci=function(t){this.Ni=t},i.prototype.Ct=function(){return this.ki},i.prototype.Si=function(t){this.ki=t},i.prototype.Ti=function(){return[]},i.prototype.yt=function(){return!0},i}();(function(i){i[i.Normal=0]="Normal",i[i.Magnet=1]="Magnet"})(Cr||(Cr={}));var ga=function(i){function t(e,r){var s=i.call(this)||this;s.Di=null,s.Ai=NaN,s.Bi=0,s.Li=!0,s.Ei=new Map,s.Fi=!1,s.Oi=NaN,s.Vi=NaN,s.Pi=NaN,s.Wi=NaN,s.pi=e,s.zi=r,s.Ri=new la(e,s);var d,_;s.Ii=(d=function(){return s.Ai},_=function(){return s.Vi},function(a){var u=_(),p=d();if(a===j(s.Di).ji())return{et:p,ti:u};var c=j(a.kt());return{et:a.qi(u,c),ti:u}});var n=function(a,u){return function(){return{rt:s.pi.bt().gi(a()),ti:u()}}}(function(){return s.Bi},function(){return s.$t()});return s.Ui=new va(s,e,n),s.Hi=new ua(s),s}return rt(t,i),t.prototype.W=function(){return this.zi},t.prototype.Yi=function(e,r){this.Pi=e,this.Wi=r},t.prototype.$i=function(){this.Pi=NaN,this.Wi=NaN},t.prototype.Ki=function(){return this.Pi},t.prototype.Xi=function(){return this.Wi},t.prototype.Zi=function(e,r,s){this.Fi||(this.Fi=!0),this.Li=!0,this.Ji(e,r,s)},t.prototype.Mt=function(){return this.Bi},t.prototype.$t=function(){return this.Oi},t.prototype.Kt=function(){return this.Vi},t.prototype.yt=function(){return this.Li},t.prototype.Gi=function(){this.Li=!1,this.Qi(),this.Ai=NaN,this.Oi=NaN,this.Vi=NaN,this.Di=null,this.$i()},t.prototype.tn=function(e){return this.Di!==null?[this.Hi,this.Ri]:[]},t.prototype.qt=function(e){return e===this.Di&&this.zi.horzLine.visible},t.prototype.Ut=function(){return this.zi.vertLine.visible},t.prototype.nn=function(e,r){this.Li&&this.Di===e||this.Ei.clear();var s=[];return this.Di===e&&s.push(this.sn(this.Ei,r,this.Ii)),s},t.prototype.Ti=function(){return this.Li?[this.Ui]:[]},t.prototype.It=function(){return this.Di},t.prototype.hn=function(){this.Hi.vt(),this.Ei.forEach(function(e){return e.vt()}),this.Ui.vt(),this.Ri.vt()},t.prototype.rn=function(e){return e&&!e.ji().wi()?e.ji():null},t.prototype.Ji=function(e,r,s){this.en(e,r,s)&&this.hn()},t.prototype.en=function(e,r,s){var d=this.Oi,_=this.Vi,n=this.Ai,a=this.Bi,u=this.Di,p=this.rn(s);this.Bi=e,this.Oi=isNaN(e)?NaN:this.pi.bt().At(e),this.Di=s;var c=p!==null?p.kt():null;return p!==null&&c!==null?(this.Ai=r,this.Vi=p.xt(r,c)):(this.Ai=NaN,this.Vi=NaN),d!==this.Oi||_!==this.Vi||a!==this.Bi||n!==this.Ai||u!==this.Di},t.prototype.Qi=function(){var e=this.pi._t().map(function(s){return s.an().un()}).filter(sa),r=e.length===0?null:Math.max.apply(Math,e);this.Bi=r!==null?r:NaN},t.prototype.sn=function(e,r,s){var d=e.get(r);return d===void 0&&(d=new da(this,r,s),e.set(r,d)),d},t}(qi);function _i(i){return i==="left"||i==="right"}var Et=function(){function i(t){this.on=new Map,this.ln=[],this.fn=t}return i.prototype.cn=function(t,e){var r=function(s,d){return s===void 0?d:{vn:Math.max(s.vn,d.vn),_n:s._n||d._n}}(this.on.get(t),e);this.on.set(t,r)},i.prototype.dn=function(){return this.fn},i.prototype.wn=function(t){var e=this.on.get(t);return e===void 0?{vn:this.fn}:{vn:Math.max(this.fn,e.vn),_n:e._n}},i.prototype.Mn=function(){this.ln=[{bn:0}]},i.prototype.mn=function(t){this.ln=[{bn:1,St:t}]},i.prototype.pn=function(){this.ln=[{bn:4}]},i.prototype.gn=function(t){this.ln.push({bn:2,St:t})},i.prototype.yn=function(t){this.ln.push({bn:3,St:t})},i.prototype.kn=function(){return this.ln},i.prototype.Nn=function(t){for(var e=this,r=0,s=t.ln;r<s.length;r++){var d=s[r];this.xn(d)}this.fn=Math.max(this.fn,t.fn),t.on.forEach(function(_,n){e.cn(n,_)})},i.prototype.xn=function(t){switch(t.bn){case 0:this.Mn();break;case 1:this.mn(t.St);break;case 2:this.gn(t.St);break;case 3:this.yn(t.St);break;case 4:this.pn()}},i}(),Mr=".";function Gt(i,t){if(!Ft(i))return"n/a";if(!De(t))throw new TypeError("invalid length");if(t<0||t>16)throw new TypeError("invalid length");return t===0?i.toString():("0000000000000000"+i.toString()).slice(-t)}var vi=function(){function i(t,e){if(e||(e=1),Ft(t)&&De(t)||(t=100),t<0)throw new TypeError("invalid base");this._i=t,this.Cn=e,this.Sn()}return i.prototype.format=function(t){var e=t<0?"−":"";return t=Math.abs(t),e+this.Tn(t)},i.prototype.Sn=function(){if(this.Dn=0,this._i>0&&this.Cn>0)for(var t=this._i;t>1;)t/=10,this.Dn++},i.prototype.Tn=function(t){var e=this._i/this.Cn,r=Math.floor(t),s="",d=this.Dn!==void 0?this.Dn:NaN;if(e>1){var _=+(Math.round(t*e)-r*e).toFixed(this.Dn);_>=e&&(_-=e,r+=1),s=Mr+Gt(+_.toFixed(this.Dn)*this.Cn,d)}else r=Math.round(r*e)/e,d>0&&(s=Mr+Gt(0,d));return r.toFixed(0)+s},i}(),ks=function(i){function t(e){return e===void 0&&(e=100),i.call(this,e)||this}return rt(t,i),t.prototype.format=function(e){return"".concat(i.prototype.format.call(this,e),"%")},t}(vi),ma=function(){function i(t){this.An=t}return i.prototype.format=function(t){var e="";return t<0&&(e="-",t=-t),t<995?e+this.Bn(t):t<999995?e+this.Bn(t/1e3)+"K":t<999999995?(t=1e3*Math.round(t/1e3),e+this.Bn(t/1e6)+"M"):(t=1e6*Math.round(t/1e6),e+this.Bn(t/1e9)+"B")},i.prototype.Bn=function(t){var e=Math.pow(10,this.An);return((t=Math.round(t*e)/e)>=1e-15&&t<1?t.toFixed(this.An).replace(/\.?0+$/,""):String(t)).replace(/(\.[1-9]*)0+$/,function(r,s){return s})},i}();function Bs(i,t,e,r){if(t.length!==0){var s=t[r.from].tt,d=t[r.from].it;i.moveTo(s,d);for(var _=r.from+1;_<r.to;++_){var n=t[_];if(e===1){var a=t[_-1].it,u=n.tt;i.lineTo(u,a)}i.lineTo(n.tt,n.it)}}}var Rs=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.X=null,e}return rt(t,i),t.prototype.Z=function(e){this.X=e},t.prototype.Y=function(e){if(this.X!==null&&this.X.G.length!==0&&this.X.J!==null){if(e.lineCap="butt",e.lineJoin="round",e.lineWidth=this.X.Vt,ee(e,this.X.Pt),e.lineWidth=1,e.beginPath(),this.X.G.length===1){var r=this.X.G[0],s=this.X.Ln/2;e.moveTo(r.tt-s,this.X.En),e.lineTo(r.tt-s,r.it),e.lineTo(r.tt+s,r.it),e.lineTo(r.tt+s,this.X.En)}else e.moveTo(this.X.G[this.X.J.from].tt,this.X.En),e.lineTo(this.X.G[this.X.J.from].tt,this.X.G[this.X.J.from].it),Bs(e,this.X.G,this.X.Fn,this.X.J),this.X.J.to>this.X.J.from&&(e.lineTo(this.X.G[this.X.J.to-1].tt,this.X.En),e.lineTo(this.X.G[this.X.J.from].tt,this.X.En));e.closePath(),e.fillStyle=this.On(e),e.fill()}},t}(Ie),ya=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return rt(t,i),t.prototype.On=function(e){var r=this.X,s=e.createLinearGradient(0,0,0,r.Vn);return s.addColorStop(0,r.Pn),s.addColorStop(1,r.Wn),s},t}(Rs),Ls=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.X=null,e}return rt(t,i),t.prototype.Z=function(e){this.X=e},t.prototype.Y=function(e){if(this.X!==null&&this.X.G.length!==0&&this.X.J!==null)if(e.lineCap="butt",e.lineWidth=this.X.Vt,ee(e,this.X.Pt),e.strokeStyle=this.zn(e),e.lineJoin="round",this.X.G.length===1){e.beginPath();var r=this.X.G[0];e.moveTo(r.tt-this.X.Ln/2,r.it),e.lineTo(r.tt+this.X.Ln/2,r.it),r.A!==void 0&&(e.strokeStyle=r.A),e.stroke()}else this.Rn(e,this.X)},t.prototype.Rn=function(e,r){e.beginPath(),Bs(e,r.G,r.Fn,r.J),e.stroke()},t}(Ie),Ds=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return rt(t,i),t.prototype.Rn=function(e,r){var s,d,_=r.G,n=r.J,a=r.Fn,u=r.ht;if(_.length!==0&&n!==null){e.beginPath();var p=_[n.from];e.moveTo(p.tt,p.it);var c=(s=p.A)!==null&&s!==void 0?s:u;e.strokeStyle=c;for(var g=function(h){e.stroke(),e.beginPath(),e.strokeStyle=h,c=h},S=n.from+1;S<n.to;++S){var w=_[S],m=_[S-1],o=(d=w.A)!==null&&d!==void 0?d:u;a===1&&(e.lineTo(w.tt,m.it),o!==c&&(g(o),e.moveTo(w.tt,m.it))),e.lineTo(w.tt,w.it),a!==1&&o!==c&&(g(o),e.moveTo(w.tt,w.it))}e.stroke()}},t.prototype.zn=function(){return this.X.ht},t}(Ls);function He(i,t,e,r,s){r===void 0&&(r=0),s===void 0&&(s=i.length);for(var d=s-r;0<d;){var _=d>>1,n=r+_;e(i[n],t)?(r=n+1,d-=_+1):d=_}return r}function Ts(i,t,e,r,s){r===void 0&&(r=0),s===void 0&&(s=i.length);for(var d=s-r;0<d;){var _=d>>1,n=r+_;e(t,i[n])?d=_:(r=n+1,d-=_+1)}return r}function Sa(i,t){return i.rt<t}function ba(i,t){return i<t.rt}function Yi(i,t,e){var r=t.In(),s=t.jn(),d=He(i,r,Sa),_=Ts(i,s,ba);if(!e)return{from:d,to:_};var n=d,a=_;return d>0&&d<i.length&&i[d].rt>=r&&(n=d-1),_>0&&_<i.length&&i[_-1].rt<=s&&(a=_+1),{from:n,to:a}}var Ji=function(){function i(t,e,r){this.qn=!0,this.Un=!0,this.Hn=!0,this.Yn=[],this.$n=null,this.Kn=t,this.Xn=e,this.Zn=r}return i.prototype.vt=function(t){this.qn=!0,t==="data"&&(this.Un=!0),t==="options"&&(this.Hn=!0)},i.prototype.Jn=function(){this.Un&&(this.Gn(),this.Un=!1),this.qn&&(this.Qn(),this.qn=!1),this.Hn&&(this.ts(),this.Hn=!1)},i.prototype.ns=function(){this.$n=null},i.prototype.Qn=function(){var t=this.Kn.Ct(),e=this.Xn.bt();if(this.ns(),!e.wi()&&!t.wi()){var r=e.ss();if(r!==null&&this.Kn.an().hs()!==0){var s=this.Kn.kt();s!==null&&(this.$n=Yi(this.Yn,r,this.Zn),this.rs(t,e,s.St))}}},i}(),Zi=function(i){function t(e,r){return i.call(this,e,r,!0)||this}return rt(t,i),t.prototype.rs=function(e,r,s){r.es(this.Yn,ri(this.$n)),e.us(this.Yn,s,ri(this.$n))},t.prototype.os=function(e,r){return{rt:e,et:r,tt:NaN,it:NaN}},t.prototype.ts=function(){},t.prototype.Gn=function(){var e=this,r=this.Kn.ls();this.Yn=this.Kn.an().fs().map(function(s){var d=s.St[3];return e.cs(s.vs,d,r)})},t}(Ji),wa=function(i){function t(e,r){var s=i.call(this,e,r)||this;return s.zt=new di,s._s=new ya,s.ds=new Ds,s.zt.U([s._s,s.ds]),s}return rt(t,i),t.prototype.dt=function(e,r){if(!this.Kn.yt())return null;var s=this.Kn.W();return this.Jn(),this._s.Z({Fn:s.lineType,G:this.Yn,Pt:s.lineStyle,Vt:s.lineWidth,Pn:s.topColor,Wn:s.bottomColor,En:e,Vn:e,J:this.$n,Ln:this.Xn.bt().ws()}),this.ds.Z({Fn:s.lineType,G:this.Yn,ht:s.lineColor,Pt:s.lineStyle,Vt:s.lineWidth,J:this.$n,Ln:this.Xn.bt().ws()}),this.zt},t.prototype.cs=function(e,r){return this.os(e,r)},t}(Zi),Ca=function(){function i(){this.Bt=null,this.Ms=0,this.bs=0}return i.prototype.Z=function(t){this.Bt=t},i.prototype.H=function(t,e,r,s){if(this.Bt!==null&&this.Bt.an.length!==0&&this.Bt.J!==null){this.Ms=this.ps(e),this.Ms>=2&&Math.max(1,Math.floor(e))%2!=this.Ms%2&&this.Ms--,this.bs=this.Bt.gs?Math.min(this.Ms,Math.floor(e)):this.Ms;for(var d=null,_=this.bs<=this.Ms&&this.Bt.ws>=Math.floor(1.5*e),n=this.Bt.J.from;n<this.Bt.J.to;++n){var a=this.Bt.an[n];d!==a.A&&(t.fillStyle=a.A,d=a.A);var u=Math.floor(.5*this.bs),p=Math.round(a.tt*e),c=p-u,g=this.bs,S=c+g-1,w=Math.min(a.ys,a.ks),m=Math.max(a.ys,a.ks),o=Math.round(w*e)-u,h=Math.round(m*e)+u,l=Math.max(h-o,this.bs);t.fillRect(c,o,g,l);var f=Math.ceil(1.5*this.Ms);if(_){if(this.Bt.Ns){var v=p-f,b=Math.max(o,Math.round(a.xs*e)-u),C=b+g-1;C>o+l-1&&(b=(C=o+l-1)-g+1),t.fillRect(v,b,c-v,C-b+1)}var M=p+f,y=Math.max(o,Math.round(a.Cs*e)-u),E=y+g-1;E>o+l-1&&(y=(E=o+l-1)-g+1),t.fillRect(S+1,y,M-S,E-y+1)}}}},i.prototype.ps=function(t){var e=Math.floor(t);return Math.max(e,Math.floor(function(r,s){return Math.floor(.3*r*s)}(j(this.Bt).ws,t)))},i}(),As=function(i){function t(e,r){return i.call(this,e,r,!1)||this}return rt(t,i),t.prototype.rs=function(e,r,s){r.es(this.Yn,ri(this.$n)),e.Ss(this.Yn,s,ri(this.$n))},t.prototype.Ts=function(e,r,s){return{rt:e,open:r.St[0],high:r.St[1],low:r.St[2],close:r.St[3],tt:NaN,xs:NaN,ys:NaN,ks:NaN,Cs:NaN}},t.prototype.Gn=function(){var e=this,r=this.Kn.ls();this.Yn=this.Kn.an().fs().map(function(s){return e.cs(s.vs,s,r)})},t}(Ji),Ea=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.zt=new Ca,e}return rt(t,i),t.prototype.dt=function(e,r){if(!this.Kn.yt())return null;var s=this.Kn.W();this.Jn();var d={an:this.Yn,ws:this.Xn.bt().ws(),Ns:s.openVisible,gs:s.thinBars,J:this.$n};return this.zt.Z(d),this.zt},t.prototype.ts=function(){var e=this;this.Yn.forEach(function(r){r.A=e.Kn.ls().As(r.rt).Ds})},t.prototype.cs=function(e,r,s){return st(st({},this.Ts(e,r,s)),{A:s.As(e).Ds})},t}(As);function si(i,t,e){return Math.min(Math.max(i,t),e)}function Ue(i,t,e){return t-i<=e}function Ps(i){return i<=0?NaN:Math.log(i)/Math.log(10)}function Hi(i){var t=Math.ceil(i);return t%2!=0?t-1:t}function Os(i){var t=Math.ceil(i);return t%2==0?t-1:t}var Ma=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return rt(t,i),t.prototype.On=function(e){var r=this.X,s=e.createLinearGradient(0,0,0,r.Vn),d=si(r.En/r.Vn,0,1);return s.addColorStop(0,r.Bs),s.addColorStop(d,r.Ls),s.addColorStop(d,r.Es),s.addColorStop(1,r.Fs),s},t}(Rs),xa=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return rt(t,i),t.prototype.zn=function(e){var r=this.X,s=e.createLinearGradient(0,0,0,r.Vn),d=si(r.En/r.Vn,0,1);return s.addColorStop(0,r.Pn),s.addColorStop(d,r.Pn),s.addColorStop(d,r.Wn),s.addColorStop(1,r.Wn),s},t}(Ls),ka=function(i){function t(e,r){var s=i.call(this,e,r)||this;return s.Os=new Ma,s.Vs=new xa,s.ut=new di,s.ut.U([s.Os,s.Vs]),s}return rt(t,i),t.prototype.dt=function(e,r){if(!this.Kn.yt())return null;var s=this.Kn.kt();if(s===null)return null;var d=this.Kn.W();this.Jn();var _=this.Kn.Ct().xt(d.baseValue.price,s.St),n=this.Xn.bt().ws();return this.Os.Z({G:this.Yn,Bs:d.topFillColor1,Ls:d.topFillColor2,Es:d.bottomFillColor1,Fs:d.bottomFillColor2,Vt:d.lineWidth,Pt:d.lineStyle,Fn:0,En:_,Vn:e,J:this.$n,Ln:n}),this.Vs.Z({G:this.Yn,Pn:d.topLineColor,Wn:d.bottomLineColor,Vt:d.lineWidth,Pt:d.lineStyle,Fn:0,En:_,Vn:e,J:this.$n,Ln:n}),this.ut},t.prototype.cs=function(e,r){return this.os(e,r)},t}(Zi),Ba=function(){function i(){this.Bt=null,this.Ms=0}return i.prototype.Z=function(t){this.Bt=t},i.prototype.H=function(t,e,r,s){if(this.Bt!==null&&this.Bt.an.length!==0&&this.Bt.J!==null){this.Ms=function(n,a){if(n>=2.5&&n<=4)return Math.floor(3*a);var u=1-.2*Math.atan(Math.max(4,n)-4)/(.5*Math.PI),p=Math.floor(n*u*a),c=Math.floor(n*a),g=Math.min(p,c);return Math.max(Math.floor(a),g)}(this.Bt.ws,e),this.Ms>=2&&Math.floor(e)%2!=this.Ms%2&&this.Ms--;var d=this.Bt.an;this.Bt.Ps&&this.Ws(t,d,this.Bt.J,e),this.Bt.zs&&this.Rs(t,d,this.Bt.J,this.Bt.ws,e);var _=this.Is(e);(!this.Bt.zs||this.Ms>2*_)&&this.js(t,d,this.Bt.J,e)}},i.prototype.Ws=function(t,e,r,s){if(this.Bt!==null){var d="",_=Math.min(Math.floor(s),Math.floor(this.Bt.ws*s));_=Math.max(Math.floor(s),Math.min(_,this.Ms));for(var n=Math.floor(.5*_),a=null,u=r.from;u<r.to;u++){var p=e[u];p.qs!==d&&(t.fillStyle=p.qs,d=p.qs);var c=Math.round(Math.min(p.xs,p.Cs)*s),g=Math.round(Math.max(p.xs,p.Cs)*s),S=Math.round(p.ys*s),w=Math.round(p.ks*s),m=Math.round(s*p.tt)-n,o=m+_-1;a!==null&&(m=Math.max(a+1,m),m=Math.min(m,o));var h=o-m+1;t.fillRect(m,S,h,c-S),t.fillRect(m,g+1,h,w-g),a=o}}},i.prototype.Is=function(t){var e=Math.floor(1*t);this.Ms<=2*e&&(e=Math.floor(.5*(this.Ms-1)));var r=Math.max(Math.floor(t),e);return this.Ms<=2*r?Math.max(Math.floor(t),Math.floor(1*t)):r},i.prototype.Rs=function(t,e,r,s,d){if(this.Bt!==null)for(var _="",n=this.Is(d),a=null,u=r.from;u<r.to;u++){var p=e[u];p.Tt!==_&&(t.fillStyle=p.Tt,_=p.Tt);var c=Math.round(p.tt*d)-Math.floor(.5*this.Ms),g=c+this.Ms-1,S=Math.round(Math.min(p.xs,p.Cs)*d),w=Math.round(Math.max(p.xs,p.Cs)*d);if(a!==null&&(c=Math.max(a+1,c),c=Math.min(c,g)),this.Bt.ws*d>2*n)fa(t,c,S,g-c+1,w-S+1,n);else{var m=g-c+1;t.fillRect(c,S,m,w-S+1)}a=g}},i.prototype.js=function(t,e,r,s){if(this.Bt!==null)for(var d="",_=this.Is(s),n=r.from;n<r.to;n++){var a=e[n],u=Math.round(Math.min(a.xs,a.Cs)*s),p=Math.round(Math.max(a.xs,a.Cs)*s),c=Math.round(a.tt*s)-Math.floor(.5*this.Ms),g=c+this.Ms-1;if(a.A!==d){var S=a.A;t.fillStyle=S,d=S}this.Bt.zs&&(c+=_,u+=_,g-=_,p-=_),u>p||t.fillRect(c,u,g-c+1,p-u+1)}},i}(),Ra=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.zt=new Ba,e}return rt(t,i),t.prototype.dt=function(e,r){if(!this.Kn.yt())return null;var s=this.Kn.W();this.Jn();var d={an:this.Yn,ws:this.Xn.bt().ws(),Ps:s.wickVisible,zs:s.borderVisible,J:this.$n};return this.zt.Z(d),this.zt},t.prototype.ts=function(){var e=this;this.Yn.forEach(function(r){var s=e.Kn.ls().As(r.rt);r.A=s.Ds,r.qs=s.Us,r.Tt=s.Hs})},t.prototype.cs=function(e,r,s){var d=s.As(e);return st(st({},this.Ts(e,r,s)),{A:d.Ds,qs:d.Us,Tt:d.Hs})},t}(As),La=function(){function i(){this.Bt=null,this.Ys=[]}return i.prototype.Z=function(t){this.Bt=t,this.Ys=[]},i.prototype.H=function(t,e,r,s){if(this.Bt!==null&&this.Bt.G.length!==0&&this.Bt.J!==null){this.Ys.length||this.$s(e);for(var d=Math.max(1,Math.floor(e)),_=Math.round(this.Bt.Ks*e)-Math.floor(d/2),n=_+d,a=this.Bt.J.from;a<this.Bt.J.to;a++){var u=this.Bt.G[a],p=this.Ys[a-this.Bt.J.from],c=Math.round(u.it*e);t.fillStyle=u.A;var g=void 0,S=void 0;c<=_?(g=c,S=n):(g=_,S=c-Math.floor(d/2)+d),t.fillRect(p.In,g,p.jn-p.In+1,S-g)}}},i.prototype.$s=function(t){if(this.Bt!==null&&this.Bt.G.length!==0&&this.Bt.J!==null){var e=Math.ceil(this.Bt.ws*t)<=1?0:Math.max(1,Math.floor(t)),r=Math.round(this.Bt.ws*t)-e;this.Ys=new Array(this.Bt.J.to-this.Bt.J.from);for(var s=this.Bt.J.from;s<this.Bt.J.to;s++){var d,_=this.Bt.G[s],n=Math.round(_.tt*t),a=void 0,u=void 0;r%2?(a=n-(d=(r-1)/2),u=n+d):(a=n-(d=r/2),u=n+d-1),this.Ys[s-this.Bt.J.from]={In:a,jn:u,Xs:n,Zs:_.tt*t,rt:_.rt}}for(s=this.Bt.J.from+1;s<this.Bt.J.to;s++){var p=this.Ys[s-this.Bt.J.from],c=this.Ys[s-this.Bt.J.from-1];p.rt===c.rt+1&&p.In-c.jn!==e+1&&(c.Xs>c.Zs?c.jn=p.In-e-1:p.In=c.jn+e+1)}var g=Math.ceil(this.Bt.ws*t);for(s=this.Bt.J.from;s<this.Bt.J.to;s++){(p=this.Ys[s-this.Bt.J.from]).jn<p.In&&(p.jn=p.In);var S=p.jn-p.In+1;g=Math.min(S,g)}if(e>0&&g<4)for(s=this.Bt.J.from;s<this.Bt.J.to;s++)(S=(p=this.Ys[s-this.Bt.J.from]).jn-p.In+1)>g&&(p.Xs>p.Zs?p.jn-=1:p.In+=1)}else this.Ys=[]},i}();function xr(i){return{G:[],ws:i,Ks:NaN,J:null}}function Da(i,t,e){return{rt:i,et:t,tt:NaN,it:NaN,A:e}}var Ta=function(i){function t(e,r){var s=i.call(this,e,r,!1)||this;return s.ut=new di,s.Js=xr(0),s.zt=new La,s}return rt(t,i),t.prototype.dt=function(e,r){return this.Kn.yt()?(this.Jn(),this.ut):null},t.prototype.Gn=function(){var e=this.Xn.bt().ws();this.Js=xr(e);for(var r=0,s=0,d=this.Kn.W().color,_=0,n=this.Kn.an().fs();_<n.length;_++){var a=n[_],u=a.St[3],p=a.A!==void 0?a.A:d,c=Da(a.vs,u,p);++r<this.Js.G.length?this.Js.G[r]=c:this.Js.G.push(c),this.Yn[s++]={rt:a.vs,tt:0}}this.zt.Z(this.Js),this.ut.U([this.zt])},t.prototype.ts=function(){},t.prototype.ns=function(){i.prototype.ns.call(this),this.Js.J=null},t.prototype.rs=function(e,r,s){if(this.$n!==null){var d=r.ws(),_=j(r.ss()),n=e.xt(this.Kn.W().base,s);r.es(this.Js.G),e.us(this.Js.G,s),this.Js.Ks=n,this.Js.J=Yi(this.Js.G,_,!1),this.Js.ws=d,this.zt.Z(this.Js)}},t}(Ji),Aa=function(i){function t(e,r){var s=i.call(this,e,r)||this;return s.ds=new Ds,s}return rt(t,i),t.prototype.dt=function(e,r){if(!this.Kn.yt())return null;var s=this.Kn.W();this.Jn();var d={G:this.Yn,ht:s.color,Pt:s.lineStyle,Fn:s.lineType,Vt:s.lineWidth,J:this.$n,Ln:this.Xn.bt().ws()};return this.ds.Z(d),this.ds},t.prototype.ts=function(){var e=this;this.Yn.forEach(function(r){r.A=e.Kn.ls().As(r.rt).Ds})},t.prototype.cs=function(e,r,s){var d=this.os(e,r);return d.A=s.As(e).Ds,d},t}(Zi),Pa=/[2-9]/g,ve=function(){function i(t){t===void 0&&(t=50),this.Gs=new Map,this.Qs=0,this.th=Array.from(new Array(t))}return i.prototype.ih=function(){this.Gs.clear(),this.th.fill(void 0)},i.prototype.Qt=function(t,e,r){var s=r||Pa,d=String(e).replace(s,"0"),_=this.Gs.get(d);if(_===void 0){if((_=t.measureText(d).width)===0&&e.length!==0)return 0;var n=this.th[this.Qs];n!==void 0&&this.Gs.delete(n),this.th[this.Qs]=d,this.Qs=(this.Qs+1)%this.th.length,this.Gs.set(d,_)}return _},i}(),Oa=function(){function i(t){this.nh=null,this.k=null,this.sh="right",this.hh=0,this.rh=t}return i.prototype.eh=function(t,e,r,s){this.nh=t,this.k=e,this.hh=r,this.sh=s},i.prototype.H=function(t,e){this.k!==null&&this.nh!==null&&this.nh.H(t,this.k,this.rh,this.hh,this.sh,e)},i}(),Is=function(){function i(t,e,r){this.uh=t,this.rh=new ve(50),this.ah=e,this.P=r,this.R=-1,this.zt=new Oa(this.rh)}return i.prototype.dt=function(t,e){var r=this.P.oh(this.ah);if(r===null)return null;var s=r.lh(this.ah)?r.fh():this.ah.Ct();if(s===null)return null;var d=r._h(s);if(d==="overlay")return null;var _=this.P.dh();return _.S!==this.R&&(this.R=_.S,this.rh.ih()),this.zt.eh(this.uh.ci(),_,e,d),this.zt},i}(),Ia=function(){function i(){this.Bt=null}return i.prototype.Z=function(t){this.Bt=t},i.prototype.H=function(t,e,r,s){if(this.Bt!==null&&this.Bt.yt!==!1){var d=Math.round(this.Bt.it*e);if(!(d<0||d>Math.ceil(this.Bt.Yt*e))){var _=Math.ceil(this.Bt.Ht*e);t.lineCap="butt",t.strokeStyle=this.Bt.A,t.lineWidth=Math.floor(this.Bt.Vt*e),ee(t,this.Bt.Pt),Cs(t,d,0,_)}}},i}(),Qi=function(){function i(t){this.wh={Ht:0,Yt:0,it:0,A:"rgba(0, 0, 0, 0)",Vt:1,Pt:0,yt:!1},this.Mh=new Ia,this.ft=!0,this.Kn=t,this.Xn=t.jt(),this.Mh.Z(this.wh)}return i.prototype.vt=function(){this.ft=!0},i.prototype.dt=function(t,e){return this.Kn.yt()?(this.ft&&(this.bh(t,e),this.ft=!1),this.Mh):null},i}(),Ha=function(i){function t(e){return i.call(this,e)||this}return rt(t,i),t.prototype.bh=function(e,r){this.wh.yt=!1;var s=this.Kn.Ct(),d=s.mh().mh;if(d===2||d===3){var _=this.Kn.W();if(_.baseLineVisible&&this.Kn.yt()){var n=this.Kn.kt();n!==null&&(this.wh.yt=!0,this.wh.it=s.xt(n.St,n.St),this.wh.Ht=r,this.wh.Yt=e,this.wh.A=_.baseLineColor,this.wh.Vt=_.baseLineWidth,this.wh.Pt=_.baseLineStyle)}}},t}(Qi),Fa=function(){function i(){this.Bt=null}return i.prototype.Z=function(t){this.Bt=t},i.prototype.ph=function(){return this.Bt},i.prototype.H=function(t,e,r,s){var d=this.Bt;if(d!==null){t.save();var _=Math.max(1,Math.floor(e)),n=_%2/2,a=Math.round(d.Zs.x*e)+n,u=d.Zs.y*e;t.fillStyle=d.gh,t.beginPath();var p=Math.max(2,1.5*d.yh)*e;t.arc(a,u,p,0,2*Math.PI,!1),t.fill(),t.fillStyle=d.kh,t.beginPath(),t.arc(a,u,d.st*e,0,2*Math.PI,!1),t.fill(),t.lineWidth=_,t.strokeStyle=d.Nh,t.beginPath(),t.arc(a,u,d.st*e+_/2,0,2*Math.PI,!1),t.stroke(),t.restore()}},i}(),Wa=[{xh:0,Ch:.25,Sh:4,Th:10,Dh:.25,Ah:0,Bh:.4,Lh:.8},{xh:.25,Ch:.525,Sh:10,Th:14,Dh:0,Ah:0,Bh:.8,Lh:0},{xh:.525,Ch:1,Sh:14,Th:14,Dh:0,Ah:0,Bh:0,Lh:0}];function kr(i,t,e,r){return function(s,d){if(s==="transparent")return s;var _=ii(s),n=_[3];return"rgba(".concat(_[0],", ").concat(_[1],", ").concat(_[2],", ").concat(d*n,")")}(i,e+(r-e)*t)}function Br(i,t){for(var e,r=i%2600/2600,s=0,d=Wa;s<d.length;s++){var _=d[s];if(r>=_.xh&&r<=_.Ch){e=_;break}}ge(e!==void 0,"Last price animation internal logic error");var n,a,u,p=(r-e.xh)/(e.Ch-e.xh);return{kh:kr(t,p,e.Dh,e.Ah),Nh:kr(t,p,e.Bh,e.Lh),st:(n=p,a=e.Sh,u=e.Th,a+(u-a)*n)}}var za=function(){function i(t){this.zt=new Fa,this.ft=!0,this.Eh=!0,this.Fh=performance.now(),this.Oh=this.Fh-1,this.Vh=t}return i.prototype.Ph=function(){this.Oh=this.Fh-1,this.vt()},i.prototype.Wh=function(){if(this.vt(),this.Vh.W().lastPriceAnimation===2){var t=performance.now(),e=this.Oh-t;if(e>0)return void(e<650&&(this.Oh+=2600));this.Fh=t,this.Oh=t+2600}},i.prototype.vt=function(){this.ft=!0},i.prototype.zh=function(){this.Eh=!0},i.prototype.yt=function(){return this.Vh.W().lastPriceAnimation!==0},i.prototype.Rh=function(){switch(this.Vh.W().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.Oh}},i.prototype.dt=function(t,e){return this.ft?(this.wt(t,e),this.ft=!1,this.Eh=!1):this.Eh&&(this.Ih(),this.Eh=!1),this.zt},i.prototype.wt=function(t,e){this.zt.Z(null);var r=this.Vh.jt().bt(),s=r.ss(),d=this.Vh.kt();if(s!==null&&d!==null){var _=this.Vh.jh(!0);if(!_.qh&&s.Uh(_.vs)){var n={x:r.At(_.vs),y:this.Vh.Ct().xt(_.et,d.St)},a=_.A,u=this.Vh.W().lineWidth,p=Br(this.Hh(),a);this.zt.Z({gh:a,yh:u,kh:p.kh,Nh:p.Nh,st:p.st,Zs:n})}}},i.prototype.Ih=function(){var t=this.zt.ph();if(t!==null){var e=Br(this.Hh(),t.gh);t.kh=e.kh,t.Nh=e.Nh,t.st=e.st}},i.prototype.Hh=function(){return this.Rh()?performance.now()-this.Fh:2599},i}();function Ee(i,t){return Os(Math.min(Math.max(i,12),30)*t)}function Te(i,t){switch(i){case"arrowDown":case"arrowUp":return Ee(t,1);case"circle":return Ee(t,.8);case"square":return Ee(t,.7)}}function Hs(i){return Hi(Ee(i,1))}function Rr(i){return Math.max(Ee(i,.1),3)}function Fs(i,t,e,r,s){var d=Te("square",e),_=(d-1)/2,n=i-_,a=t-_;return r>=n&&r<=n+d&&s>=a&&s<=a+d}function Lr(i,t,e,r,s){var d=(Te("arrowUp",s)-1)/2,_=(Os(s/2)-1)/2;t.beginPath(),i?(t.moveTo(e-d,r),t.lineTo(e,r-d),t.lineTo(e+d,r),t.lineTo(e+_,r),t.lineTo(e+_,r+d),t.lineTo(e-_,r+d),t.lineTo(e-_,r)):(t.moveTo(e-d,r),t.lineTo(e,r+d),t.lineTo(e+d,r),t.lineTo(e+_,r),t.lineTo(e+_,r-d),t.lineTo(e-_,r-d),t.lineTo(e-_,r)),t.fill()}function Na(i,t,e,r,s,d){return Fs(t,e,r,s,d)}var $a=function(i){function t(){var e=i!==null&&i.apply(this,arguments)||this;return e.Bt=null,e.rh=new ve,e.R=-1,e.I="",e.Yh="",e}return rt(t,i),t.prototype.Z=function(e){this.Bt=e},t.prototype.eh=function(e,r){this.R===e&&this.I===r||(this.R=e,this.I=r,this.Yh=ie(e,r),this.rh.ih())},t.prototype.$h=function(e,r){if(this.Bt===null||this.Bt.J===null)return null;for(var s=this.Bt.J.from;s<this.Bt.J.to;s++){var d=this.Bt.G[s];if(Ua(d,e,r))return{Kh:d.Xh,Zh:d.Zh}}return null},t.prototype.Y=function(e,r,s){if(this.Bt!==null&&this.Bt.J!==null){e.textBaseline="middle",e.font=this.Yh;for(var d=this.Bt.J.from;d<this.Bt.J.to;d++){var _=this.Bt.G[d];_.Gt!==void 0&&(_.Gt.Ht=this.rh.Qt(e,_.Gt.Jh),_.Gt.Yt=this.R),ja(_,e)}}},t}(Ie);function ja(i,t){t.fillStyle=i.A,i.Gt!==void 0&&function(e,r,s,d){e.fillText(r,s,d)}(t,i.Gt.Jh,i.tt-i.Gt.Ht/2,i.Gt.it),function(e,r){if(e.hs!==0){switch(e.Gh){case"arrowDown":return void Lr(!1,r,e.tt,e.it,e.hs);case"arrowUp":return void Lr(!0,r,e.tt,e.it,e.hs);case"circle":return void function(s,d,_,n){var a=(Te("circle",n)-1)/2;s.beginPath(),s.arc(d,_,a,0,2*Math.PI,!1),s.fill()}(r,e.tt,e.it,e.hs);case"square":return void function(s,d,_,n){var a=Te("square",n),u=(a-1)/2,p=d-u,c=_-u;s.fillRect(p,c,a,a)}(r,e.tt,e.it,e.hs)}e.Gh}}(i,t)}function Ua(i,t,e){return!(i.Gt===void 0||!function(r,s,d,_,n,a){var u=_/2;return n>=r&&n<=r+d&&a>=s-u&&a<=s+u}(i.tt,i.Gt.it,i.Gt.Ht,i.Gt.Yt,t,e))||function(r,s,d){if(r.hs===0)return!1;switch(r.Gh){case"arrowDown":case"arrowUp":return Na(0,r.tt,r.it,r.hs,s,d);case"circle":return function(_,n,a,u,p){var c=2+Te("circle",a)/2,g=_-u,S=n-p;return Math.sqrt(g*g+S*S)<=c}(r.tt,r.it,r.hs,s,d);case"square":return Fs(r.tt,r.it,r.hs,s,d)}}(i,t,e)}function Va(i,t,e,r,s,d,_,n,a){var u=Ft(e)?e:e.close,p=Ft(e)?e:e.high,c=Ft(e)?e:e.low,g=Ft(t.size)?Math.max(t.size,0):1,S=Hs(n.ws())*g,w=S/2;switch(i.hs=S,t.position){case"inBar":return i.it=_.xt(u,a),void(i.Gt!==void 0&&(i.Gt.it=i.it+w+d+.6*s));case"aboveBar":return i.it=_.xt(p,a)-w-r.Qh,i.Gt!==void 0&&(i.Gt.it=i.it-w-.6*s,r.Qh+=1.2*s),void(r.Qh+=S+d);case"belowBar":return i.it=_.xt(c,a)+w+r.tr,i.Gt!==void 0&&(i.Gt.it=i.it+w+d+.6*s,r.tr+=1.2*s),void(r.tr+=S+d)}t.position}var Ka=function(){function i(t,e){this.ft=!0,this.ir=!0,this.nr=!0,this.sr=null,this.zt=new $a,this.Vh=t,this.pi=e,this.Bt={G:[],J:null}}return i.prototype.vt=function(t){this.ft=!0,this.nr=!0,t==="data"&&(this.ir=!0)},i.prototype.dt=function(t,e,r){if(!this.Vh.yt())return null;this.ft&&this.Jn();var s=this.pi.W().layout;return this.zt.eh(s.fontSize,s.fontFamily),this.zt.Z(this.Bt),this.zt},i.prototype.hr=function(){if(this.nr){if(this.Vh.rr().length>0){var t=this.pi.bt().ws(),e=Rr(t),r=1.5*Hs(t)+2*e;this.sr={above:r,below:r}}else this.sr=null;this.nr=!1}return this.sr},i.prototype.Jn=function(){var t=this.Vh.Ct(),e=this.pi.bt(),r=this.Vh.rr();this.ir&&(this.Bt.G=r.map(function(w){return{rt:w.time,tt:0,it:0,hs:0,Gh:w.shape,A:w.color,Xh:w.Xh,Zh:w.id,Gt:void 0}}),this.ir=!1);var s=this.pi.W().layout;this.Bt.J=null;var d=e.ss();if(d!==null){var _=this.Vh.kt();if(_!==null&&this.Bt.G.length!==0){var n=NaN,a=Rr(e.ws()),u={Qh:a,tr:a};this.Bt.J=Yi(this.Bt.G,d,!0);for(var p=this.Bt.J.from;p<this.Bt.J.to;p++){var c=r[p];c.time!==n&&(u.Qh=a,u.tr=a,n=c.time);var g=this.Bt.G[p];g.tt=e.At(c.time),c.text!==void 0&&c.text.length>0&&(g.Gt={Jh:c.text,it:0,Ht:0,Yt:0});var S=this.Vh.er(c.time);S!==null&&Va(g,c,S,u,s.fontSize,a,t,e,_.St)}this.ft=!1}}},i}(),Ga=function(i){function t(e){return i.call(this,e)||this}return rt(t,i),t.prototype.bh=function(e,r){var s=this.wh;s.yt=!1;var d=this.Kn.W();if(d.priceLineVisible&&this.Kn.yt()){var _=this.Kn.jh(d.priceLineSource===0);_.qh||(s.yt=!0,s.it=_.ti,s.A=this.Kn.ur(_.A),s.Ht=r,s.Yt=e,s.Vt=d.priceLineWidth,s.Pt=d.priceLineStyle)}},t}(Qi),Xa=function(i){function t(e){var r=i.call(this)||this;return r.Rt=e,r}return rt(t,i),t.prototype.vi=function(e,r,s){e.yt=!1,r.yt=!1;var d=this.Rt;if(d.yt()){var _=d.W(),n=_.lastValueVisible,a=d.ar()!=="",u=_.seriesLastValueMode===0,p=d.jh(!1);if(!p.qh){n&&(e.Gt=this.lr(p,n,u),e.yt=e.Gt.length!==0),(a||u)&&(r.Gt=this.cr(p,n,a,u),r.yt=r.Gt.length>0);var c=d.ur(p.A),g=fi(c);s.t=g.t,s.A=g.i,s.ti=p.ti,r.Tt=d.jt().Dt(p.ti/d.Ct().Yt()),e.Tt=c}}},t.prototype.cr=function(e,r,s,d){var _="",n=this.Rt.ar();return s&&n.length!==0&&(_+="".concat(n," ")),r&&d&&(_+=this.Rt.Ct().vr()?e._r:e.dr),_.trim()},t.prototype.lr=function(e,r,s){return r?s?this.Rt.Ct().vr()?e.dr:e._r:e.Gt:""},t}(Xi),qt=function(){function i(t,e){this.wr=t,this.Mr=e}return i.prototype.br=function(t){return t!==null&&this.wr===t.wr&&this.Mr===t.Mr},i.prototype.mr=function(){return new i(this.wr,this.Mr)},i.prototype.pr=function(){return this.wr},i.prototype.gr=function(){return this.Mr},i.prototype.yr=function(){return this.Mr-this.wr},i.prototype.wi=function(){return this.Mr===this.wr||Number.isNaN(this.Mr)||Number.isNaN(this.wr)},i.prototype.Nn=function(t){return t===null?this:new i(Math.min(this.pr(),t.pr()),Math.max(this.gr(),t.gr()))},i.prototype.kr=function(t){if(Ft(t)&&this.Mr-this.wr!==0){var e=.5*(this.Mr+this.wr),r=this.Mr-e,s=this.wr-e;r*=t,s*=t,this.Mr=e+r,this.wr=e+s}},i.prototype.Nr=function(t){Ft(t)&&(this.Mr+=t,this.wr+=t)},i.prototype.Cr=function(){return{minValue:this.wr,maxValue:this.Mr}},i.Sr=function(t){return t===null?null:new i(t.minValue,t.maxValue)},i}(),Dr=function(){function i(t,e){this.Tr=t,this.Dr=e||null}return i.prototype.Ar=function(){return this.Tr},i.prototype.Br=function(){return this.Dr},i.prototype.Cr=function(){return this.Tr===null?null:{priceRange:this.Tr.Cr(),margins:this.Dr||void 0}},i.Sr=function(t){return t===null?null:new i(qt.Sr(t.priceRange),t.margins)},i}(),qa=function(i){function t(e,r){var s=i.call(this,e)||this;return s.Lr=r,s}return rt(t,i),t.prototype.bh=function(e,r){var s=this.wh;s.yt=!1;var d=this.Lr.W();if(this.Kn.yt()&&d.lineVisible){var _=this.Lr.Er();_!==null&&(s.yt=!0,s.it=_,s.A=d.color,s.Ht=r,s.Yt=e,s.Vt=d.lineWidth,s.Pt=d.lineStyle)}},t}(Qi),Ya=function(i){function t(e,r){var s=i.call(this)||this;return s.Vh=e,s.Lr=r,s}return rt(t,i),t.prototype.vi=function(e,r,s){e.yt=!1,r.yt=!1;var d=this.Lr.W(),_=d.axisLabelVisible,n=d.title!=="",a=this.Vh;if(_&&a.yt()){var u=this.Lr.Er();if(u!==null){n&&(r.Gt=d.title,r.yt=!0),r.Tt=a.jt().Dt(u/a.Ct().Yt()),e.Gt=a.Ct().Fr(d.price),e.yt=!0;var p=fi(d.color);s.t=p.t,s.A=p.i,s.ti=u}}},t}(Xi),Ja=function(){function i(t,e){this.Vh=t,this.zi=e,this.Or=new qa(t,this),this.uh=new Ya(t,this),this.Vr=new Is(this.uh,t,t.jt())}return i.prototype.Pr=function(t){ut(this.zi,t),this.vt(),this.Vh.jt().Wr()},i.prototype.W=function(){return this.zi},i.prototype.tn=function(){return[this.Or,this.Vr]},i.prototype.zr=function(){return this.uh},i.prototype.vt=function(){this.Or.vt(),this.uh.vt()},i.prototype.Er=function(){var t=this.Vh,e=t.Ct();if(t.jt().bt().wi()||e.wi())return null;var r=t.kt();return r===null?null:e.xt(this.zi.price,r.St)},i}(),Za=function(i){function t(e){var r=i.call(this)||this;return r.pi=e,r}return rt(t,i),t.prototype.jt=function(){return this.pi},t}(qi),ne={Ds:"",Hs:"",Us:""},Qa=function(){function i(t){this.Vh=t}return i.prototype.As=function(t,e){var r=this.Vh.Rr(),s=this.Vh.W();switch(r){case"Line":return this.Ir(s,t,e);case"Area":return this.jr(s);case"Baseline":return this.qr(s,t,e);case"Bar":return this.Ur(s,t,e);case"Candlestick":return this.Hr(s,t,e);case"Histogram":return this.Yr(s,t,e)}throw new Error("Unknown chart style")},i.prototype.Ur=function(t,e,r){var s=st({},ne),d=t.upColor,_=t.downColor,n=d,a=_,u=j(this.$r(e,r)),p=be(u.St[0])<=be(u.St[3]);return u.A!==void 0?(s.Ds=u.A,s.Hs=u.A):(s.Ds=p?d:_,s.Hs=p?n:a),s},i.prototype.Hr=function(t,e,r){var s,d,_,n=st({},ne),a=t.upColor,u=t.downColor,p=t.borderUpColor,c=t.borderDownColor,g=t.wickUpColor,S=t.wickDownColor,w=j(this.$r(e,r)),m=be(w.St[0])<=be(w.St[3]);return n.Ds=(s=w.A)!==null&&s!==void 0?s:m?a:u,n.Hs=(d=w.Tt)!==null&&d!==void 0?d:m?p:c,n.Us=(_=w.qs)!==null&&_!==void 0?_:m?g:S,n},i.prototype.jr=function(t){return st(st({},ne),{Ds:t.lineColor})},i.prototype.qr=function(t,e,r){var s=j(this.$r(e,r)).St[3]>=t.baseValue.price;return st(st({},ne),{Ds:s?t.topLineColor:t.bottomLineColor})},i.prototype.Ir=function(t,e,r){var s,d=j(this.$r(e,r));return st(st({},ne),{Ds:(s=d.A)!==null&&s!==void 0?s:t.color})},i.prototype.Yr=function(t,e,r){var s=st({},ne),d=j(this.$r(e,r));return s.Ds=d.A!==void 0?d.A:t.color,s},i.prototype.$r=function(t,e){return e!==void 0?e.St:this.Vh.an().Kr(t)},i}(),th=function(){function i(){this.Xr=[],this.Zr=new Map,this.Jr=new Map}return i.prototype.Gr=function(){return this.hs()>0?this.Xr[this.Xr.length-1]:null},i.prototype.Qr=function(){return this.hs()>0?this.te(0):null},i.prototype.un=function(){return this.hs()>0?this.te(this.Xr.length-1):null},i.prototype.hs=function(){return this.Xr.length},i.prototype.wi=function(){return this.hs()===0},i.prototype.Uh=function(t){return this.ie(t,0)!==null},i.prototype.Kr=function(t){return this.ne(t)},i.prototype.ne=function(t,e){e===void 0&&(e=0);var r=this.ie(t,e);return r===null?null:st(st({},this.se(r)),{vs:this.te(r)})},i.prototype.fs=function(){return this.Xr},i.prototype.he=function(t,e,r){if(this.wi())return null;for(var s=null,d=0,_=r;d<_.length;d++){var n=_[d];s=Ve(s,this.re(t,e,n))}return s},i.prototype.Z=function(t){this.Jr.clear(),this.Zr.clear(),this.Xr=t},i.prototype.te=function(t){return this.Xr[t].vs},i.prototype.se=function(t){return this.Xr[t]},i.prototype.ie=function(t,e){var r=this.ee(t);if(r===null&&e!==0)switch(e){case-1:return this.ue(t);case 1:return this.ae(t);default:throw new TypeError("Unknown search mode")}return r},i.prototype.ue=function(t){var e=this.oe(t);return e>0&&(e-=1),e!==this.Xr.length&&this.te(e)<t?e:null},i.prototype.ae=function(t){var e=this.le(t);return e!==this.Xr.length&&t<this.te(e)?e:null},i.prototype.ee=function(t){var e=this.oe(t);return e===this.Xr.length||t<this.Xr[e].vs?null:e},i.prototype.oe=function(t){return He(this.Xr,t,function(e,r){return e.vs<r})},i.prototype.le=function(t){return Ts(this.Xr,t,function(e,r){return r.vs>e})},i.prototype.fe=function(t,e,r){for(var s=null,d=t;d<e;d++){var _=this.Xr[d].St[r];Number.isNaN(_)||(s===null?s={ce:_,ve:_}:(_<s.ce&&(s.ce=_),_>s.ve&&(s.ve=_)))}return s},i.prototype.re=function(t,e,r){if(this.wi())return null;var s=null,d=j(this.Qr()),_=j(this.un()),n=Math.max(t,d),a=Math.min(e,_),u=30*Math.ceil(n/30),p=Math.max(u,30*Math.floor(a/30)),c=this.oe(n),g=this.le(Math.min(a,u,e));s=Ve(s,this.fe(c,g,r));var S=this.Zr.get(r);S===void 0&&(S=new Map,this.Zr.set(r,S));for(var w=Math.max(u+1,n);w<p;w+=30){var m=Math.floor(w/30),o=S.get(m);if(o===void 0){var h=this.oe(30*m),l=this.le(30*(m+1)-1);o=this.fe(h,l,r),S.set(m,o)}s=Ve(s,o)}return c=this.oe(p),g=this.le(a),s=Ve(s,this.fe(c,g,r))},i}();function Ve(i,t){return i===null?t:t===null?i:{ce:Math.min(i.ce,t.ce),ve:Math.max(i.ve,t.ve)}}var tr=function(i){function t(e,r,s){var d=i.call(this,e)||this;d.Bt=new th,d.Or=new Ga(d),d._e=[],d.de=new Ha(d),d.we=null,d.Me=null,d.be=[],d.me=[],d.pe=null,d.zi=r,d.ge=s;var _=new Xa(d);return d.Ei=[_],d.Vr=new Is(_,d,e),s!=="Area"&&s!=="Line"&&s!=="Baseline"||(d.we=new za(d)),d.ye(),d.ke(),d}return rt(t,i),t.prototype.g=function(){this.pe!==null&&clearTimeout(this.pe)},t.prototype.ur=function(e){return this.zi.priceLineColor||e},t.prototype.jh=function(e){var r={qh:!0},s=this.Ct();if(this.jt().bt().wi()||s.wi()||this.Bt.wi())return r;var d,_,n=this.jt().bt().ss(),a=this.kt();if(n===null||a===null)return r;if(e){var u=this.Bt.Gr();if(u===null)return r;d=u,_=u.vs}else{var p=this.Bt.ne(n.jn(),-1);if(p===null||(d=this.Bt.Kr(p.vs))===null)return r;_=p.vs}var c=d.St[3],g=this.ls().As(_,{St:d}),S=s.xt(c,a.St);return{qh:!1,et:c,Gt:s.Mi(c,a.St),_r:s.Fr(c),dr:s.Ne(c,a.St),A:g.Ds,ti:S,vs:_}},t.prototype.ls=function(){return this.Me!==null||(this.Me=new Qa(this)),this.Me},t.prototype.W=function(){return this.zi},t.prototype.Pr=function(e){var r=e.priceScaleId;r!==void 0&&r!==this.zi.priceScaleId&&this.jt().xe(this,r),ut(this.zi,e),this.ki!==null&&e.scaleMargins!==void 0&&this.ki.Pr({scaleMargins:e.scaleMargins}),e.priceFormat!==void 0&&(this.ye(),this.jt().Ce()),this.jt().Se(this),this.jt().Te(),this.Hi.vt("options")},t.prototype.Z=function(e,r){this.Bt.Z(e),this.De(),this.Hi.vt("data"),this.Ri.vt("data"),this.we!==null&&(r&&r.Ae?this.we.Wh():e.length===0&&this.we.Ph());var s=this.jt().oh(this);this.jt().Be(s),this.jt().Se(this),this.jt().Te(),this.jt().Wr()},t.prototype.Le=function(e){this.be=e.map(function(s){return st({},s)}),this.De();var r=this.jt().oh(this);this.Ri.vt("data"),this.jt().Be(r),this.jt().Se(this),this.jt().Te(),this.jt().Wr()},t.prototype.rr=function(){return this.me},t.prototype.Ee=function(e){var r=new Ja(this,e);return this._e.push(r),this.jt().Se(this),r},t.prototype.Fe=function(e){var r=this._e.indexOf(e);r!==-1&&this._e.splice(r,1),this.jt().Se(this)},t.prototype.Rr=function(){return this.ge},t.prototype.kt=function(){var e=this.Oe();return e===null?null:{St:e.St[3],Ve:e.rt}},t.prototype.Oe=function(){var e=this.jt().bt().ss();if(e===null)return null;var r=e.In();return this.Bt.ne(r,1)},t.prototype.an=function(){return this.Bt},t.prototype.er=function(e){var r=this.Bt.Kr(e);return r===null?null:this.ge==="Bar"||this.ge==="Candlestick"?{open:r.St[0],high:r.St[1],low:r.St[2],close:r.St[3]}:r.St[3]},t.prototype.Pe=function(e){var r=this,s=this.we;return s!==null&&s.yt()?(this.pe===null&&s.Rh()&&(this.pe=setTimeout(function(){r.pe=null,r.jt().We()},0)),s.zh(),[s]):[]},t.prototype.tn=function(){var e=[];this.ze()||e.push(this.de);for(var r=0,s=this._e;r<s.length;r++){var d=s[r];e.push.apply(e,d.tn())}return e.push(this.Hi,this.Or,this.Vr,this.Ri),e},t.prototype.nn=function(e,r){if(r!==this.ki&&!this.ze())return[];for(var s=Ms([],this.Ei),d=0,_=this._e;d<_.length;d++){var n=_[d];s.push(n.zr())}return s},t.prototype.Re=function(e,r){var s=this;if(this.zi.autoscaleInfoProvider!==void 0){var d=this.zi.autoscaleInfoProvider(function(){var _=s.Ie(e,r);return _===null?null:_.Cr()});return Dr.Sr(d)}return this.Ie(e,r)},t.prototype.je=function(){return this.zi.priceFormat.minMove},t.prototype.qe=function(){return this.Ue},t.prototype.hn=function(){var e;this.Hi.vt(),this.Ri.vt();for(var r=0,s=this.Ei;r<s.length;r++)s[r].vt();for(var d=0,_=this._e;d<_.length;d++)_[d].vt();this.Or.vt(),this.de.vt(),(e=this.we)===null||e===void 0||e.vt()},t.prototype.Ct=function(){return j(i.prototype.Ct.call(this))},t.prototype.gt=function(e){if(!((this.ge==="Line"||this.ge==="Area"||this.ge==="Baseline")&&this.zi.crosshairMarkerVisible))return null;var r=this.Bt.Kr(e);return r===null?null:{et:r.St[3],st:this.He(),Tt:this.Ye(),Nt:this.$e(e)}},t.prototype.ar=function(){return this.zi.title},t.prototype.yt=function(){return this.zi.visible},t.prototype.ze=function(){return!_i(this.Ct().Ke())},t.prototype.Ie=function(e,r){if(!De(e)||!De(r)||this.Bt.wi())return null;var s=this.ge==="Line"||this.ge==="Area"||this.ge==="Baseline"||this.ge==="Histogram"?[3]:[2,1],d=this.Bt.he(e,r,s),_=d!==null?new qt(d.ce,d.ve):null;if(this.Rr()==="Histogram"){var n=this.zi.base,a=new qt(n,n);_=_!==null?_.Nn(a):a}return new Dr(_,this.Ri.hr())},t.prototype.He=function(){switch(this.ge){case"Line":case"Area":case"Baseline":return this.zi.crosshairMarkerRadius}return 0},t.prototype.Ye=function(){switch(this.ge){case"Line":case"Area":case"Baseline":var e=this.zi.crosshairMarkerBorderColor;if(e.length!==0)return e}return null},t.prototype.$e=function(e){switch(this.ge){case"Line":case"Area":case"Baseline":var r=this.zi.crosshairMarkerBackgroundColor;if(r.length!==0)return r}return this.ls().As(e).Ds},t.prototype.ye=function(){switch(this.zi.priceFormat.type){case"custom":this.Ue={format:this.zi.priceFormat.formatter};break;case"volume":this.Ue=new ma(this.zi.priceFormat.precision);break;case"percent":this.Ue=new ks(this.zi.priceFormat.precision);break;default:var e=Math.pow(10,this.zi.priceFormat.precision);this.Ue=new vi(e,this.zi.priceFormat.minMove*e)}this.ki!==null&&this.ki.Xe()},t.prototype.De=function(){var e=this,r=this.jt().bt();if(r.wi()||this.Bt.hs()===0)this.me=[];else{var s=j(this.Bt.Qr());this.me=this.be.map(function(d,_){var n=j(r.Ze(d.time,!0)),a=n<s?1:-1;return{time:j(e.Bt.ne(n,a)).vs,position:d.position,shape:d.shape,color:d.color,id:d.id,Xh:_,text:d.text,size:d.size}})}},t.prototype.ke=function(){switch(this.Ri=new Ka(this,this.jt()),this.ge){case"Bar":this.Hi=new Ea(this,this.jt());break;case"Candlestick":this.Hi=new Ra(this,this.jt());break;case"Line":this.Hi=new Aa(this,this.jt());break;case"Area":this.Hi=new wa(this,this.jt());break;case"Baseline":this.Hi=new ka(this,this.jt());break;case"Histogram":this.Hi=new Ta(this,this.jt());break;default:throw Error("Unknown chart style assigned: "+this.ge)}},t}(Za),eh=function(){function i(t){this.zi=t}return i.prototype.Je=function(t,e,r){var s=t;if(this.zi.mode===0)return s;var d=r.ji(),_=d.kt();if(_===null)return s;var n=d.xt(t,_),a=r.Ge().filter(function(p){return p instanceof tr}).reduce(function(p,c){if(r.lh(c)||!c.yt())return p;var g=c.Ct(),S=c.an();if(g.wi()||!S.Uh(e))return p;var w=S.Kr(e);if(w===null)return p;var m=be(c.kt());return p.concat([g.xt(w.St[3],m.St)])},[]);if(a.length===0)return s;a.sort(function(p,c){return Math.abs(p-n)-Math.abs(c-n)});var u=a[0];return s=d.qi(u,_)},i}(),ih=function(){function i(){this.Bt=null}return i.prototype.Z=function(t){this.Bt=t},i.prototype.H=function(t,e,r,s){var d=this;if(this.Bt!==null){var _=Math.max(1,Math.floor(e));t.lineWidth=_;var n=Math.ceil(this.Bt.Ot*e),a=Math.ceil(this.Bt.Ft*e);(function(u,p){u.save(),u.lineWidth%2&&u.translate(.5,.5),p(),u.restore()})(t,function(){var u=j(d.Bt);if(u.Qe){t.strokeStyle=u.tu,ee(t,u.iu),t.beginPath();for(var p=0,c=u.nu;p<c.length;p++){var g=c[p],S=Math.round(g.su*e);t.moveTo(S,-_),t.lineTo(S,n+_)}t.stroke()}if(u.hu){t.strokeStyle=u.ru,ee(t,u.eu),t.beginPath();for(var w=0,m=u.uu;w<m.length;w++){var o=m[w],h=Math.round(o.su*e);t.moveTo(-_,h),t.lineTo(a+_,h)}t.stroke()}})}},i}(),rh=function(){function i(t){this.zt=new ih,this.ft=!0,this.Di=t}return i.prototype.vt=function(){this.ft=!0},i.prototype.dt=function(t,e){if(this.ft){var r=this.Di.jt().W().grid,s={Ot:t,Ft:e,hu:r.horzLines.visible,Qe:r.vertLines.visible,ru:r.horzLines.color,tu:r.vertLines.color,eu:r.horzLines.style,iu:r.vertLines.style,uu:this.Di.ji().au(),nu:this.Di.jt().bt().au()||[]};this.zt.Z(s),this.ft=!1}return this.zt},i}(),sh=function(){function i(t){this.Hi=new rh(t)}return i.prototype.ou=function(){return this.Hi},i}(),Si={lu:4,fu:1e-4};function ue(i,t){var e=100*(i-t)/t;return t<0?-e:e}function nh(i,t){var e=ue(i.pr(),t),r=ue(i.gr(),t);return new qt(e,r)}function Me(i,t){var e=100*(i-t)/t+100;return t<0?-e:e}function oh(i,t){var e=Me(i.pr(),t),r=Me(i.gr(),t);return new qt(e,r)}function ni(i,t){var e=Math.abs(i);if(e<1e-15)return 0;var r=Ps(e+t.fu)+t.lu;return i<0?-r:r}function xe(i,t){var e=Math.abs(i);if(e<1e-15)return 0;var r=Math.pow(10,e-t.lu)-t.fu;return i<0?-r:r}function Se(i,t){if(i===null)return null;var e=ni(i.pr(),t),r=ni(i.gr(),t);return new qt(e,r)}function Ke(i,t){if(i===null)return null;var e=xe(i.pr(),t),r=xe(i.gr(),t);return new qt(e,r)}function bi(i){if(i===null)return Si;var t=Math.abs(i.gr()-i.pr());if(t>=1||t<1e-15)return Si;var e=Math.ceil(Math.abs(Math.log10(t))),r=Si.lu+e;return{lu:r,fu:1/Math.pow(10,r)}}var Tr,wi=function(){function i(t,e){if(this.cu=t,this.vu=e,function(s){if(s<0)return!1;for(var d=s;d>1;d/=10)if(d%10!=0)return!1;return!0}(this.cu))this._u=[2,2.5,2];else{this._u=[];for(var r=this.cu;r!==1;){if(r%2==0)this._u.push(2),r/=2;else{if(r%5!=0)throw new Error("unexpected base");this._u.push(2,2.5),r/=5}if(this._u.length>100)throw new Error("something wrong with base")}}}return i.prototype.du=function(t,e,r){for(var s,d,_,n=this.cu===0?0:1/this.cu,a=Math.pow(10,Math.max(0,Math.ceil(Ps(t-e)))),u=0,p=this.vu[0];;){var c=Ue(a,n,1e-14)&&a>n+1e-14,g=Ue(a,r*p,1e-14),S=Ue(a,1,1e-14);if(!(c&&g&&S))break;a/=p,p=this.vu[++u%this.vu.length]}if(a<=n+1e-14&&(a=n),a=Math.max(1,a),this._u.length>0&&(s=a,d=1,_=1e-14,Math.abs(s-d)<_))for(u=0,p=this._u[0];Ue(a,r*p,1e-14)&&a>n+1e-14;)a/=p,p=this._u[++u%this._u.length];return a},i}(),Ar=function(){function i(t,e,r,s){this.wu=[],this._i=t,this.cu=e,this.Mu=r,this.bu=s}return i.prototype.du=function(t,e){if(t<e)throw new Error("high < low");var r=this._i.Yt(),s=(t-e)*this.mu()/r,d=new wi(this.cu,[2,2.5,2]),_=new wi(this.cu,[2,2,2.5]),n=new wi(this.cu,[2.5,2,2]),a=[];return a.push(d.du(t,e,s),_.du(t,e,s),n.du(t,e,s)),function(u){if(u.length<1)throw Error("array is empty");for(var p=u[0],c=1;c<u.length;++c)u[c]<p&&(p=u[c]);return p}(a)},i.prototype.pu=function(){var t=this._i,e=t.kt();if(e!==null){var r=t.Yt(),s=this.Mu(r-1,e),d=this.Mu(0,e),_=this._i.W().entireTextOnly?this.gu()/2:0,n=_,a=r-1-_,u=Math.max(s,d),p=Math.min(s,d);if(u!==p){for(var c=this.du(u,p),g=u%c,S=u>=p?1:-1,w=null,m=0,o=u-(g+=g<0?c:0);o>p;o-=c){var h=this.bu(o,e,!0);w!==null&&Math.abs(h-w)<this.mu()||h<n||h>a||(m<this.wu.length?(this.wu[m].su=h,this.wu[m].yu=t.ku(o)):this.wu.push({su:h,yu:t.ku(o)}),m++,w=h,t.Nu()&&(c=this.du(o*S,p)))}this.wu.length=m}else this.wu=[]}else this.wu=[]},i.prototype.au=function(){return this.wu},i.prototype.gu=function(){return this._i.S()},i.prototype.mu=function(){return Math.ceil(2.5*this.gu())},i}();function Ws(i){return i.slice().sort(function(t,e){return j(t.xi())-j(e.xi())})}(function(i){i[i.Normal=0]="Normal",i[i.Logarithmic=1]="Logarithmic",i[i.Percentage=2]="Percentage",i[i.IndexedTo100=3]="IndexedTo100"})(Tr||(Tr={}));var Pr=new ks,Or=new vi(100,1),ah=function(){function i(t,e,r,s){this.xu=0,this.Cu=null,this.Tr=null,this.Su=null,this.Tu={Du:!1,Au:null},this.Bu=0,this.Lu=0,this.Eu=new dt,this.Fu=new dt,this.Ou=[],this.Vu=null,this.Pu=null,this.Wu=null,this.zu=null,this.Ue=Or,this.Ru=bi(null),this.Iu=t,this.zi=e,this.ju=r,this.qu=s,this.Uu=new Ar(this,100,this.Hu.bind(this),this.Yu.bind(this))}return i.prototype.Ke=function(){return this.Iu},i.prototype.W=function(){return this.zi},i.prototype.Pr=function(t){if(ut(this.zi,t),this.Xe(),t.mode!==void 0&&this.$u({mh:t.mode}),t.scaleMargins!==void 0){var e=Rt(t.scaleMargins.top),r=Rt(t.scaleMargins.bottom);if(e<0||e>1)throw new Error("Invalid top margin - expect value between 0 and 1, given=".concat(e));if(r<0||r>1||e+r>1)throw new Error("Invalid bottom margin - expect value between 0 and 1, given=".concat(r));if(e+r>1)throw new Error("Invalid margins - sum of margins must be less than 1, given=".concat(e+r));this.Ku(),this.Pu=null}},i.prototype.Xu=function(){return this.zi.autoScale},i.prototype.Nu=function(){return this.zi.mode===1},i.prototype.vr=function(){return this.zi.mode===2},i.prototype.Zu=function(){return this.zi.mode===3},i.prototype.mh=function(){return{_n:this.zi.autoScale,Ju:this.zi.invertScale,mh:this.zi.mode}},i.prototype.$u=function(t){var e=this.mh(),r=null;t._n!==void 0&&(this.zi.autoScale=t._n),t.mh!==void 0&&(this.zi.mode=t.mh,t.mh!==2&&t.mh!==3||(this.zi.autoScale=!0),this.Tu.Du=!1),e.mh===1&&t.mh!==e.mh&&(function(d,_){if(d===null)return!1;var n=xe(d.pr(),_),a=xe(d.gr(),_);return isFinite(n)&&isFinite(a)}(this.Tr,this.Ru)?(r=Ke(this.Tr,this.Ru))!==null&&this.Gu(r):this.zi.autoScale=!0),t.mh===1&&t.mh!==e.mh&&(r=Se(this.Tr,this.Ru))!==null&&this.Gu(r);var s=e.mh!==this.zi.mode;s&&(e.mh===2||this.vr())&&this.Xe(),s&&(e.mh===3||this.Zu())&&this.Xe(),t.Ju!==void 0&&e.Ju!==t.Ju&&(this.zi.invertScale=t.Ju,this.Qu()),this.Fu.m(e,this.mh())},i.prototype.ta=function(){return this.Fu},i.prototype.S=function(){return this.ju.fontSize},i.prototype.Yt=function(){return this.xu},i.prototype.ia=function(t){this.xu!==t&&(this.xu=t,this.Ku(),this.Pu=null)},i.prototype.na=function(){if(this.Cu)return this.Cu;var t=this.Yt()-this.sa()-this.ha();return this.Cu=t,t},i.prototype.Ar=function(){return this.ra(),this.Tr},i.prototype.Gu=function(t,e){var r=this.Tr;(e||r===null&&t!==null||r!==null&&!r.br(t))&&(this.Pu=null,this.Tr=t)},i.prototype.wi=function(){return this.ra(),this.xu===0||!this.Tr||this.Tr.wi()},i.prototype.ea=function(t){return this.Ju()?t:this.Yt()-1-t},i.prototype.xt=function(t,e){return this.vr()?t=ue(t,e):this.Zu()&&(t=Me(t,e)),this.Yu(t,e)},i.prototype.us=function(t,e,r){this.ra();for(var s=this.ha(),d=j(this.Ar()),_=d.pr(),n=d.gr(),a=this.na()-1,u=this.Ju(),p=a/(n-_),c=r===void 0?0:r.from,g=r===void 0?t.length:r.to,S=this.ua(),w=c;w<g;w++){var m=t[w],o=m.et;if(!isNaN(o)){var h=o;S!==null&&(h=S(m.et,e));var l=s+p*(h-_),f=u?l:this.xu-1-l;m.it=f}}},i.prototype.Ss=function(t,e,r){this.ra();for(var s=this.ha(),d=j(this.Ar()),_=d.pr(),n=d.gr(),a=this.na()-1,u=this.Ju(),p=a/(n-_),c=r===void 0?0:r.from,g=r===void 0?t.length:r.to,S=this.ua(),w=c;w<g;w++){var m=t[w],o=m.open,h=m.high,l=m.low,f=m.close;S!==null&&(o=S(m.open,e),h=S(m.high,e),l=S(m.low,e),f=S(m.close,e));var v=s+p*(o-_),b=u?v:this.xu-1-v;m.xs=b,v=s+p*(h-_),b=u?v:this.xu-1-v,m.ys=b,v=s+p*(l-_),b=u?v:this.xu-1-v,m.ks=b,v=s+p*(f-_),b=u?v:this.xu-1-v,m.Cs=b}},i.prototype.qi=function(t,e){var r=this.Hu(t,e);return this.aa(r,e)},i.prototype.aa=function(t,e){var r=t;return this.vr()?r=function(s,d){return d<0&&(s=-s),s/100*d+d}(r,e):this.Zu()&&(r=function(s,d){return s-=100,d<0&&(s=-s),s/100*d+d}(r,e)),r},i.prototype.Ge=function(){return this.Ou},i.prototype.oa=function(){if(this.Vu)return this.Vu;for(var t=[],e=0;e<this.Ou.length;e++){var r=this.Ou[e];r.xi()===null&&r.Ci(e+1),t.push(r)}return t=Ws(t),this.Vu=t,this.Vu},i.prototype.la=function(t){this.Ou.indexOf(t)===-1&&(this.Ou.push(t),this.Xe(),this.fa())},i.prototype.ca=function(t){var e=this.Ou.indexOf(t);if(e===-1)throw new Error("source is not attached to scale");this.Ou.splice(e,1),this.Ou.length===0&&(this.$u({_n:!0}),this.Gu(null)),this.Xe(),this.fa()},i.prototype.kt=function(){for(var t=null,e=0,r=this.Ou;e<r.length;e++){var s=r[e].kt();s!==null&&(t===null||s.Ve<t.Ve)&&(t=s)}return t===null?null:t.St},i.prototype.Ju=function(){return this.zi.invertScale},i.prototype.au=function(){var t=this.kt()===null;if(this.Pu!==null&&(t||this.Pu.va===t))return this.Pu.au;this.Uu.pu();var e=this.Uu.au();return this.Pu={au:e,va:t},this.Eu.m(),e},i.prototype._a=function(){return this.Eu},i.prototype.da=function(t){this.vr()||this.Zu()||this.Wu===null&&this.Su===null&&(this.wi()||(this.Wu=this.xu-t,this.Su=j(this.Ar()).mr()))},i.prototype.wa=function(t){if(!this.vr()&&!this.Zu()&&this.Wu!==null){this.$u({_n:!1}),(t=this.xu-t)<0&&(t=0);var e=(this.Wu+.2*(this.xu-1))/(t+.2*(this.xu-1)),r=j(this.Su).mr();e=Math.max(e,.1),r.kr(e),this.Gu(r)}},i.prototype.Ma=function(){this.vr()||this.Zu()||(this.Wu=null,this.Su=null)},i.prototype.ba=function(t){this.Xu()||this.zu===null&&this.Su===null&&(this.wi()||(this.zu=t,this.Su=j(this.Ar()).mr()))},i.prototype.ma=function(t){if(!this.Xu()&&this.zu!==null){var e=j(this.Ar()).yr()/(this.na()-1),r=t-this.zu;this.Ju()&&(r*=-1);var s=r*e,d=j(this.Su).mr();d.Nr(s),this.Gu(d,!0),this.Pu=null}},i.prototype.pa=function(){this.Xu()||this.zu!==null&&(this.zu=null,this.Su=null)},i.prototype.qe=function(){return this.Ue||this.Xe(),this.Ue},i.prototype.Mi=function(t,e){switch(this.zi.mode){case 2:return this.qe().format(ue(t,e));case 3:return this.qe().format(Me(t,e));default:return this.ga(t)}},i.prototype.ku=function(t){switch(this.zi.mode){case 2:case 3:return this.qe().format(t);default:return this.ga(t)}},i.prototype.Fr=function(t){return this.ga(t,j(this.ya()).qe())},i.prototype.Ne=function(t,e){return t=ue(t,e),Pr.format(t)},i.prototype.ka=function(){return this.Ou},i.prototype.Na=function(t){this.Tu={Au:t,Du:!1}},i.prototype.hn=function(){this.Ou.forEach(function(t){return t.hn()})},i.prototype.Xe=function(){this.Pu=null;var t=this.ya(),e=100;t!==null&&(e=Math.round(1/t.je())),this.Ue=Or,this.vr()?(this.Ue=Pr,e=100):this.Zu()?(this.Ue=new vi(100,1),e=100):t!==null&&(this.Ue=t.qe()),this.Uu=new Ar(this,e,this.Hu.bind(this),this.Yu.bind(this)),this.Uu.pu()},i.prototype.fa=function(){this.Vu=null},i.prototype.ya=function(){return this.Ou[0]||null},i.prototype.sa=function(){return this.Ju()?this.zi.scaleMargins.bottom*this.Yt()+this.Lu:this.zi.scaleMargins.top*this.Yt()+this.Bu},i.prototype.ha=function(){return this.Ju()?this.zi.scaleMargins.top*this.Yt()+this.Bu:this.zi.scaleMargins.bottom*this.Yt()+this.Lu},i.prototype.ra=function(){this.Tu.Du||(this.Tu.Du=!0,this.xa())},i.prototype.Ku=function(){this.Cu=null},i.prototype.Yu=function(t,e){if(this.ra(),this.wi())return 0;t=this.Nu()&&t?ni(t,this.Ru):t;var r=j(this.Ar()),s=this.ha()+(this.na()-1)*(t-r.pr())/r.yr();return this.ea(s)},i.prototype.Hu=function(t,e){if(this.ra(),this.wi())return 0;var r=this.ea(t),s=j(this.Ar()),d=s.pr()+s.yr()*((r-this.ha())/(this.na()-1));return this.Nu()?xe(d,this.Ru):d},i.prototype.Qu=function(){this.Pu=null,this.Uu.pu()},i.prototype.xa=function(){var t=this.Tu.Au;if(t!==null){for(var e,r,s=null,d=0,_=0,n=0,a=this.ka();n<a.length;n++){var u=a[n];if(u.yt()){var p=u.kt();if(p!==null){var c=u.Re(t.In(),t.jn()),g=c&&c.Ar();if(g!==null){switch(this.zi.mode){case 1:g=Se(g,this.Ru);break;case 2:g=nh(g,p.St);break;case 3:g=oh(g,p.St)}if(s=s===null?g:s.Nn(j(g)),c!==null){var S=c.Br();S!==null&&(d=Math.max(d,S.above),_=Math.max(d,S.below))}}}}}if(d===this.Bu&&_===this.Lu||(this.Bu=d,this.Lu=_,this.Pu=null,this.Ku()),s!==null){if(s.pr()===s.gr()){var w=this.ya(),m=5*(w===null||this.vr()||this.Zu()?1:w.je());this.Nu()&&(s=Ke(s,this.Ru)),s=new qt(s.pr()-m,s.gr()+m),this.Nu()&&(s=Se(s,this.Ru))}if(this.Nu()){var o=Ke(s,this.Ru),h=bi(o);if(e=h,r=this.Ru,e.lu!==r.lu||e.fu!==r.fu){var l=this.Su!==null?Ke(this.Su,this.Ru):null;this.Ru=h,s=Se(o,h),l!==null&&(this.Su=Se(l,h))}}this.Gu(s)}else this.Tr===null&&(this.Gu(new qt(-.5,.5)),this.Ru=bi(null));this.Tu.Du=!0}},i.prototype.ua=function(){var t=this;return this.vr()?ue:this.Zu()?Me:this.Nu()?function(e){return ni(e,t.Ru)}:null},i.prototype.ga=function(t,e){return this.qu.priceFormatter===void 0?(e===void 0&&(e=this.qe()),e.format(t)):this.qu.priceFormatter(t)},i}(),hh=function(){function i(t,e){this.Ou=[],this.Ca=new Map,this.xu=0,this.hh=0,this.Sa=1e3,this.Vu=null,this.Ta=new dt,this.Da=t,this.pi=e,this.Aa=new sh(this);var r=e.W();this.Ba=this.La("left",r.leftPriceScale),this.Ea=this.La("right",r.rightPriceScale),this.Ba.ta().u(this.Fa.bind(this,this.Ba),this),this.Ea.ta().u(this.Fa.bind(this,this.Ba),this),this.Oa(r)}return i.prototype.Oa=function(t){if(t.leftPriceScale&&this.Ba.Pr(t.leftPriceScale),t.rightPriceScale&&this.Ea.Pr(t.rightPriceScale),t.localization&&(this.Ba.Xe(),this.Ea.Xe()),t.overlayPriceScales)for(var e=0,r=Array.from(this.Ca.values());e<r.length;e++){var s=j(r[e][0].Ct());s.Pr(t.overlayPriceScales),t.localization&&s.Xe()}},i.prototype.Va=function(t){switch(t){case"left":return this.Ba;case"right":return this.Ea}return this.Ca.has(t)?Rt(this.Ca.get(t))[0].Ct():null},i.prototype.g=function(){this.jt().Pa().M(this),this.Ba.ta().M(this),this.Ea.ta().M(this),this.Ou.forEach(function(t){t.g&&t.g()}),this.Ta.m()},i.prototype.Wa=function(){return this.Sa},i.prototype.za=function(t){this.Sa=t},i.prototype.jt=function(){return this.pi},i.prototype.Ht=function(){return this.hh},i.prototype.Yt=function(){return this.xu},i.prototype.Ra=function(t){this.hh=t,this.Ia()},i.prototype.ia=function(t){var e=this;this.xu=t,this.Ba.ia(t),this.Ea.ia(t),this.Ou.forEach(function(r){if(e.lh(r)){var s=r.Ct();s!==null&&s.ia(t)}}),this.Ia()},i.prototype.Ge=function(){return this.Ou},i.prototype.lh=function(t){var e=t.Ct();return e===null||this.Ba!==e&&this.Ea!==e},i.prototype.la=function(t,e,r){var s=r!==void 0?r:this.qa().ja+1;this.Ua(t,e,s)},i.prototype.ca=function(t){var e=this.Ou.indexOf(t);ge(e!==-1,"removeDataSource: invalid data source"),this.Ou.splice(e,1);var r=j(t.Ct()).Ke();if(this.Ca.has(r)){var s=Rt(this.Ca.get(r)),d=s.indexOf(t);d!==-1&&(s.splice(d,1),s.length===0&&this.Ca.delete(r))}var _=t.Ct();_&&_.Ge().indexOf(t)>=0&&_.ca(t),_!==null&&(_.fa(),this.Ha(_)),this.Vu=null},i.prototype._h=function(t){return t===this.Ba?"left":t===this.Ea?"right":"overlay"},i.prototype.Ya=function(){return this.Ba},i.prototype.$a=function(){return this.Ea},i.prototype.Ka=function(t,e){t.da(e)},i.prototype.Xa=function(t,e){t.wa(e),this.Ia()},i.prototype.Za=function(t){t.Ma()},i.prototype.Ja=function(t,e){t.ba(e)},i.prototype.Ga=function(t,e){t.ma(e),this.Ia()},i.prototype.Qa=function(t){t.pa()},i.prototype.Ia=function(){this.Ou.forEach(function(t){t.hn()})},i.prototype.ji=function(){var t=null;return this.pi.W().rightPriceScale.visible&&this.Ea.Ge().length!==0?t=this.Ea:this.pi.W().leftPriceScale.visible&&this.Ba.Ge().length!==0?t=this.Ba:this.Ou.length!==0&&(t=this.Ou[0].Ct()),t===null&&(t=this.Ea),t},i.prototype.fh=function(){var t=null;return this.pi.W().rightPriceScale.visible?t=this.Ea:this.pi.W().leftPriceScale.visible&&(t=this.Ba),t},i.prototype.Ha=function(t){t!==null&&t.Xu()&&this.io(t)},i.prototype.no=function(t){var e=this.Da.ss();t.$u({_n:!0}),e!==null&&t.Na(e),this.Ia()},i.prototype.so=function(){this.io(this.Ba),this.io(this.Ea)},i.prototype.ho=function(){var t=this;this.Ha(this.Ba),this.Ha(this.Ea),this.Ou.forEach(function(e){t.lh(e)&&t.Ha(e.Ct())}),this.Ia(),this.pi.Wr()},i.prototype.oa=function(){return this.Vu===null&&(this.Vu=Ws(this.Ou)),this.Vu},i.prototype.ro=function(){return this.Ta},i.prototype.eo=function(){return this.Aa},i.prototype.io=function(t){var e=t.ka();if(e&&e.length>0&&!this.Da.wi()){var r=this.Da.ss();r!==null&&t.Na(r)}t.hn()},i.prototype.qa=function(){var t=this.oa();if(t.length===0)return{uo:0,ja:0};for(var e=0,r=0,s=0;s<t.length;s++){var d=t[s].xi();d!==null&&(d<e&&(e=d),d>r&&(r=d))}return{uo:e,ja:r}},i.prototype.Ua=function(t,e,r){var s=this.Va(e);if(s===null&&(s=this.La(e,this.pi.W().overlayPriceScales)),this.Ou.push(t),!_i(e)){var d=this.Ca.get(e)||[];d.push(t),this.Ca.set(e,d)}s.la(t),t.Si(s),t.Ci(r),this.Ha(s),this.Vu=null},i.prototype.Fa=function(t,e,r){e.mh!==r.mh&&this.io(t)},i.prototype.La=function(t,e){var r=st({visible:!0,autoScale:!0},vt(e)),s=new ah(t,r,this.pi.W().layout,this.pi.W().localization);return s.ia(this.Yt()),s},i}(),Ir=function(i){return i.getUTCFullYear()};function lh(i,t,e){return t.replace(/yyyy/g,function(r){return Gt(Ir(r),4)}(i)).replace(/yy/g,function(r){return Gt(Ir(r)%100,2)}(i)).replace(/MMMM/g,function(r,s){return new Date(r.getUTCFullYear(),r.getUTCMonth(),1).toLocaleString(s,{month:"long"})}(i,e)).replace(/MMM/g,function(r,s){return new Date(r.getUTCFullYear(),r.getUTCMonth(),1).toLocaleString(s,{month:"short"})}(i,e)).replace(/MM/g,function(r){return Gt(function(s){return s.getUTCMonth()+1}(r),2)}(i)).replace(/dd/g,function(r){return Gt(function(s){return s.getUTCDate()}(r),2)}(i))}var zs=function(){function i(t,e){t===void 0&&(t="yyyy-MM-dd"),e===void 0&&(e="default"),this.ao=t,this.oo=e}return i.prototype.lo=function(t){return lh(t,this.ao,this.oo)},i}(),ch=function(){function i(t){this.fo=t||"%h:%m:%s"}return i.prototype.lo=function(t){return this.fo.replace("%h",Gt(t.getUTCHours(),2)).replace("%m",Gt(t.getUTCMinutes(),2)).replace("%s",Gt(t.getUTCSeconds(),2))},i}(),uh={co:"yyyy-MM-dd",vo:"%h:%m:%s",_o:" ",do:"default"},fh=function(){function i(t){t===void 0&&(t={});var e=st(st({},uh),t);this.wo=new zs(e.co,e.do),this.Mo=new ch(e.vo),this.bo=e._o}return i.prototype.lo=function(t){return"".concat(this.wo.lo(t)).concat(this.bo).concat(this.Mo.lo(t))},i}(),dh=function(){function i(t,e){e===void 0&&(e=50),this.mo=0,this.po=1,this.yo=1,this.Gs=new Map,this.ko=new Map,this.No=t,this.xo=e}return i.prototype.lo=function(t){var e=t.Co===void 0?new Date(1e3*t.So).getTime():new Date(Date.UTC(t.Co.year,t.Co.month-1,t.Co.day)).getTime(),r=this.Gs.get(e);if(r!==void 0)return r.To;if(this.mo===this.xo){var s=this.ko.get(this.yo);this.ko.delete(this.yo),this.Gs.delete(Rt(s)),this.yo++,this.mo--}var d=this.No(t);return this.Gs.set(e,{To:d,Do:this.po}),this.ko.set(this.po,e),this.mo++,this.po++,d},i}(),ke=function(){function i(t,e){ge(t<=e,"right should be >= left"),this.Ao=t,this.Bo=e}return i.prototype.In=function(){return this.Ao},i.prototype.jn=function(){return this.Bo},i.prototype.Lo=function(){return this.Bo-this.Ao+1},i.prototype.Uh=function(t){return this.Ao<=t&&t<=this.Bo},i.prototype.br=function(t){return this.Ao===t.In()&&this.Bo===t.jn()},i}();function Hr(i,t){return i===null||t===null?i===t:i.br(t)}var Fr,ph=function(){function i(){this.Eo=new Map,this.Gs=null}return i.prototype.Fo=function(t,e){this.Oo(e),this.Gs=null;for(var r=e;r<t.length;++r){var s=t[r],d=this.Eo.get(s.Vo);d===void 0&&(d=[],this.Eo.set(s.Vo,d)),d.push({vs:r,rt:s.rt,Po:s.Vo})}},i.prototype.Wo=function(t,e){var r=Math.ceil(e/t);return this.Gs!==null&&this.Gs.zo===r||(this.Gs={au:this.Ro(r),zo:r}),this.Gs.au},i.prototype.Oo=function(t){if(t!==0){var e=[];this.Eo.forEach(function(_,n){t<=_[0].vs?e.push(n):_.splice(He(_,t,function(a){return a.vs<t}),1/0)});for(var r=0,s=e;r<s.length;r++){var d=s[r];this.Eo.delete(d)}}else this.Eo.clear()},i.prototype.Ro=function(t){for(var e=[],r=0,s=Array.from(this.Eo.keys()).sort(function(l,f){return f-l});r<s.length;r++){var d=s[r];if(this.Eo.get(d)){var _=e;e=[];for(var n=_.length,a=0,u=Rt(this.Eo.get(d)),p=u.length,c=1/0,g=-1/0,S=0;S<p;S++){for(var w=u[S],m=w.vs;a<n;){var o=_[a],h=o.vs;if(!(h<m)){c=h;break}a++,e.push(o),g=h,c=1/0}c-m>=t&&m-g>=t&&(e.push(w),g=m)}for(;a<n;a++)e.push(_[a])}}return e},i}(),Qe=function(){function i(t){this.Io=t}return i.prototype.jo=function(){return this.Io===null?null:new ke(Math.floor(this.Io.In()),Math.ceil(this.Io.jn()))},i.prototype.qo=function(){return this.Io},i.Uo=function(){return new i(null)},i}();(function(i){i[i.Year=0]="Year",i[i.Month=1]="Month",i[i.DayOfMonth=2]="DayOfMonth",i[i.Time=3]="Time",i[i.TimeWithSeconds=4]="TimeWithSeconds"})(Fr||(Fr={}));var _h=function(){function i(t,e,r){this.hh=0,this.Ho=null,this.Yo=[],this.zu=null,this.Wu=null,this.$o=new ph,this.Ko=new Map,this.Xo=Qe.Uo(),this.Zo=!0,this.Jo=new dt,this.Go=new dt,this.Qo=new dt,this.tl=null,this.il=null,this.nl=[],this.zi=e,this.qu=r,this.sl=e.rightOffset,this.hl=e.barSpacing,this.pi=t,this.rl()}return i.prototype.W=function(){return this.zi},i.prototype.el=function(t){ut(this.qu,t),this.ul(),this.rl()},i.prototype.Pr=function(t,e){var r;ut(this.zi,t),this.zi.fixLeftEdge&&this.al(),this.zi.fixRightEdge&&this.ol(),t.barSpacing!==void 0&&this.pi.gn(t.barSpacing),t.rightOffset!==void 0&&this.pi.yn(t.rightOffset),t.minBarSpacing!==void 0&&this.pi.gn((r=t.barSpacing)!==null&&r!==void 0?r:this.hl),this.ul(),this.rl(),this.Qo.m()},i.prototype.gi=function(t){var e;return((e=this.Yo[t])===null||e===void 0?void 0:e.rt)||null},i.prototype.Ze=function(t,e){if(this.Yo.length<1)return null;if(t.So>this.Yo[this.Yo.length-1].rt.So)return e?this.Yo.length-1:null;var r=He(this.Yo,t.So,function(s,d){return s.rt.So<d});return t.So<this.Yo[r].rt.So?e?r:null:r},i.prototype.wi=function(){return this.hh===0||this.Yo.length===0||this.Ho===null},i.prototype.ss=function(){return this.ll(),this.Xo.jo()},i.prototype.fl=function(){return this.ll(),this.Xo.qo()},i.prototype.cl=function(){var t=this.ss();if(t===null)return null;var e={from:t.In(),to:t.jn()};return this.vl(e)},i.prototype.vl=function(t){var e=Math.round(t.from),r=Math.round(t.to),s=j(this._l()),d=j(this.dl());return{from:j(this.gi(Math.max(s,e))),to:j(this.gi(Math.min(d,r)))}},i.prototype.wl=function(t){return{from:j(this.Ze(t.from,!0)),to:j(this.Ze(t.to,!0))}},i.prototype.Ht=function(){return this.hh},i.prototype.Ra=function(t){if(isFinite(t)&&!(t<=0)&&this.hh!==t){if(this.zi.lockVisibleTimeRangeOnResize&&this.hh){var e=this.hl*t/this.hh;this.hl=e}if(this.zi.fixLeftEdge){var r=this.ss();if(r!==null&&r.In()<=0){var s=this.hh-t;this.sl-=Math.round(s/this.hl)+1}}this.hh=t,this.Zo=!0,this.Ml(),this.bl()}},i.prototype.At=function(t){if(this.wi()||!De(t))return 0;var e=this.ml()+this.sl-t;return this.hh-(e+.5)*this.hl-1},i.prototype.es=function(t,e){for(var r=this.ml(),s=e===void 0?0:e.from,d=e===void 0?t.length:e.to,_=s;_<d;_++){var n=t[_].rt,a=r+this.sl-n,u=this.hh-(a+.5)*this.hl-1;t[_].tt=u}},i.prototype.pl=function(t){return Math.ceil(this.gl(t))},i.prototype.yn=function(t){this.Zo=!0,this.sl=t,this.bl(),this.pi.yl(),this.pi.Wr()},i.prototype.ws=function(){return this.hl},i.prototype.gn=function(t){this.kl(t),this.bl(),this.pi.yl(),this.pi.Wr()},i.prototype.Nl=function(){return this.sl},i.prototype.au=function(){if(this.wi())return null;if(this.il!==null)return this.il;for(var t=this.hl,e=5*(this.pi.W().layout.fontSize+4),r=Math.round(e/t),s=j(this.ss()),d=Math.max(s.In(),s.In()-r),_=Math.max(s.jn(),s.jn()-r),n=this.$o.Wo(t,e),a=this._l()+r,u=this.dl()-r,p=this.xl(),c=this.zi.fixLeftEdge||p,g=this.zi.fixRightEdge||p,S=0,w=0,m=n;w<m.length;w++){var o=m[w];if(d<=o.vs&&o.vs<=_){var h=void 0;S<this.nl.length?((h=this.nl[S]).su=this.At(o.vs),h.yu=this.Cl(o.rt,o.Po),h.Po=o.Po):(h={Sl:!1,su:this.At(o.vs),yu:this.Cl(o.rt,o.Po),Po:o.Po},this.nl.push(h)),this.hl>e/2&&!p?h.Sl=!1:h.Sl=c&&o.vs<=a||g&&o.vs>=u,S++}}return this.nl.length=S,this.il=this.nl,this.nl},i.prototype.Tl=function(){this.Zo=!0,this.gn(this.zi.barSpacing),this.yn(this.zi.rightOffset)},i.prototype.Dl=function(t){this.Zo=!0,this.Ho=t,this.bl(),this.al()},i.prototype.Al=function(t,e){var r=this.gl(t),s=this.ws(),d=s+e*(s/10);this.gn(d),this.zi.rightBarStaysOnScroll||this.yn(this.Nl()+(r-this.gl(t)))},i.prototype.da=function(t){this.zu&&this.pa(),this.Wu===null&&this.tl===null&&(this.wi()||(this.Wu=t,this.Bl()))},i.prototype.wa=function(t){if(this.tl!==null){var e=si(this.hh-t,0,this.hh),r=si(this.hh-j(this.Wu),0,this.hh);e!==0&&r!==0&&this.gn(this.tl.ws*e/r)}},i.prototype.Ma=function(){this.Wu!==null&&(this.Wu=null,this.Ll())},i.prototype.ba=function(t){this.zu===null&&this.tl===null&&(this.wi()||(this.zu=t,this.Bl()))},i.prototype.ma=function(t){if(this.zu!==null){var e=(this.zu-t)/this.ws();this.sl=j(this.tl).Nl+e,this.Zo=!0,this.bl()}},i.prototype.pa=function(){this.zu!==null&&(this.zu=null,this.Ll())},i.prototype.El=function(){this.Fl(this.zi.rightOffset)},i.prototype.Fl=function(t,e){var r=this;if(e===void 0&&(e=400),!isFinite(t))throw new RangeError("offset is required and must be finite number");if(!isFinite(e)||e<=0)throw new RangeError("animationDuration (optional) must be finite positive number");var s=this.sl,d=performance.now(),_=function(){var n=(performance.now()-d)/e,a=n>=1,u=a?t:s+(t-s)*n;r.yn(u),a||setTimeout(_,20)};_()},i.prototype.vt=function(t,e){this.Zo=!0,this.Yo=t,this.$o.Fo(t,e),this.bl()},i.prototype.Ol=function(){return this.Jo},i.prototype.Vl=function(){return this.Go},i.prototype.Pl=function(){return this.Qo},i.prototype.ml=function(){return this.Ho||0},i.prototype.Wl=function(t){var e=t.Lo();this.kl(this.hh/e),this.sl=t.jn()-this.ml(),this.bl(),this.Zo=!0,this.pi.yl(),this.pi.Wr()},i.prototype.zl=function(){var t=this._l(),e=this.dl();t!==null&&e!==null&&this.Wl(new ke(t,e+this.zi.rightOffset))},i.prototype.Rl=function(t){var e=new ke(t.from,t.to);this.Wl(e)},i.prototype.yi=function(t){return this.qu.timeFormatter!==void 0?this.qu.timeFormatter(t.Co||t.So):this.Il.lo(new Date(1e3*t.So))},i.prototype.xl=function(){var t=this.pi.W(),e=t.handleScroll,r=t.handleScale;return!(e.horzTouchDrag||e.mouseWheel||e.pressedMouseMove||e.vertTouchDrag||r.axisDoubleClickReset||r.axisPressedMouseMove.time||r.mouseWheel||r.pinch)},i.prototype._l=function(){return this.Yo.length===0?null:0},i.prototype.dl=function(){return this.Yo.length===0?null:this.Yo.length-1},i.prototype.jl=function(t){return(this.hh-1-t)/this.hl},i.prototype.gl=function(t){var e=this.jl(t),r=this.ml()+this.sl-e;return Math.round(1e6*r)/1e6},i.prototype.kl=function(t){var e=this.hl;this.hl=t,this.Ml(),e!==this.hl&&(this.Zo=!0,this.ql())},i.prototype.ll=function(){if(this.Zo)if(this.Zo=!1,this.wi())this.Ul(Qe.Uo());else{var t=this.ml(),e=this.hh/this.hl,r=this.sl+t,s=new ke(r-e+1,r);this.Ul(new Qe(s))}},i.prototype.Ml=function(){var t=this.Hl();if(this.hl<t&&(this.hl=t,this.Zo=!0),this.hh!==0){var e=.5*this.hh;this.hl>e&&(this.hl=e,this.Zo=!0)}},i.prototype.Hl=function(){return this.zi.fixLeftEdge&&this.zi.fixRightEdge&&this.Yo.length!==0?this.hh/this.Yo.length:this.zi.minBarSpacing},i.prototype.bl=function(){var t=this.Yl();this.sl>t&&(this.sl=t,this.Zo=!0);var e=this.$l();e!==null&&this.sl<e&&(this.sl=e,this.Zo=!0)},i.prototype.$l=function(){var t=this._l(),e=this.Ho;return t===null||e===null?null:t-e-1+(this.zi.fixLeftEdge?this.hh/this.hl:Math.min(2,this.Yo.length))},i.prototype.Yl=function(){return this.zi.fixRightEdge?0:this.hh/this.hl-Math.min(2,this.Yo.length)},i.prototype.Bl=function(){this.tl={ws:this.ws(),Nl:this.Nl()}},i.prototype.Ll=function(){this.tl=null},i.prototype.Cl=function(t,e){var r=this,s=this.Ko.get(e);return s===void 0&&(s=new dh(function(d){return r.Kl(d,e)}),this.Ko.set(e,s)),s.lo(t)},i.prototype.Kl=function(t,e){var r,s=function(d,_,n){switch(d){case 0:case 10:return _?n?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return _?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(e,this.zi.timeVisible,this.zi.secondsVisible);return this.zi.tickMarkFormatter!==void 0?this.zi.tickMarkFormatter((r=t.Co)!==null&&r!==void 0?r:t.So,s,this.qu.locale):function(d,_,n){var a={};switch(_){case 0:a.year="numeric";break;case 1:a.month="short";break;case 2:a.day="numeric";break;case 3:a.hour12=!1,a.hour="2-digit",a.minute="2-digit";break;case 4:a.hour12=!1,a.hour="2-digit",a.minute="2-digit",a.second="2-digit"}var u=d.Co===void 0?new Date(1e3*d.So):new Date(Date.UTC(d.Co.year,d.Co.month-1,d.Co.day));return new Date(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate(),u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()).toLocaleString(n,a)}(t,s,this.qu.locale)},i.prototype.Ul=function(t){var e=this.Xo;this.Xo=t,Hr(e.jo(),this.Xo.jo())||this.Jo.m(),Hr(e.qo(),this.Xo.qo())||this.Go.m(),this.ql()},i.prototype.ql=function(){this.il=null},i.prototype.ul=function(){this.ql(),this.Ko.clear()},i.prototype.rl=function(){var t=this.qu.dateFormat;this.zi.timeVisible?this.Il=new fh({co:t,vo:this.zi.secondsVisible?"%h:%m:%s":"%h:%m",_o:"   ",do:this.qu.locale}):this.Il=new zs(t,this.qu.locale)},i.prototype.al=function(){if(this.zi.fixLeftEdge){var t=this._l();if(t!==null){var e=this.ss();if(e!==null){var r=e.In()-t;if(r<0){var s=this.sl-r-1;this.yn(s)}this.Ml()}}}},i.prototype.ol=function(){this.bl(),this.Ml()},i}(),Wr,vh=function(i){function t(e){var r=i.call(this)||this;return r.Xl=new Map,r.Bt=e,r}return rt(t,i),t.prototype.Y=function(e){},t.prototype.K=function(e){if(this.Bt.yt){e.save();for(var r=0,s=0,d=this.Bt.Zl;s<d.length;s++)if((p=d[s]).Gt.length!==0){e.font=p.T;var _=this.Jl(e,p.Gt);_>this.Bt.Ht?p.Al=this.Bt.Ht/_:p.Al=1,r+=p.Gl*p.Al}var n=0;switch(this.Bt.Ql){case"top":n=0;break;case"center":n=Math.max((this.Bt.Yt-r)/2,0);break;case"bottom":n=Math.max(this.Bt.Yt-r,0)}e.fillStyle=this.Bt.A;for(var a=0,u=this.Bt.Zl;a<u.length;a++){var p=u[a];e.save();var c=0;switch(this.Bt.tf){case"left":e.textAlign="left",c=p.Gl/2;break;case"center":e.textAlign="center",c=this.Bt.Ht/2;break;case"right":e.textAlign="right",c=this.Bt.Ht-1-p.Gl/2}e.translate(c,n),e.textBaseline="top",e.font=p.T,e.scale(p.Al,p.Al),e.fillText(p.Gt,0,p.if),e.restore(),n+=p.Gl*p.Al}e.restore()}},t.prototype.Jl=function(e,r){var s=this.nf(e.font),d=s.get(r);return d===void 0&&(d=e.measureText(r).width,s.set(r,d)),d},t.prototype.nf=function(e){var r=this.Xl.get(e);return r===void 0&&(r=new Map,this.Xl.set(e,r)),r},t}(Ie),gh=function(){function i(t){this.ft=!0,this.Wt={yt:!1,A:"",Yt:0,Ht:0,Zl:[],Ql:"center",tf:"center"},this.zt=new vh(this.Wt),this.Rt=t}return i.prototype.vt=function(){this.ft=!0},i.prototype.dt=function(t,e){return this.ft&&(this.wt(t,e),this.ft=!1),this.zt},i.prototype.wt=function(t,e){var r=this.Rt.W(),s=this.Wt;s.yt=r.visible,s.yt&&(s.A=r.color,s.Ht=e,s.Yt=t,s.tf=r.horzAlign,s.Ql=r.vertAlign,s.Zl=[{Gt:r.text,T:ie(r.fontSize,r.fontFamily,r.fontStyle),Gl:1.2*r.fontSize,if:0,Al:0}])},i}(),mh=function(i){function t(e,r){var s=i.call(this)||this;return s.zi=r,s.Hi=new gh(s),s}return rt(t,i),t.prototype.nn=function(){return[]},t.prototype.tn=function(){return[this.Hi]},t.prototype.W=function(){return this.zi},t.prototype.hn=function(){this.Hi.vt()},t}(qi);(function(i){i[i.OnTouchEnd=0]="OnTouchEnd",i[i.OnNextTap=1]="OnNextTap"})(Wr||(Wr={}));var zr,Nr,$r,yh=function(){function i(t,e){this.sf=[],this.hf=[],this.hh=0,this.rf=null,this.ef=null,this.uf=new dt,this.af=new dt,this.lf=null,this.ff=t,this.zi=e,this.cf=new na(this),this.Da=new _h(this,e.timeScale,this.zi.localization),this.ct=new ga(this,e.crosshair),this.vf=new eh(e.crosshair),this._f=new mh(this,e.watermark),this.df(),this.sf[0].za(2e3),this.wf=this.Mf(0),this.bf=this.Mf(1)}return i.prototype.Ce=function(){this.mf(new Et(3))},i.prototype.Wr=function(){this.mf(new Et(2))},i.prototype.We=function(){this.mf(new Et(1))},i.prototype.Se=function(t){var e=this.pf(t);this.mf(e)},i.prototype.gf=function(){return this.ef},i.prototype.yf=function(t){var e=this.ef;this.ef=t,e!==null&&this.Se(e.kf),t!==null&&this.Se(t.kf)},i.prototype.W=function(){return this.zi},i.prototype.Pr=function(t){ut(this.zi,t),this.sf.forEach(function(e){return e.Oa(t)}),t.timeScale!==void 0&&this.Da.Pr(t.timeScale),t.localization!==void 0&&this.Da.el(t.localization),(t.leftPriceScale||t.rightPriceScale)&&this.uf.m(),this.wf=this.Mf(0),this.bf=this.Mf(1),this.Ce()},i.prototype.Nf=function(t,e){if(t!=="left")if(t!=="right"){var r=this.xf(t);r!==null&&(r.Ct.Pr(e),this.uf.m())}else this.Pr({rightPriceScale:e});else this.Pr({leftPriceScale:e})},i.prototype.xf=function(t){for(var e=0,r=this.sf;e<r.length;e++){var s=r[e],d=s.Va(t);if(d!==null)return{It:s,Ct:d}}return null},i.prototype.bt=function(){return this.Da},i.prototype.Cf=function(){return this.sf},i.prototype.Sf=function(){return this._f},i.prototype.Tf=function(){return this.ct},i.prototype.Df=function(){return this.af},i.prototype.Af=function(t,e){t.ia(e),this.yl()},i.prototype.Ra=function(t){this.hh=t,this.Da.Ra(this.hh),this.sf.forEach(function(e){return e.Ra(t)}),this.yl()},i.prototype.df=function(t){var e=new hh(this.Da,this);t!==void 0?this.sf.splice(t,0,e):this.sf.push(e);var r=t===void 0?this.sf.length-1:t,s=new Et(3);return s.cn(r,{vn:0,_n:!0}),this.mf(s),e},i.prototype.Ka=function(t,e,r){t.Ka(e,r)},i.prototype.Xa=function(t,e,r){t.Xa(e,r),this.Te(),this.mf(this.Bf(t,2))},i.prototype.Za=function(t,e){t.Za(e),this.mf(this.Bf(t,2))},i.prototype.Ja=function(t,e,r){e.Xu()||t.Ja(e,r)},i.prototype.Ga=function(t,e,r){e.Xu()||(t.Ga(e,r),this.Te(),this.mf(this.Bf(t,2)))},i.prototype.Qa=function(t,e){e.Xu()||(t.Qa(e),this.mf(this.Bf(t,2)))},i.prototype.no=function(t,e){t.no(e),this.mf(this.Bf(t,2))},i.prototype.Lf=function(t){this.Da.da(t)},i.prototype.Ef=function(t,e){var r=this.bt();if(!r.wi()&&e!==0){var s=r.Ht();t=Math.max(1,Math.min(t,s)),r.Al(t,e),this.yl()}},i.prototype.Ff=function(t){this.Of(0),this.Vf(t),this.Pf()},i.prototype.Wf=function(t){this.Da.wa(t),this.yl()},i.prototype.zf=function(){this.Da.Ma(),this.Wr()},i.prototype.Of=function(t){this.rf=t,this.Da.ba(t)},i.prototype.Vf=function(t){var e=!1;return this.rf!==null&&Math.abs(t-this.rf)>20&&(this.rf=null,e=!0),this.Da.ma(t),this.yl(),e},i.prototype.Pf=function(){this.Da.pa(),this.Wr(),this.rf=null},i.prototype._t=function(){return this.hf},i.prototype.Rf=function(t,e,r){this.ct.Yi(t,e);var s=NaN,d=this.Da.pl(t),_=this.Da.ss();_!==null&&(d=Math.min(Math.max(_.In(),d),_.jn()));var n=r.ji(),a=n.kt();a!==null&&(s=n.qi(e,a)),s=this.vf.Je(s,d,r),this.ct.Zi(d,s,r),this.We(),this.af.m(this.ct.Mt(),{x:t,y:e})},i.prototype.If=function(){this.Tf().Gi(),this.We(),this.af.m(null,null)},i.prototype.Te=function(){var t=this.ct.It();if(t!==null){var e=this.ct.Ki(),r=this.ct.Xi();this.Rf(e,r,t)}this.ct.hn()},i.prototype.jf=function(t,e,r){var s=this.Da.gi(0);e!==void 0&&r!==void 0&&this.Da.vt(e,r);var d=this.Da.gi(0),_=this.Da.ml(),n=this.Da.ss();if(n!==null&&s!==null&&d!==null){var a=n.Uh(_),u=s.So>d.So,p=t!==null&&t>_&&!u,c=a&&this.Da.W().shiftVisibleRangeOnNewBar;if(p&&!c){var g=t-_;this.Da.yn(this.Da.Nl()-g)}}this.Da.Dl(t)},i.prototype.Be=function(t){t!==null&&t.ho()},i.prototype.oh=function(t){var e=this.sf.find(function(r){return r.oa().includes(t)});return e===void 0?null:e},i.prototype.yl=function(){this._f.hn(),this.sf.forEach(function(t){return t.ho()}),this.Te()},i.prototype.g=function(){this.sf.forEach(function(t){return t.g()}),this.sf.length=0,this.zi.localization.priceFormatter=void 0,this.zi.localization.timeFormatter=void 0},i.prototype.qf=function(){return this.cf},i.prototype.dh=function(){return this.cf.W()},i.prototype.Pa=function(){return this.uf},i.prototype.Uf=function(t,e){var r=this.sf[0],s=this.Hf(e,t,r);return this.hf.push(s),this.hf.length===1?this.Ce():this.Wr(),s},i.prototype.Yf=function(t){var e=this.oh(t),r=this.hf.indexOf(t);ge(r!==-1,"Series not found"),this.hf.splice(r,1),j(e).ca(t),t.g&&t.g()},i.prototype.xe=function(t,e){var r=j(this.oh(t));r.ca(t);var s=this.xf(e);if(s===null){var d=t.xi();r.la(t,e,d)}else d=s.It===r?t.xi():void 0,s.It.la(t,e,d)},i.prototype.zl=function(){var t=new Et(2);t.Mn(),this.mf(t)},i.prototype.$f=function(t){var e=new Et(2);e.mn(t),this.mf(e)},i.prototype.pn=function(){var t=new Et(2);t.pn(),this.mf(t)},i.prototype.gn=function(t){var e=new Et(2);e.gn(t),this.mf(e)},i.prototype.yn=function(t){var e=new Et(2);e.yn(t),this.mf(e)},i.prototype.Kf=function(){return this.zi.rightPriceScale.visible?"right":"left"},i.prototype.Xf=function(){return this.bf},i.prototype.Zf=function(){return this.wf},i.prototype.Dt=function(t){var e=this.bf,r=this.wf;if(e===r)return e;if(t=Math.max(0,Math.min(100,Math.round(100*t))),this.lf===null||this.lf.Pn!==r||this.lf.Wn!==e)this.lf={Pn:r,Wn:e,Jf:new Map};else{var s=this.lf.Jf.get(t);if(s!==void 0)return s}var d=function(_,n,a){var u=ii(_),p=u[0],c=u[1],g=u[2],S=u[3],w=ii(n),m=w[0],o=w[1],h=w[2],l=w[3],f=[Mt(p+a*(m-p)),Mt(c+a*(o-c)),Mt(g+a*(h-g)),Es(S+a*(l-S))];return"rgba(".concat(f[0],", ").concat(f[1],", ").concat(f[2],", ").concat(f[3],")")}(r,e,t/100);return this.lf.Jf.set(t,d),d},i.prototype.Bf=function(t,e){var r=new Et(e);if(t!==null){var s=this.sf.indexOf(t);r.cn(s,{vn:e})}return r},i.prototype.pf=function(t,e){return e===void 0&&(e=2),this.Bf(this.oh(t),e)},i.prototype.mf=function(t){this.ff&&this.ff(t),this.sf.forEach(function(e){return e.eo().ou().vt()})},i.prototype.Hf=function(t,e,r){var s=new tr(this,t,e),d=t.priceScaleId!==void 0?t.priceScaleId:this.Kf();return r.la(s,d),_i(d)||s.Pr(t),s},i.prototype.Mf=function(t){var e=this.zi.layout;return e.background.type==="gradient"?t===0?e.background.topColor:e.background.bottomColor:e.background.color},i}();function Ns(i){i.borderColor!==void 0&&(i.borderUpColor=i.borderColor,i.borderDownColor=i.borderColor),i.wickColor!==void 0&&(i.wickUpColor=i.wickColor,i.wickDownColor=i.wickColor)}function er(i){return!Ft(i)&&!Ki(i)}function $s(i){return Ft(i)}(function(i){i[i.Disabled=0]="Disabled",i[i.Continuous=1]="Continuous",i[i.OnDataUpdate=2]="OnDataUpdate"})(zr||(zr={})),function(i){i[i.LastBar=0]="LastBar",i[i.LastVisible=1]="LastVisible"}(Nr||(Nr={})),function(i){i.Solid="solid",i.VerticalGradient="gradient"}($r||($r={}));var ft=function(){function i(t,e){this.Ft=t,this.Ot=e}return i.prototype.br=function(t){return this.Ft===t.Ft&&this.Ot===t.Ot},i}();function oi(i){return i.ownerDocument&&i.ownerDocument.defaultView&&i.ownerDocument.defaultView.devicePixelRatio||1}function zt(i){var t=j(i.getContext("2d"));return t.setTransform(1,0,0,1,0,0),t}function js(i,t){var e=i.createElement("canvas"),r=oi(e);return e.style.width="".concat(t.Ft,"px"),e.style.height="".concat(t.Ot,"px"),e.width=t.Ft*r,e.height=t.Ot*r,e}function re(i,t){var e=j(i.ownerDocument).createElement("canvas");i.appendChild(e);var r=Zo(e,{allowDownsampling:!1});return r.resizeCanvas({width:t.Ft,height:t.Ot}),r}function Ci(i,t){return i.Gf-t.Gf}function Ei(i,t,e){var r=(i.Gf-t.Gf)/(i.rt-t.rt);return Math.sign(r)*Math.min(Math.abs(r),e)}var Sh=function(){function i(t,e,r,s){this.Qf=null,this.tc=null,this.ic=null,this.nc=null,this.sc=null,this.hc=0,this.rc=0,this.ec=!1,this.uc=t,this.ac=e,this.oc=r,this.Cn=s}return i.prototype.lc=function(t,e){if(this.Qf!==null){if(this.Qf.rt===e)return void(this.Qf.Gf=t);if(Math.abs(this.Qf.Gf-t)<this.Cn)return}this.nc=this.ic,this.ic=this.tc,this.tc=this.Qf,this.Qf={rt:e,Gf:t}},i.prototype.xh=function(t,e){if(this.Qf!==null&&this.tc!==null&&!(e-this.Qf.rt>50)){var r=0,s=Ei(this.Qf,this.tc,this.ac),d=Ci(this.Qf,this.tc),_=[s],n=[d];if(r+=d,this.ic!==null){var a=Ei(this.tc,this.ic,this.ac);if(Math.sign(a)===Math.sign(s)){var u=Ci(this.tc,this.ic);if(_.push(a),n.push(u),r+=u,this.nc!==null){var p=Ei(this.ic,this.nc,this.ac);if(Math.sign(p)===Math.sign(s)){var c=Ci(this.ic,this.nc);_.push(p),n.push(c),r+=c}}}}for(var g,S,w,m=0,o=0;o<_.length;++o)m+=n[o]/r*_[o];Math.abs(m)<this.uc||(this.sc={Gf:t,rt:e},this.rc=m,this.hc=(g=Math.abs(m),S=this.oc,w=Math.log(S),Math.log(1*w/-g)/w))}},i.prototype.fc=function(t){var e=j(this.sc),r=t-e.rt;return e.Gf+this.rc*(Math.pow(this.oc,r)-1)/Math.log(this.oc)},i.prototype.cc=function(t){return this.sc===null||this.vc(t)===this.hc},i.prototype._c=function(){return this.ec},i.prototype.dc=function(){this.ec=!0},i.prototype.vc=function(t){var e=t-j(this.sc).rt;return Math.min(e,this.hc)},i}(),gi=typeof window<"u";function jr(){return!!gi&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function Mi(){return!!gi&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function bh(i){gi&&window.chrome!==void 0&&i.addEventListener("mousedown",function(t){if(t.button===1)return t.preventDefault(),!1})}var ir=function(){function i(t,e,r){var s=this;this.wc=0,this.Mc=null,this.bc={tt:Number.NEGATIVE_INFINITY,it:Number.POSITIVE_INFINITY},this.mc=0,this.gc=null,this.yc={tt:Number.NEGATIVE_INFINITY,it:Number.POSITIVE_INFINITY},this.kc=null,this.Nc=!1,this.xc=null,this.Cc=null,this.Sc=!1,this.Tc=!1,this.Dc=!1,this.Ac=null,this.Bc=null,this.Lc=null,this.Ec=null,this.Fc=null,this.Oc=null,this.Vc=null,this.Pc=0,this.Wc=!1,this.zc=!1,this.Rc=!1,this.Ic=0,this.jc=null,this.qc=!Mi(),this.Uc=function(d){s.Hc(d)},this.Yc=function(d){if(s.$c(d)){var _=s.Kc(d);++s.mc,s.gc&&s.mc>1&&(s.Zc(Ht(d),s.yc).Xc<30&&!s.Dc&&s.Jc(_,s.Qc.Gc),s.tv())}else _=s.Kc(d),++s.wc,s.Mc&&s.wc>1&&(s.Zc(Ht(d),s.bc).Xc<5&&!s.Tc&&s.iv(_,s.Qc.nv),s.sv())},this.hv=t,this.Qc=e,this.zi=r,this.rv()}return i.prototype.g=function(){this.Ac!==null&&(this.Ac(),this.Ac=null),this.Bc!==null&&(this.Bc(),this.Bc=null),this.Ec!==null&&(this.Ec(),this.Ec=null),this.Fc!==null&&(this.Fc(),this.Fc=null),this.Oc!==null&&(this.Oc(),this.Oc=null),this.Lc!==null&&(this.Lc(),this.Lc=null),this.ev(),this.sv()},i.prototype.uv=function(t){var e=this;this.Ec&&this.Ec();var r=this.av.bind(this);if(this.Ec=function(){e.hv.removeEventListener("mousemove",r)},this.hv.addEventListener("mousemove",r),!this.$c(t)){var s=this.Kc(t);this.iv(s,this.Qc.ov),this.qc=!0}},i.prototype.sv=function(){this.Mc!==null&&clearTimeout(this.Mc),this.wc=0,this.Mc=null,this.bc={tt:Number.NEGATIVE_INFINITY,it:Number.POSITIVE_INFINITY}},i.prototype.tv=function(){this.gc!==null&&clearTimeout(this.gc),this.mc=0,this.gc=null,this.yc={tt:Number.NEGATIVE_INFINITY,it:Number.POSITIVE_INFINITY}},i.prototype.av=function(t){if(!this.Rc&&this.Cc===null&&!this.$c(t)){var e=this.Kc(t);this.iv(e,this.Qc.lv),this.qc=!0}},i.prototype.fv=function(t){var e=xi(t.changedTouches,j(this.jc));if(e!==null&&(this.Ic=Ge(t),this.Vc===null&&!this.zc)){this.Wc=!0;var r=this.Zc(Ht(e),j(this.Cc)),s=r.cv,d=r.vv,_=r.Xc;if(this.Sc||!(_<5)){if(!this.Sc){var n=.5*s,a=d>=n&&!this.zi._v(),u=n>d&&!this.zi.dv();a||u||(this.zc=!0),this.Sc=!0,this.Dc=!0,this.ev(),this.tv()}if(!this.zc){var p=this.Kc(t,e);this.Jc(p,this.Qc.wv),oe(t)}}}},i.prototype.Mv=function(t){if(t.button===0&&(this.Zc(Ht(t),j(this.xc)).Xc>=5&&(this.Tc=!0,this.sv()),this.Tc)){var e=this.Kc(t);this.iv(e,this.Qc.bv)}},i.prototype.Zc=function(t,e){var r=Math.abs(e.tt-t.tt),s=Math.abs(e.it-t.it);return{cv:r,vv:s,Xc:r+s}},i.prototype.mv=function(t){var e=xi(t.changedTouches,j(this.jc));if(e===null&&t.touches.length===0&&(e=t.changedTouches[0]),e!==null){this.jc=null,this.Ic=Ge(t),this.ev(),this.Cc=null,this.Oc&&(this.Oc(),this.Oc=null);var r=this.Kc(t,e);this.Jc(r,this.Qc.pv),++this.mc,this.gc&&this.mc>1?(this.Zc(Ht(e),this.yc).Xc<30&&!this.Dc&&this.Jc(r,this.Qc.Gc),this.tv()):this.Dc||(this.Jc(r,this.Qc.gv),this.Qc.gv&&oe(t)),this.mc===0&&oe(t),t.touches.length===0&&this.Nc&&(this.Nc=!1,oe(t))}},i.prototype.Hc=function(t){if(t.button===0){var e=this.Kc(t);this.xc=null,this.Rc=!1,this.Fc&&(this.Fc(),this.Fc=null),jr()&&this.hv.ownerDocument.documentElement.removeEventListener("mouseleave",this.Uc),this.$c(t)||(this.iv(e,this.Qc.yv),++this.wc,this.Mc&&this.wc>1?(this.Zc(Ht(t),this.bc).Xc<5&&!this.Tc&&this.iv(e,this.Qc.nv),this.sv()):this.Tc||this.iv(e,this.Qc.kv))}},i.prototype.ev=function(){this.kc!==null&&(clearTimeout(this.kc),this.kc=null)},i.prototype.Nv=function(t){if(this.jc===null){var e=t.changedTouches[0];this.jc=e.identifier,this.Ic=Ge(t);var r=this.hv.ownerDocument.documentElement;this.Dc=!1,this.Sc=!1,this.zc=!1,this.Cc=Ht(e),this.Oc&&(this.Oc(),this.Oc=null);var s=this.fv.bind(this),d=this.mv.bind(this);this.Oc=function(){r.removeEventListener("touchmove",s),r.removeEventListener("touchend",d)},r.addEventListener("touchmove",s,{passive:!1}),r.addEventListener("touchend",d,{passive:!1}),this.ev(),this.kc=setTimeout(this.xv.bind(this,t),240);var _=this.Kc(t,e);this.Jc(_,this.Qc.Cv),this.gc||(this.mc=0,this.gc=setTimeout(this.tv.bind(this),500),this.yc=Ht(e))}},i.prototype.Sv=function(t){if(t.button===0){var e=this.hv.ownerDocument.documentElement;jr()&&e.addEventListener("mouseleave",this.Uc),this.Tc=!1,this.xc=Ht(t),this.Fc&&(this.Fc(),this.Fc=null);var r=this.Mv.bind(this),s=this.Hc.bind(this);if(this.Fc=function(){e.removeEventListener("mousemove",r),e.removeEventListener("mouseup",s)},e.addEventListener("mousemove",r),e.addEventListener("mouseup",s),this.Rc=!0,!this.$c(t)){var d=this.Kc(t);this.iv(d,this.Qc.Tv),this.Mc||(this.wc=0,this.Mc=setTimeout(this.sv.bind(this),500),this.bc=Ht(t))}}},i.prototype.rv=function(){var t=this;this.hv.addEventListener("mouseenter",this.uv.bind(this)),this.hv.addEventListener("touchcancel",this.ev.bind(this));var e=this.hv.ownerDocument,r=function(s){t.Qc.Dv&&(s.target&&t.hv.contains(s.target)||t.Qc.Dv())};this.Bc=function(){e.removeEventListener("touchstart",r)},this.Ac=function(){e.removeEventListener("mousedown",r)},e.addEventListener("mousedown",r),e.addEventListener("touchstart",r,{passive:!0}),Mi()&&(this.Lc=function(){t.hv.removeEventListener("dblclick",t.Yc)},this.hv.addEventListener("dblclick",this.Yc)),this.hv.addEventListener("mouseleave",this.Av.bind(this)),this.hv.addEventListener("touchstart",this.Nv.bind(this),{passive:!0}),bh(this.hv),this.hv.addEventListener("mousedown",this.Sv.bind(this)),this.Bv(),this.hv.addEventListener("touchmove",function(){},{passive:!1})},i.prototype.Bv=function(){var t=this;this.Qc.Lv===void 0&&this.Qc.Ev===void 0&&this.Qc.Fv===void 0||(this.hv.addEventListener("touchstart",function(e){return t.Ov(e.touches)},{passive:!0}),this.hv.addEventListener("touchmove",function(e){if(e.touches.length===2&&t.Vc!==null&&t.Qc.Ev!==void 0){var r=Ur(e.touches[0],e.touches[1])/t.Pc;t.Qc.Ev(t.Vc,r),oe(e)}},{passive:!1}),this.hv.addEventListener("touchend",function(e){t.Ov(e.touches)}))},i.prototype.Ov=function(t){t.length===1&&(this.Wc=!1),t.length!==2||this.Wc||this.Nc?this.Vv():this.Pv(t)},i.prototype.Pv=function(t){var e=this.hv.getBoundingClientRect()||{left:0,top:0};this.Vc={tt:(t[0].clientX-e.left+(t[1].clientX-e.left))/2,it:(t[0].clientY-e.top+(t[1].clientY-e.top))/2},this.Pc=Ur(t[0],t[1]),this.Qc.Lv!==void 0&&this.Qc.Lv(),this.ev()},i.prototype.Vv=function(){this.Vc!==null&&(this.Vc=null,this.Qc.Fv!==void 0&&this.Qc.Fv())},i.prototype.Av=function(t){if(this.Ec&&this.Ec(),!this.$c(t)&&this.qc){var e=this.Kc(t);this.iv(e,this.Qc.Wv),this.qc=!Mi()}},i.prototype.xv=function(t){var e=xi(t.touches,j(this.jc));if(e!==null){var r=this.Kc(t,e);this.Jc(r,this.Qc.zv),this.Dc=!0,this.Nc=!0}},i.prototype.$c=function(t){return t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents!==void 0?t.sourceCapabilities.firesTouchEvents:Ge(t)<this.Ic+500},i.prototype.Jc=function(t,e){e&&e.call(this.Qc,t)},i.prototype.iv=function(t,e){e&&e.call(this.Qc,t)},i.prototype.Kc=function(t,e){var r=e||t,s=this.hv.getBoundingClientRect()||{left:0,top:0};return{Rv:r.clientX,Iv:r.clientY,jv:r.pageX,qv:r.pageY,Uv:r.screenX,Hv:r.screenY,Yv:r.clientX-s.left,$v:r.clientY-s.top,Kv:t.ctrlKey,Xv:t.altKey,Zv:t.shiftKey,Jv:t.metaKey,Gv:!t.type.startsWith("mouse")&&t.type!=="contextmenu"&&t.type!=="click",Qv:t.type,t_:r.target,i_:t.view,n_:function(){t.type!=="touchstart"&&oe(t)}}},i}();function Ur(i,t){var e=i.clientX-t.clientX,r=i.clientY-t.clientY;return Math.sqrt(e*e+r*r)}function oe(i){i.cancelable&&i.preventDefault()}function Ht(i){return{tt:i.pageX,it:i.pageY}}function Ge(i){return i.timeStamp||performance.now()}function xi(i,t){for(var e=0;e<i.length;++e)if(i[e].identifier===t)return i[e];return null}var Vr=function(){function i(t,e,r,s){this.rh=new ve(200),this.R=0,this.s_="",this.Yh="",this.th=[],this.h_=new Map,this.R=t,this.s_=e,this.Yh=ie(t,r,s)}return i.prototype.g=function(){this.rh.ih(),this.th=[],this.h_.clear()},i.prototype.r_=function(t,e,r,s,d){var _=this.e_(t,e);if(d!=="left"){var n=oi(t.canvas);r-=Math.floor(_.u_*n)}s-=Math.floor(_.Yt/2),t.drawImage(_.a_,r,s,_.Ht,_.Yt)},i.prototype.e_=function(t,e){var r,s=this;if(this.h_.has(e))r=Rt(this.h_.get(e));else{if(this.th.length>=200){var d=Rt(this.th.shift());this.h_.delete(d)}var _=oi(t.canvas),n=Math.ceil(this.R/4.5),a=Math.round(this.R/10),u=Math.ceil(this.rh.Qt(t,e)),p=Hi(Math.round(u+2*n)),c=Hi(this.R+2*n),g=js(document,new ft(p,c));r={Gt:e,u_:Math.round(Math.max(1,u)),Ht:Math.ceil(p*_),Yt:Math.ceil(c*_),a_:g},u!==0&&(this.th.push(r.Gt),this.h_.set(r.Gt,r)),$t(t=zt(r.a_),_,function(){t.font=s.Yh,t.fillStyle=s.s_,t.fillText(e,0,c-n-a)})}return r},i}(),Kr=function(){function i(t,e,r,s){var d=this;this._i=null,this.o_=null,this.l_=!1,this.f_=new ve(50),this.c_=new Vr(11,"#000"),this.s_=null,this.Yh=null,this.v_=0,this.__=!1,this.d_=function(){d.w_(d.cf.W()),d.__||d.Di.M_().jt().Wr()},this.b_=function(){d.__||d.Di.M_().jt().Wr()},this.Di=t,this.zi=e,this.cf=r,this.m_=s==="left",this.p_=document.createElement("div"),this.p_.style.height="100%",this.p_.style.overflow="hidden",this.p_.style.width="25px",this.p_.style.left="0",this.p_.style.position="relative",this.g_=re(this.p_,new ft(16,16)),this.g_.subscribeCanvasConfigured(this.d_);var _=this.g_.canvas;_.style.position="absolute",_.style.zIndex="1",_.style.left="0",_.style.top="0",this.y_=re(this.p_,new ft(16,16)),this.y_.subscribeCanvasConfigured(this.b_);var n=this.y_.canvas;n.style.position="absolute",n.style.zIndex="2",n.style.left="0",n.style.top="0";var a={Tv:this.k_.bind(this),Cv:this.k_.bind(this),bv:this.N_.bind(this),wv:this.N_.bind(this),Dv:this.x_.bind(this),yv:this.C_.bind(this),pv:this.C_.bind(this),nv:this.S_.bind(this),Gc:this.S_.bind(this),ov:this.T_.bind(this),Wv:this.D_.bind(this)};this.A_=new ir(this.y_.canvas,a,{_v:function(){return!1},dv:function(){return!0}})}return i.prototype.g=function(){this.A_.g(),this.y_.unsubscribeCanvasConfigured(this.b_),this.y_.destroy(),this.g_.unsubscribeCanvasConfigured(this.d_),this.g_.destroy(),this._i!==null&&this._i._a().M(this),this._i=null,this.c_.g()},i.prototype.B_=function(){return this.p_},i.prototype.ht=function(){return j(this._i).W().borderColor},i.prototype.L_=function(){return this.zi.textColor},i.prototype.S=function(){return this.zi.fontSize},i.prototype.E_=function(){return ie(this.S(),this.zi.fontFamily)},i.prototype.F_=function(){var t=this.cf.W(),e=this.s_!==t.A,r=this.Yh!==t.T;return(e||r)&&(this.w_(t),this.s_=t.A),r&&(this.f_.ih(),this.Yh=t.T),t},i.prototype.O_=function(){if(this._i===null)return 0;var t=0,e=this.F_(),r=zt(this.g_.canvas),s=this._i.au();r.font=this.E_(),s.length>0&&(t=Math.max(this.f_.Qt(r,s[0].yu),this.f_.Qt(r,s[s.length-1].yu)));for(var d=this.V_(),_=d.length;_--;){var n=this.f_.Qt(r,d[_].Gt());n>t&&(t=n)}var a=this._i.kt();if(a!==null&&this.o_!==null){var u=this._i.qi(1,a),p=this._i.qi(this.o_.Ot-2,a);t=Math.max(t,this.f_.Qt(r,this._i.Mi(Math.floor(Math.min(u,p))+.11111111111111,a)),this.f_.Qt(r,this._i.Mi(Math.ceil(Math.max(u,p))-.11111111111111,a)))}var c=t||34,g=Math.ceil(e.N+e.C+e.L+e.F+c);return g+=g%2},i.prototype.P_=function(t){if(t.Ft<0||t.Ot<0)throw new Error("Try to set invalid size to PriceAxisWidget "+JSON.stringify(t));this.o_!==null&&this.o_.br(t)||(this.o_=t,this.__=!0,this.g_.resizeCanvas({width:t.Ft,height:t.Ot}),this.y_.resizeCanvas({width:t.Ft,height:t.Ot}),this.__=!1,this.p_.style.width=t.Ft+"px",this.p_.style.height=t.Ot+"px",this.p_.style.minWidth=t.Ft+"px")},i.prototype.W_=function(){return j(this.o_).Ft},i.prototype.Si=function(t){this._i!==t&&(this._i!==null&&this._i._a().M(this),this._i=t,t._a().u(this.Eu.bind(this),this))},i.prototype.Ct=function(){return this._i},i.prototype.ih=function(){var t=this.Di.z_();this.Di.M_().jt().no(t,j(this.Ct()))},i.prototype.R_=function(t){if(this.o_!==null){if(t!==1){var e=zt(this.g_.canvas);this.I_(),this.j_(e,this.g_.pixelRatio),this.Rs(e,this.g_.pixelRatio),this.q_(e,this.g_.pixelRatio),this.U_(e,this.g_.pixelRatio)}var r=zt(this.y_.canvas),s=this.o_.Ft,d=this.o_.Ot;$t(r,this.y_.pixelRatio,function(){r.clearRect(0,0,s,d)}),this.H_(r,this.y_.pixelRatio)}},i.prototype.Y_=function(){return this.g_.canvas},i.prototype.vt=function(){var t;(t=this._i)===null||t===void 0||t.au()},i.prototype.k_=function(t){if(this._i!==null&&!this._i.wi()&&this.Di.M_().W().handleScale.axisPressedMouseMove.price){var e=this.Di.M_().jt(),r=this.Di.z_();this.l_=!0,e.Ka(r,this._i,t.$v)}},i.prototype.N_=function(t){if(this._i!==null&&this.Di.M_().W().handleScale.axisPressedMouseMove.price){var e=this.Di.M_().jt(),r=this.Di.z_(),s=this._i;e.Xa(r,s,t.$v)}},i.prototype.x_=function(){if(this._i!==null&&this.Di.M_().W().handleScale.axisPressedMouseMove.price){var t=this.Di.M_().jt(),e=this.Di.z_(),r=this._i;this.l_&&(this.l_=!1,t.Za(e,r))}},i.prototype.C_=function(t){if(this._i!==null&&this.Di.M_().W().handleScale.axisPressedMouseMove.price){var e=this.Di.M_().jt(),r=this.Di.z_();this.l_=!1,e.Za(r,this._i)}},i.prototype.S_=function(t){this.Di.M_().W().handleScale.axisDoubleClickReset&&this.ih()},i.prototype.T_=function(t){this._i!==null&&(!this.Di.M_().jt().W().handleScale.axisPressedMouseMove.price||this._i.vr()||this._i.Zu()||this.K_(1))},i.prototype.D_=function(t){this.K_(0)},i.prototype.V_=function(){var t=this,e=[],r=this._i===null?void 0:this._i;return function(s){for(var d=0;d<s.length;++d)for(var _=s[d].nn(t.Di.z_(),r),n=0;n<_.length;n++)e.push(_[n])}(this.Di.z_().oa()),e},i.prototype.j_=function(t,e){var r=this;if(this.o_!==null){var s=this.o_.Ft,d=this.o_.Ot;$t(t,e,function(){var _=r.Di.z_().jt(),n=_.Zf(),a=_.Xf();n===a?pi(t,0,0,s,d,n):xs(t,0,0,s,d,n,a)})}},i.prototype.Rs=function(t,e){if(this.o_!==null&&this._i!==null&&this._i.W().borderVisible){t.save(),t.fillStyle=this.ht();var r,s=Math.max(1,Math.floor(this.F_().N*e));r=this.m_?Math.floor(this.o_.Ft*e)-s:0,t.fillRect(r,0,s,Math.ceil(this.o_.Ot*e)),t.restore()}},i.prototype.q_=function(t,e){if(this.o_!==null&&this._i!==null){var r=this._i.au();t.save(),t.strokeStyle=this.ht(),t.font=this.E_(),t.fillStyle=this.ht();var s=this.F_(),d=this._i.W().borderVisible&&this._i.W().drawTicks,_=this.m_?Math.floor((this.o_.Ft-s.C)*e-s.N*e):Math.floor(s.N*e),n=this.m_?Math.round(_-s.L*e):Math.round(_+s.C*e+s.L*e),a=this.m_?"right":"left",u=Math.max(1,Math.floor(e)),p=Math.floor(.5*e);if(d){var c=Math.round(s.C*e);t.beginPath();for(var g=0,S=r;g<S.length;g++){var w=S[g];t.rect(_,Math.round(w.su*e)-p,c,u)}t.fill()}t.fillStyle=this.L_();for(var m=0,o=r;m<o.length;m++)w=o[m],this.c_.r_(t,w.yu,n,Math.round(w.su*e),a);t.restore()}},i.prototype.I_=function(){if(this.o_!==null&&this._i!==null){var t=this.o_.Ot/2,e=[],r=this._i.oa().slice(),s=this.Di.z_(),d=this.F_();this._i===s.fh()&&this.Di.z_().oa().forEach(function(o){s.lh(o)&&r.push(o)});var _=this._i.Ge()[0],n=this._i;r.forEach(function(o){var h=o.nn(s,n);h.forEach(function(l){l.oi(null),l.li()&&e.push(l)}),_===o&&h.length>0&&(t=h[0].ti())});var a=e.filter(function(o){return o.ti()<=t}),u=e.filter(function(o){return o.ti()>t});if(a.sort(function(o,h){return h.ti()-o.ti()}),a.length&&u.length&&u.push(a[0]),u.sort(function(o,h){return o.ti()-h.ti()}),e.forEach(function(o){return o.oi(o.ti())}),this._i.W().alignLabels){for(var p=1;p<a.length;p++){var c=a[p],g=(w=a[p-1]).Yt(d,!1);c.ti()>(m=w.ai())-g&&c.oi(m-g)}for(var S=1;S<u.length;S++){var w,m;c=u[S],g=(w=u[S-1]).Yt(d,!0),c.ti()<(m=w.ai())+g&&c.oi(m+g)}}}},i.prototype.U_=function(t,e){var r=this;if(this.o_!==null){t.save();var s=this.o_,d=this.V_(),_=this.F_(),n=this.m_?"right":"left";d.forEach(function(a){if(a.fi()){var u=a.dt(j(r._i));t.save(),u.H(t,_,r.f_,s.Ft,n,e),t.restore()}}),t.restore()}},i.prototype.H_=function(t,e){var r=this;if(this.o_!==null&&this._i!==null){t.save();var s=this.o_,d=this.Di.M_().jt(),_=[],n=this.Di.z_(),a=d.Tf().nn(n,this._i);a.length&&_.push(a);var u=this.F_(),p=this.m_?"right":"left";_.forEach(function(c){c.forEach(function(g){t.save(),g.dt(j(r._i)).H(t,u,r.f_,s.Ft,p,e),t.restore()})}),t.restore()}},i.prototype.K_=function(t){this.p_.style.cursor=t===1?"ns-resize":"default"},i.prototype.Eu=function(){var t=this.O_();this.v_<t&&this.Di.M_().jt().Ce(),this.v_=t},i.prototype.w_=function(t){this.c_.g(),this.c_=new Vr(t.S,t.A,t.D)},i}();function Gr(i,t,e,r,s){i.$&&i.$(t,e,r,s)}function ki(i,t,e,r,s){i.H(t,e,r,s)}function Xe(i,t){return i.tn(t)}function wh(i,t){return i.Pe!==void 0?i.Pe(t):[]}var Ch=function(){function i(t,e){var r=this;this.o_=new ft(0,0),this.X_=null,this.Z_=null,this.J_=null,this.G_=!1,this.Q_=new dt,this.td=0,this.nd=!1,this.sd=null,this.hd=!1,this.rd=null,this.ed=null,this.__=!1,this.d_=function(){r.__||r.ud===null||r.pi().Wr()},this.b_=function(){r.__||r.ud===null||r.pi().Wr()},this.ad=t,this.ud=e,this.ud.ro().u(this.od.bind(this),this,!0),this.ld=document.createElement("td"),this.ld.style.padding="0",this.ld.style.position="relative";var s=document.createElement("div");s.style.width="100%",s.style.height="100%",s.style.position="relative",s.style.overflow="hidden",this.fd=document.createElement("td"),this.fd.style.padding="0",this.vd=document.createElement("td"),this.vd.style.padding="0",this.ld.appendChild(s),this.g_=re(s,new ft(16,16)),this.g_.subscribeCanvasConfigured(this.d_);var d=this.g_.canvas;d.style.position="absolute",d.style.zIndex="1",d.style.left="0",d.style.top="0",this.y_=re(s,new ft(16,16)),this.y_.subscribeCanvasConfigured(this.b_);var _=this.y_.canvas;_.style.position="absolute",_.style.zIndex="2",_.style.left="0",_.style.top="0",this._d=document.createElement("tr"),this._d.appendChild(this.fd),this._d.appendChild(this.ld),this._d.appendChild(this.vd),this.dd(),this.A_=new ir(this.y_.canvas,this,{_v:function(){return r.sd===null&&!r.ad.W().handleScroll.vertTouchDrag},dv:function(){return r.sd===null&&!r.ad.W().handleScroll.horzTouchDrag}})}return i.prototype.g=function(){this.X_!==null&&this.X_.g(),this.Z_!==null&&this.Z_.g(),this.y_.unsubscribeCanvasConfigured(this.b_),this.y_.destroy(),this.g_.unsubscribeCanvasConfigured(this.d_),this.g_.destroy(),this.ud!==null&&this.ud.ro().M(this),this.A_.g()},i.prototype.z_=function(){return j(this.ud)},i.prototype.wd=function(t){this.ud!==null&&this.ud.ro().M(this),this.ud=t,this.ud!==null&&this.ud.ro().u(i.prototype.od.bind(this),this,!0),this.dd()},i.prototype.M_=function(){return this.ad},i.prototype.B_=function(){return this._d},i.prototype.dd=function(){if(this.ud!==null&&(this.Md(),this.pi()._t().length!==0)){if(this.X_!==null){var t=this.ud.Ya();this.X_.Si(j(t))}if(this.Z_!==null){var e=this.ud.$a();this.Z_.Si(j(e))}}},i.prototype.bd=function(){this.X_!==null&&this.X_.vt(),this.Z_!==null&&this.Z_.vt()},i.prototype.Wa=function(){return this.ud!==null?this.ud.Wa():0},i.prototype.za=function(t){this.ud&&this.ud.za(t)},i.prototype.ov=function(t){if(this.ud){this.md();var e=t.Yv,r=t.$v;this.pd(e,r)}},i.prototype.Tv=function(t){this.md(),this.gd(),this.pd(t.Yv,t.$v)},i.prototype.lv=function(t){if(this.ud){this.md();var e=t.Yv,r=t.$v;this.pd(e,r);var s=this.$h(e,r);this.pi().yf(s&&{kf:s.kf,yd:s.yd})}},i.prototype.kv=function(t){if(this.ud!==null){this.md();var e=t.Yv,r=t.$v;if(this.Q_.p()){var s=this.pi().Tf().Mt();this.Q_.m(s,{x:e,y:r})}}},i.prototype.bv=function(t){this.md(),this.kd(t),this.pd(t.Yv,t.$v)},i.prototype.yv=function(t){this.ud!==null&&(this.md(),this.nd=!1,this.Nd(t))},i.prototype.zv=function(t){if(this.nd=!0,this.sd===null){var e={x:t.Yv,y:t.$v};this.xd(e,e)}},i.prototype.Wv=function(t){this.ud!==null&&(this.md(),this.ud.jt().yf(null),this.Cd())},i.prototype.Sd=function(){return this.Q_},i.prototype.Lv=function(){this.td=1,this.Td()},i.prototype.Ev=function(t,e){if(this.ad.W().handleScale.pinch){var r=5*(e-this.td);this.td=e,this.pi().Ef(t.tt,r)}},i.prototype.Cv=function(t){if(this.nd=!1,this.hd=this.sd!==null,this.gd(),this.sd!==null){var e=this.pi().Tf();this.rd={x:e.$t(),y:e.Kt()},this.sd={x:t.Yv,y:t.$v}}},i.prototype.wv=function(t){if(this.ud!==null){var e=t.Yv,r=t.$v;if(this.sd===null)this.kd(t);else{this.hd=!1;var s=j(this.rd),d=s.x+(e-this.sd.x),_=s.y+(r-this.sd.y);this.pd(d,_)}}},i.prototype.pv=function(t){this.M_().W().trackingMode.exitMode===0&&(this.hd=!0),this.Dd(),this.Nd(t)},i.prototype.$h=function(t,e){var r=this.ud;if(r===null)return null;for(var s=0,d=r.oa();s<d.length;s++){var _=d[s],n=this.Ad(_.tn(r),t,e);if(n!==null)return{kf:_,i_:n.i_,yd:n.yd}}return null},i.prototype.Bd=function(t,e){j(e==="left"?this.X_:this.Z_).P_(new ft(t,this.o_.Ot))},i.prototype.Ld=function(){return this.o_},i.prototype.P_=function(t){if(t.Ft<0||t.Ot<0)throw new Error("Try to set invalid size to PaneWidget "+JSON.stringify(t));this.o_.br(t)||(this.o_=t,this.__=!0,this.g_.resizeCanvas({width:t.Ft,height:t.Ot}),this.y_.resizeCanvas({width:t.Ft,height:t.Ot}),this.__=!1,this.ld.style.width=t.Ft+"px",this.ld.style.height=t.Ot+"px")},i.prototype.Ed=function(){var t=j(this.ud);t.Ha(t.Ya()),t.Ha(t.$a());for(var e=0,r=t.Ge();e<r.length;e++){var s=r[e];if(t.lh(s)){var d=s.Ct();d!==null&&t.Ha(d),s.hn()}}},i.prototype.Y_=function(){return this.g_.canvas},i.prototype.R_=function(t){if(t!==0&&this.ud!==null){if(t>1&&this.Ed(),this.X_!==null&&this.X_.R_(t),this.Z_!==null&&this.Z_.R_(t),t!==1){var e=zt(this.g_.canvas);e.save(),this.j_(e,this.g_.pixelRatio),this.ud&&(this.Fd(e,this.g_.pixelRatio),this.Od(e,this.g_.pixelRatio),this.Vd(e,this.g_.pixelRatio,Xe)),e.restore()}var r=zt(this.y_.canvas);r.clearRect(0,0,Math.ceil(this.o_.Ft*this.y_.pixelRatio),Math.ceil(this.o_.Ot*this.y_.pixelRatio)),this.Vd(r,this.g_.pixelRatio,wh),this.Pd(r,this.y_.pixelRatio)}},i.prototype.Wd=function(){return this.X_},i.prototype.zd=function(){return this.Z_},i.prototype.od=function(){this.ud!==null&&this.ud.ro().M(this),this.ud=null},i.prototype.j_=function(t,e){var r=this;$t(t,e,function(){var s=r.pi(),d=s.Zf(),_=s.Xf();d===_?pi(t,0,0,r.o_.Ft,r.o_.Ot,_):xs(t,0,0,r.o_.Ft,r.o_.Ot,d,_)})},i.prototype.Fd=function(t,e){var r=j(this.ud),s=r.eo().ou().dt(r.Yt(),r.Ht());s!==null&&(t.save(),s.H(t,e,!1),t.restore())},i.prototype.Od=function(t,e){var r=this.pi().Sf();this.Rd(t,e,Xe,Gr,r),this.Rd(t,e,Xe,ki,r)},i.prototype.Pd=function(t,e){this.Rd(t,e,Xe,ki,this.pi().Tf())},i.prototype.Vd=function(t,e,r){for(var s=j(this.ud).oa(),d=0,_=s;d<_.length;d++){var n=_[d];this.Rd(t,e,r,Gr,n)}for(var a=0,u=s;a<u.length;a++)n=u[a],this.Rd(t,e,r,ki,n)},i.prototype.Rd=function(t,e,r,s,d){for(var _=j(this.ud),n=r(d,_),a=_.Yt(),u=_.Ht(),p=_.jt().gf(),c=p!==null&&p.kf===d,g=p!==null&&c&&p.yd!==void 0?p.yd.Kh:void 0,S=0,w=n;S<w.length;S++){var m=w[S].dt(a,u);m!==null&&(t.save(),s(m,t,e,c,g),t.restore())}},i.prototype.Ad=function(t,e,r){for(var s=0,d=t;s<d.length;s++){var _=d[s],n=_.dt(this.o_.Ot,this.o_.Ft);if(n!==null&&n.$h){var a=n.$h(e,r);if(a!==null)return{i_:_,yd:a}}}return null},i.prototype.Md=function(){if(this.ud!==null){var t=this.ad,e=this.ud.Ya().W().visible,r=this.ud.$a().W().visible;e||this.X_===null||(this.fd.removeChild(this.X_.B_()),this.X_.g(),this.X_=null),r||this.Z_===null||(this.vd.removeChild(this.Z_.B_()),this.Z_.g(),this.Z_=null);var s=t.jt().qf();e&&this.X_===null&&(this.X_=new Kr(this,t.W().layout,s,"left"),this.fd.appendChild(this.X_.B_())),r&&this.Z_===null&&(this.Z_=new Kr(this,t.W().layout,s,"right"),this.vd.appendChild(this.Z_.B_()))}},i.prototype.Id=function(t){return t.Gv&&this.nd||this.sd!==null},i.prototype.jd=function(t){return Math.max(0,Math.min(t,this.o_.Ft-1))},i.prototype.qd=function(t){return Math.max(0,Math.min(t,this.o_.Ot-1))},i.prototype.pd=function(t,e){this.pi().Rf(this.jd(t),this.qd(e),j(this.ud))},i.prototype.Cd=function(){this.pi().If()},i.prototype.Dd=function(){this.hd&&(this.sd=null,this.Cd())},i.prototype.xd=function(t,e){this.sd=t,this.hd=!1,this.pd(e.x,e.y);var r=this.pi().Tf();this.rd={x:r.$t(),y:r.Kt()}},i.prototype.pi=function(){return this.ad.jt()},i.prototype.Ud=function(){var t=this.pi(),e=this.z_(),r=e.ji();t.Qa(e,r),t.Pf(),this.J_=null,this.G_=!1},i.prototype.Nd=function(t){var e=this;if(this.G_){var r=performance.now();if(this.ed!==null&&this.ed.xh(t.Yv,r),this.ed===null||this.ed.cc(r))this.Ud();else{var s=this.pi(),d=s.bt(),_=this.ed,n=function(){if(!_._c()){var a=performance.now(),u=_.cc(a);if(!_._c()){var p=d.Nl();s.Vf(_.fc(a)),p===d.Nl()&&(u=!0,e.ed=null)}u?e.Ud():requestAnimationFrame(n)}};requestAnimationFrame(n)}}},i.prototype.md=function(){this.sd=null},i.prototype.gd=function(){if(this.ud){if(this.Td(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)j(document.activeElement).blur();else{var t=document.getSelection();t!==null&&t.removeAllRanges()}!this.ud.ji().wi()&&this.pi().bt().wi()}},i.prototype.kd=function(t){if(this.ud!==null){var e=this.pi();if(!e.bt().wi()){var r=this.ad.W(),s=r.handleScroll,d=r.kineticScroll;if(s.pressedMouseMove&&!t.Gv||(s.horzTouchDrag||s.vertTouchDrag)&&t.Gv){var _=this.ud.ji(),n=performance.now();this.J_!==null||this.Id(t)||(this.J_={x:t.Rv,y:t.Iv,So:n,Yv:t.Yv,$v:t.$v}),this.ed!==null&&this.ed.lc(t.Yv,n),this.J_===null||this.G_||this.J_.x===t.Rv&&this.J_.y===t.Iv||(this.ed===null&&(t.Gv&&d.touch||!t.Gv&&d.mouse)&&(this.ed=new Sh(.2,7,.997,15),this.ed.lc(this.J_.Yv,this.J_.So),this.ed.lc(t.Yv,n)),_.wi()||e.Ja(this.ud,_,t.$v),e.Of(t.Yv),this.G_=!0),this.G_&&(_.wi()||e.Ga(this.ud,_,t.$v),e.Vf(t.Yv))}}}},i.prototype.Td=function(){var t=performance.now(),e=this.ed===null||this.ed.cc(t);this.ed!==null&&(e||this.Ud()),this.ed!==null&&(this.ed.dc(),this.ed=null)},i}(),Xr=function(){function i(t,e,r,s,d){var _=this;this.ft=!0,this.o_=new ft(0,0),this.d_=function(){return _.R_(3)},this.m_=t==="left",this.cf=r.qf,this.zi=e,this.Hd=s,this.Yd=d,this.p_=document.createElement("div"),this.p_.style.width="25px",this.p_.style.height="100%",this.p_.style.overflow="hidden",this.g_=re(this.p_,new ft(16,16)),this.g_.subscribeCanvasConfigured(this.d_)}return i.prototype.g=function(){this.g_.unsubscribeCanvasConfigured(this.d_),this.g_.destroy()},i.prototype.B_=function(){return this.p_},i.prototype.Ld=function(){return this.o_},i.prototype.P_=function(t){if(t.Ft<0||t.Ot<0)throw new Error("Try to set invalid size to PriceAxisStub "+JSON.stringify(t));this.o_.br(t)||(this.o_=t,this.g_.resizeCanvas({width:t.Ft,height:t.Ot}),this.p_.style.width="".concat(t.Ft,"px"),this.p_.style.minWidth="".concat(t.Ft,"px"),this.p_.style.height="".concat(t.Ot,"px"),this.ft=!0)},i.prototype.R_=function(t){if((!(t<3)||this.ft)&&this.o_.Ft!==0&&this.o_.Ot!==0){this.ft=!1;var e=zt(this.g_.canvas);this.j_(e,this.g_.pixelRatio),this.Rs(e,this.g_.pixelRatio)}},i.prototype.Y_=function(){return this.g_.canvas},i.prototype.Rs=function(t,e){if(this.Hd()){var r=this.o_.Ft;t.save(),t.fillStyle=this.zi.timeScale.borderColor;var s=Math.floor(this.cf.W().N*e),d=this.m_?Math.round(r*e)-s:0;t.fillRect(d,0,s,s),t.restore()}},i.prototype.j_=function(t,e){var r=this;$t(t,e,function(){pi(t,0,0,r.o_.Ft,r.o_.Ot,r.Yd())})},i}();function Eh(i,t){return i.Po>t.Po?i:t}var Mh=function(){function i(t){var e=this;this.$d=null,this.Kd=null,this.k=null,this.Xd=!1,this.o_=new ft(0,0),this.Zd=new dt,this.f_=new ve(5),this.__=!1,this.d_=function(){e.__||e.ad.jt().Wr()},this.b_=function(){e.__||e.ad.jt().Wr()},this.ad=t,this.zi=t.W().layout,this.Jd=document.createElement("tr"),this.Gd=document.createElement("td"),this.Gd.style.padding="0",this.Qd=document.createElement("td"),this.Qd.style.padding="0",this.p_=document.createElement("td"),this.p_.style.height="25px",this.p_.style.padding="0",this.tw=document.createElement("div"),this.tw.style.width="100%",this.tw.style.height="100%",this.tw.style.position="relative",this.tw.style.overflow="hidden",this.p_.appendChild(this.tw),this.g_=re(this.tw,new ft(16,16)),this.g_.subscribeCanvasConfigured(this.d_);var r=this.g_.canvas;r.style.position="absolute",r.style.zIndex="1",r.style.left="0",r.style.top="0",this.y_=re(this.tw,new ft(16,16)),this.y_.subscribeCanvasConfigured(this.b_);var s=this.y_.canvas;s.style.position="absolute",s.style.zIndex="2",s.style.left="0",s.style.top="0",this.Jd.appendChild(this.Gd),this.Jd.appendChild(this.p_),this.Jd.appendChild(this.Qd),this.iw(),this.ad.jt().Pa().u(this.iw.bind(this),this),this.A_=new ir(this.y_.canvas,this,{_v:function(){return!0},dv:function(){return!1}})}return i.prototype.g=function(){this.A_.g(),this.$d!==null&&this.$d.g(),this.Kd!==null&&this.Kd.g(),this.y_.unsubscribeCanvasConfigured(this.b_),this.y_.destroy(),this.g_.unsubscribeCanvasConfigured(this.d_),this.g_.destroy()},i.prototype.B_=function(){return this.Jd},i.prototype.nw=function(){return this.$d},i.prototype.sw=function(){return this.Kd},i.prototype.Tv=function(t){if(!this.Xd){this.Xd=!0;var e=this.ad.jt();!e.bt().wi()&&this.ad.W().handleScale.axisPressedMouseMove.time&&e.Lf(t.Yv)}},i.prototype.Cv=function(t){this.Tv(t)},i.prototype.Dv=function(){var t=this.ad.jt();!t.bt().wi()&&this.Xd&&(this.Xd=!1,this.ad.W().handleScale.axisPressedMouseMove.time&&t.zf())},i.prototype.bv=function(t){var e=this.ad.jt();!e.bt().wi()&&this.ad.W().handleScale.axisPressedMouseMove.time&&e.Wf(t.Yv)},i.prototype.wv=function(t){this.bv(t)},i.prototype.yv=function(){this.Xd=!1;var t=this.ad.jt();t.bt().wi()&&!this.ad.W().handleScale.axisPressedMouseMove.time||t.zf()},i.prototype.pv=function(){this.yv()},i.prototype.nv=function(){this.ad.W().handleScale.axisDoubleClickReset&&this.ad.jt().pn()},i.prototype.Gc=function(){this.nv()},i.prototype.ov=function(){this.ad.jt().W().handleScale.axisPressedMouseMove.time&&this.K_(1)},i.prototype.Wv=function(){this.K_(0)},i.prototype.Ld=function(){return this.o_},i.prototype.hw=function(){return this.Zd},i.prototype.rw=function(t,e,r){this.o_&&this.o_.br(t)||(this.o_=t,this.__=!0,this.g_.resizeCanvas({width:t.Ft,height:t.Ot}),this.y_.resizeCanvas({width:t.Ft,height:t.Ot}),this.__=!1,this.p_.style.width=t.Ft+"px",this.p_.style.height=t.Ot+"px",this.Zd.m(t)),this.$d!==null&&this.$d.P_(new ft(e,t.Ot)),this.Kd!==null&&this.Kd.P_(new ft(r,t.Ot))},i.prototype.ew=function(){var t=this.uw();return Math.ceil(t.N+t.C+t.S+t.O+t.B)},i.prototype.vt=function(){this.ad.jt().bt().au()},i.prototype.Y_=function(){return this.g_.canvas},i.prototype.R_=function(t){if(t!==0){if(t!==1){var e=zt(this.g_.canvas);this.j_(e,this.g_.pixelRatio),this.Rs(e,this.g_.pixelRatio),this.q_(e,this.g_.pixelRatio),this.$d!==null&&this.$d.R_(t),this.Kd!==null&&this.Kd.R_(t)}var r=zt(this.y_.canvas),s=this.y_.pixelRatio;r.clearRect(0,0,Math.ceil(this.o_.Ft*s),Math.ceil(this.o_.Ot*s)),this.aw([this.ad.jt().Tf()],r,s)}},i.prototype.j_=function(t,e){var r=this;$t(t,e,function(){pi(t,0,0,r.o_.Ft,r.o_.Ot,r.ad.jt().Xf())})},i.prototype.Rs=function(t,e){if(this.ad.W().timeScale.borderVisible){t.save(),t.fillStyle=this.ow();var r=Math.max(1,Math.floor(this.uw().N*e));t.fillRect(0,0,Math.ceil(this.o_.Ft*e),r),t.restore()}},i.prototype.q_=function(t,e){var r=this,s=this.ad.jt().bt().au();if(s&&s.length!==0){var d=s.reduce(Eh,s[0]).Po;d>30&&d<50&&(d=30),t.save(),t.strokeStyle=this.ow();var _=this.uw(),n=_.N+_.C+_.O+_.S-_.V;t.textAlign="center",t.fillStyle=this.ow();var a=Math.floor(this.uw().N*e),u=Math.max(1,Math.floor(e)),p=Math.floor(.5*e);if(this.ad.jt().bt().W().borderVisible){t.beginPath();for(var c=Math.round(_.C*e),g=s.length;g--;){var S=Math.round(s[g].su*e);t.rect(S-p,a,u,c)}t.fill()}t.fillStyle=this.j(),$t(t,e,function(){t.font=r.lw();for(var w=0,m=s;w<m.length;w++)if((f=m[w]).Po<d){var o=f.Sl?r.fw(t,f.su,f.yu):f.su;t.fillText(f.yu,o,n)}t.font=r.cw();for(var h=0,l=s;h<l.length;h++){var f;(f=l[h]).Po>=d&&(o=f.Sl?r.fw(t,f.su,f.yu):f.su,t.fillText(f.yu,o,n))}}),t.restore()}},i.prototype.fw=function(t,e,r){var s=this.f_.Qt(t,r),d=s/2,_=Math.floor(e-d)+.5;return _<0?e+=Math.abs(0-_):_+s>this.o_.Ft&&(e-=Math.abs(this.o_.Ft-(_+s))),e},i.prototype.aw=function(t,e,r){for(var s=this.uw(),d=0,_=t;d<_.length;d++)for(var n=0,a=_[d].Ti();n<a.length;n++){var u=a[n];e.save(),u.dt().H(e,s,r),e.restore()}},i.prototype.ow=function(){return this.ad.W().timeScale.borderColor},i.prototype.j=function(){return this.zi.textColor},i.prototype.R=function(){return this.zi.fontSize},i.prototype.lw=function(){return ie(this.R(),this.zi.fontFamily)},i.prototype.cw=function(){return ie(this.R(),this.zi.fontFamily,"bold")},i.prototype.uw=function(){this.k===null&&(this.k={N:1,V:NaN,O:NaN,B:NaN,mi:NaN,C:3,S:NaN,T:"",bi:new ve});var t=this.k,e=this.lw();if(t.T!==e){var r=this.R();t.S=r,t.T=e,t.O=Math.ceil(r/2.5),t.B=t.O,t.mi=Math.ceil(r/2),t.V=Math.round(this.R()/5),t.bi.ih()}return this.k},i.prototype.K_=function(t){this.p_.style.cursor=t===1?"ew-resize":"default"},i.prototype.iw=function(){var t=this.ad.jt(),e=t.W();e.leftPriceScale.visible||this.$d===null||(this.Gd.removeChild(this.$d.B_()),this.$d.g(),this.$d=null),e.rightPriceScale.visible||this.Kd===null||(this.Qd.removeChild(this.Kd.B_()),this.Kd.g(),this.Kd=null);var r={qf:this.ad.jt().qf()},s=function(){return e.leftPriceScale.borderVisible&&t.bt().W().borderVisible},d=function(){return t.Xf()};e.leftPriceScale.visible&&this.$d===null&&(this.$d=new Xr("left",e,r,s,d),this.Gd.appendChild(this.$d.B_())),e.rightPriceScale.visible&&this.Kd===null&&(this.Kd=new Xr("right",e,r,s,d),this.Qd.appendChild(this.Kd.B_()))},i}(),xh=function(){function i(t,e){var r;this._w=[],this.dw=0,this.xu=0,this.hh=0,this.ww=0,this.Mw=0,this.bw=null,this.mw=!1,this.Q_=new dt,this.af=new dt,this.zi=e,this.Jd=document.createElement("div"),this.Jd.classList.add("tv-lightweight-charts"),this.Jd.style.overflow="hidden",this.Jd.style.width="100%",this.Jd.style.height="100%",(r=this.Jd).style.userSelect="none",r.style.webkitUserSelect="none",r.style.msUserSelect="none",r.style.MozUserSelect="none",r.style.webkitTapHighlightColor="transparent",this.pw=document.createElement("table"),this.pw.setAttribute("cellspacing","0"),this.Jd.appendChild(this.pw),this.gw=this.yw.bind(this),this.Jd.addEventListener("wheel",this.gw,{passive:!1}),this.pi=new yh(this.ff.bind(this),this.zi),this.jt().Df().u(this.kw.bind(this),this),this.Nw=new Mh(this),this.pw.appendChild(this.Nw.B_());var s=this.zi.width,d=this.zi.height;if(s===0||d===0){var _=t.getBoundingClientRect();s===0&&(s=Math.floor(_.width),s-=s%2),d===0&&(d=Math.floor(_.height),d-=d%2)}this.xw(s,d),this.Cw(),t.appendChild(this.Jd),this.Sw(),this.pi.bt().Pl().u(this.pi.Ce.bind(this.pi),this),this.pi.Pa().u(this.pi.Ce.bind(this.pi),this)}return i.prototype.jt=function(){return this.pi},i.prototype.W=function(){return this.zi},i.prototype.Tw=function(){return this._w},i.prototype.Dw=function(){return this.Nw},i.prototype.g=function(){this.Jd.removeEventListener("wheel",this.gw),this.dw!==0&&window.cancelAnimationFrame(this.dw),this.pi.Df().M(this),this.pi.bt().Pl().M(this),this.pi.Pa().M(this),this.pi.g();for(var t=0,e=this._w;t<e.length;t++){var r=e[t];this.pw.removeChild(r.B_()),r.Sd().M(this),r.g()}this._w=[],j(this.Nw).g(),this.Jd.parentElement!==null&&this.Jd.parentElement.removeChild(this.Jd),this.af.g(),this.Q_.g()},i.prototype.xw=function(t,e,r){if(r===void 0&&(r=!1),this.xu!==e||this.hh!==t){this.xu=e,this.hh=t;var s=e+"px",d=t+"px";j(this.Jd).style.height=s,j(this.Jd).style.width=d,this.pw.style.height=s,this.pw.style.width=d,r?this.Aw(new Et(3)):this.pi.Ce()}},i.prototype.R_=function(t){t===void 0&&(t=new Et(3));for(var e=0;e<this._w.length;e++)this._w[e].R_(t.wn(e).vn);this.zi.timeScale.visible&&this.Nw.R_(t.dn())},i.prototype.Pr=function(t){this.pi.Pr(t),this.Sw();var e=t.width||this.hh,r=t.height||this.xu;this.xw(e,r)},i.prototype.Sd=function(){return this.Q_},i.prototype.Df=function(){return this.af},i.prototype.Bw=function(){var t=this;this.bw!==null&&(this.Aw(this.bw),this.bw=null);var e=this._w[0],r=js(document,new ft(this.hh,this.xu)),s=zt(r),d=oi(r);return $t(s,d,function(){var _=0,n=0,a=function(m){for(var o=0;o<t._w.length;o++){var h=t._w[o],l=h.Ld().Ot,f=j(m==="left"?h.Wd():h.zd()),v=f.Y_();s.drawImage(v,_,n,f.W_(),l),n+=l}};t.Lw()&&(a("left"),_=j(e.Wd()).W_()),n=0;for(var u=0;u<t._w.length;u++){var p=t._w[u],c=p.Ld(),g=p.Y_();s.drawImage(g,_,n,c.Ft,c.Ot),n+=c.Ot}_+=e.Ld().Ft,t.Ew()&&(n=0,a("right"));var S=function(m){var o=j(m==="left"?t.Nw.nw():t.Nw.sw()),h=o.Ld(),l=o.Y_();s.drawImage(l,_,n,h.Ft,h.Ot)};if(t.zi.timeScale.visible){_=0,t.Lw()&&(S("left"),_=j(e.Wd()).W_());var w=t.Nw.Ld();g=t.Nw.Y_(),s.drawImage(g,_,n,w.Ft,w.Ot),t.Ew()&&(_+=e.Ld().Ft,S("right"),s.restore())}}),r},i.prototype.Fw=function(t){return t==="none"?0:(t!=="left"||this.Lw())&&(t!=="right"||this.Ew())?this._w.length===0?0:j(t==="left"?this._w[0].Wd():this._w[0].zd()).W_():0},i.prototype.Ow=function(){for(var t=0,e=0,r=0,s=0,d=this._w;s<d.length;s++){var _=d[s];this.Lw()&&(e=Math.max(e,j(_.Wd()).O_())),this.Ew()&&(r=Math.max(r,j(_.zd()).O_())),t+=_.Wa()}var n=this.hh,a=this.xu,u=Math.max(n-e-r,0),p=this.zi.timeScale.visible,c=p?this.Nw.ew():0;c%2&&(c+=1);for(var g=0+c,S=a<g?0:a-g,w=S/t,m=0,o=0;o<this._w.length;++o){(_=this._w[o]).wd(this.pi.Cf()[o]);var h,l=0;l=o===this._w.length-1?S-m:Math.round(_.Wa()*w),m+=h=Math.max(l,2),_.P_(new ft(u,h)),this.Lw()&&_.Bd(e,"left"),this.Ew()&&_.Bd(r,"right"),_.z_()&&this.pi.Af(_.z_(),h)}this.Nw.rw(new ft(p?u:0,c),p?e:0,p?r:0),this.pi.Ra(u),this.ww!==e&&(this.ww=e),this.Mw!==r&&(this.Mw=r)},i.prototype.yw=function(t){var e=t.deltaX/100,r=-t.deltaY/100;if(e!==0&&this.zi.handleScroll.mouseWheel||r!==0&&this.zi.handleScale.mouseWheel){switch(t.cancelable&&t.preventDefault(),t.deltaMode){case t.DOM_DELTA_PAGE:e*=120,r*=120;break;case t.DOM_DELTA_LINE:e*=32,r*=32}if(r!==0&&this.zi.handleScale.mouseWheel){var s=Math.sign(r)*Math.min(1,Math.abs(r)),d=t.clientX-this.Jd.getBoundingClientRect().left;this.jt().Ef(d,s)}e!==0&&this.zi.handleScroll.mouseWheel&&this.jt().Ff(-80*e)}},i.prototype.Aw=function(t){var e,r=t.dn();r===3&&this.Vw(),r!==3&&r!==2||(this.Pw(t),this.Ww(t),this.Nw.vt(),this._w.forEach(function(s){s.bd()}),((e=this.bw)===null||e===void 0?void 0:e.dn())===3&&(this.bw.Nn(t),this.Vw(),this.Pw(this.bw),this.Ww(this.bw),t=this.bw,this.bw=null)),this.R_(t)},i.prototype.Ww=function(t){for(var e=0,r=t.kn();e<r.length;e++){var s=r[e];this.xn(s)}},i.prototype.Pw=function(t){for(var e=this.pi.Cf(),r=0;r<e.length;r++)t.wn(r)._n&&e[r].so()},i.prototype.xn=function(t){var e=this.pi.bt();switch(t.bn){case 0:e.zl();break;case 1:e.Rl(t.St);break;case 2:e.gn(t.St);break;case 3:e.yn(t.St);break;case 4:e.Tl()}},i.prototype.ff=function(t){var e=this;this.bw!==null?this.bw.Nn(t):this.bw=t,this.mw||(this.mw=!0,this.dw=window.requestAnimationFrame(function(){if(e.mw=!1,e.dw=0,e.bw!==null){var r=e.bw;e.bw=null,e.Aw(r)}}))},i.prototype.Vw=function(){this.Cw()},i.prototype.Cw=function(){for(var t=this.pi.Cf(),e=t.length,r=this._w.length,s=e;s<r;s++){var d=Rt(this._w.pop());this.pw.removeChild(d.B_()),d.Sd().M(this),d.g()}for(s=r;s<e;s++)(d=new Ch(this,t[s])).Sd().u(this.zw.bind(this),this),this._w.push(d),this.pw.insertBefore(d.B_(),this.Nw.B_());for(s=0;s<e;s++){var _=t[s];(d=this._w[s]).z_()!==_?d.wd(_):d.dd()}this.Sw(),this.Ow()},i.prototype.Rw=function(t,e){var r,s=new Map;if(t!==null&&this.pi._t().forEach(function(u){var p=u.er(t);p!==null&&s.set(u,p)}),t!==null){var d=this.pi.bt().gi(t);d!==null&&(r=d)}var _=this.jt().gf(),n=_!==null&&_.kf instanceof tr?_.kf:void 0,a=_!==null&&_.yd!==void 0?_.yd.Zh:void 0;return{rt:r,Iw:e||void 0,jw:n,qw:s,Uw:a}},i.prototype.zw=function(t,e){var r=this;this.Q_.m(function(){return r.Rw(t,e)})},i.prototype.kw=function(t,e){var r=this;this.af.m(function(){return r.Rw(t,e)})},i.prototype.Sw=function(){var t=this.zi.timeScale.visible?"":"none";this.Nw.B_().style.display=t},i.prototype.Lw=function(){return this._w[0].z_().Ya().W().visible},i.prototype.Ew=function(){return this._w[0].z_().$a().W().visible},i}();function qr(i,t,e){var r=e.value;return{vs:t,rt:i,St:[r,r,r,r]}}function Yr(i,t,e){var r=e.value,s={vs:t,rt:i,St:[r,r,r,r]};return"color"in e&&e.color!==void 0&&(s.A=e.color),s}function qe(i){return i.St!==void 0}function ae(i){return function(t,e,r){return(s=r).open===void 0&&s.value===void 0?{rt:t,vs:e}:i(t,e,r);var s}}var kh={Candlestick:ae(function(i,t,e){var r={vs:t,rt:i,St:[e.open,e.high,e.low,e.close]};return"color"in e&&e.color!==void 0&&(r.A=e.color),"borderColor"in e&&e.borderColor!==void 0&&(r.Tt=e.borderColor),"wickColor"in e&&e.wickColor!==void 0&&(r.qs=e.wickColor),r}),Bar:ae(function(i,t,e){var r={vs:t,rt:i,St:[e.open,e.high,e.low,e.close]};return"color"in e&&e.color!==void 0&&(r.A=e.color),r}),Area:ae(qr),Baseline:ae(qr),Histogram:ae(Yr),Line:ae(Yr)};function Jr(i){return kh[i]}function Ye(i){return 60*i*60*1e3}function Bi(i){return 60*i*1e3}var Zr,Je=[{Hw:(Zr=1,1e3*Zr),Po:10},{Hw:Bi(1),Po:20},{Hw:Bi(5),Po:21},{Hw:Bi(30),Po:22},{Hw:Ye(1),Po:30},{Hw:Ye(3),Po:31},{Hw:Ye(6),Po:32},{Hw:Ye(12),Po:33}];function Qr(i,t){if(i.getUTCFullYear()!==t.getUTCFullYear())return 70;if(i.getUTCMonth()!==t.getUTCMonth())return 60;if(i.getUTCDate()!==t.getUTCDate())return 50;for(var e=Je.length-1;e>=0;--e)if(Math.floor(t.getTime()/Je[e].Hw)!==Math.floor(i.getTime()/Je[e].Hw))return Je[e].Po;return 0}function ts(i,t){if(t===void 0&&(t=0),i.length!==0){for(var e=t===0?null:i[t-1].rt.So,r=e!==null?new Date(1e3*e):null,s=0,d=t;d<i.length;++d){var _=i[d],n=new Date(1e3*_.rt.So);r!==null&&(_.Vo=Qr(n,r)),s+=_.rt.So-(e||_.rt.So),e=_.rt.So,r=n}if(t===0&&i.length>1){var a=Math.ceil(s/(i.length-1)),u=new Date(1e3*(i[0].rt.So-a));i[0].Vo=Qr(new Date(1e3*i[0].rt.So),u)}}}function Fi(i){if(!er(i))throw new Error("time must be of type BusinessDay");var t=new Date(Date.UTC(i.year,i.month-1,i.day,0,0,0,0));return{So:Math.round(t.getTime()/1e3),Co:i}}function Us(i){if(!$s(i))throw new Error("time must be of type isUTCTimestamp");return{So:i}}function es(i){return i.length===0?null:er(i[0].time)?Fi:Us}function ti(i){return $s(i)?Us(i):er(i)?Fi(i):Fi(Vs(i))}function Vs(i){var t=new Date(i);if(isNaN(t.getTime()))throw new Error("Invalid date string=".concat(i,", expected format=yyyy-mm-dd"));return{day:t.getUTCDate(),month:t.getUTCMonth()+1,year:t.getUTCFullYear()}}function is(i){Ki(i.time)&&(i.time=Vs(i.time))}function rs(i){return{vs:0,Yw:new Map,Ve:i}}function ss(i){if(i!==void 0&&i.length!==0)return{$w:i[0].rt.So,Kw:i[i.length-1].rt.So}}var Bh=function(){function i(){this.Xw=new Map,this.Zw=new Map,this.Jw=new Map,this.Gw=[]}return i.prototype.g=function(){this.Xw.clear(),this.Zw.clear(),this.Jw.clear(),this.Gw=[]},i.prototype.Qw=function(t,e){var r=this,s=this.Xw.size!==0,d=!1,_=this.Zw.get(t);if(_!==void 0)if(this.Zw.size===1)s=!1,d=!0,this.Xw.clear();else for(var n=0,a=this.Gw;n<a.length;n++)a[n].pointData.Yw.delete(t)&&(d=!0);var u=[];if(e.length!==0){(function(w){w.forEach(is)})(e);var p=j(es(e)),c=Jr(t.Rr());u=e.map(function(w){var m=p(w.time),o=r.Xw.get(m.So);o===void 0&&(o=rs(m),r.Xw.set(m.So,o),d=!0);var h=c(m,o.vs,w);return o.Yw.set(t,h),h})}s&&this.tM(),this.iM(t,u);var g=-1;if(d){var S=[];this.Xw.forEach(function(w){S.push({Vo:0,rt:w.Ve,pointData:w})}),S.sort(function(w,m){return w.rt.So-m.rt.So}),g=this.nM(S)}return this.sM(t,g,function(w,m){var o=ss(w),h=ss(m);if(o!==void 0&&h!==void 0)return{Ae:o.Kw>=h.Kw&&o.$w>=h.$w}}(this.Zw.get(t),_))},i.prototype.Yf=function(t){return this.Qw(t,[])},i.prototype.hM=function(t,e){is(e);var r=j(es([e]))(e.time),s=this.Jw.get(t);if(s!==void 0&&r.So<s.So)throw new Error("Cannot update oldest data, last time=".concat(s.So,", new time=").concat(r.So));var d=this.Xw.get(r.So),_=d===void 0;d===void 0&&(d=rs(r),this.Xw.set(r.So,d));var n=Jr(t.Rr())(r,d.vs,e);d.Yw.set(t,n),this.rM(t,n);var a={Ae:qe(n)};if(!_)return this.sM(t,-1,a);var u={Vo:0,rt:d.Ve,pointData:d},p=He(this.Gw,u.rt.So,function(g,S){return g.rt.So<S});this.Gw.splice(p,0,u);for(var c=p;c<this.Gw.length;++c)Ri(this.Gw[c].pointData,c);return ts(this.Gw,p),this.sM(t,p,a)},i.prototype.rM=function(t,e){var r=this.Zw.get(t);r===void 0&&(r=[],this.Zw.set(t,r));var s=r.length!==0?r[r.length-1]:null;s===null||e.rt.So>s.rt.So?qe(e)&&r.push(e):qe(e)?r[r.length-1]=e:r.splice(-1,1),this.Jw.set(t,e.rt)},i.prototype.iM=function(t,e){e.length!==0?(this.Zw.set(t,e.filter(qe)),this.Jw.set(t,e[e.length-1].rt)):(this.Zw.delete(t),this.Jw.delete(t))},i.prototype.tM=function(){for(var t=0,e=this.Gw;t<e.length;t++){var r=e[t];r.pointData.Yw.size===0&&this.Xw.delete(r.rt.So)}},i.prototype.nM=function(t){for(var e=-1,r=0;r<this.Gw.length&&r<t.length;++r){var s=this.Gw[r],d=t[r];if(s.rt.So!==d.rt.So){e=r;break}d.Vo=s.Vo,Ri(d.pointData,r)}if(e===-1&&this.Gw.length!==t.length&&(e=Math.min(this.Gw.length,t.length)),e===-1)return-1;for(r=e;r<t.length;++r)Ri(t[r].pointData,r);return ts(t,e),this.Gw=t,e},i.prototype.eM=function(){if(this.Zw.size===0)return null;var t=0;return this.Zw.forEach(function(e){e.length!==0&&(t=Math.max(t,e[e.length-1].vs))}),t},i.prototype.sM=function(t,e,r){var s={uM:new Map,bt:{ml:this.eM()}};if(e!==-1)this.Zw.forEach(function(_,n){s.uM.set(n,{ph:_,aM:n===t?r:void 0})}),this.Zw.has(t)||s.uM.set(t,{ph:[],aM:r}),s.bt.oM=this.Gw,s.bt.lM=e;else{var d=this.Zw.get(t);s.uM.set(t,{ph:d||[],aM:r})}return s},i}();function Ri(i,t){i.vs=t,i.Yw.forEach(function(e){e.vs=t})}var Rh={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:""},Lh=function(){function i(t){this.Lr=t}return i.prototype.applyOptions=function(t){this.Lr.Pr(t)},i.prototype.options=function(){return this.Lr.W()},i.prototype.fM=function(){return this.Lr},i}();function Zt(i){var t=i.overlay,e=function(r,s){var d={};for(var _ in r)Object.prototype.hasOwnProperty.call(r,_)&&s.indexOf(_)<0&&(d[_]=r[_]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var n=0;for(_=Object.getOwnPropertySymbols(r);n<_.length;n++)s.indexOf(_[n])<0&&Object.prototype.propertyIsEnumerable.call(r,_[n])&&(d[_[n]]=r[_[n]])}return d}(i,["overlay"]);return t&&(e.priceScaleId=""),e}var ce=function(){function i(t,e,r){this.Kn=t,this.cM=e,this.vM=r}return i.prototype.priceFormatter=function(){return this.Kn.qe()},i.prototype.priceToCoordinate=function(t){var e=this.Kn.kt();return e===null?null:this.Kn.Ct().xt(t,e.St)},i.prototype.coordinateToPrice=function(t){var e=this.Kn.kt();return e===null?null:this.Kn.Ct().qi(t,e.St)},i.prototype.barsInLogicalRange=function(t){if(t===null)return null;var e=new Qe(new ke(t.from,t.to)).jo(),r=this.Kn.an();if(r.wi())return null;var s=r.ne(e.In(),1),d=r.ne(e.jn(),-1),_=j(r.Qr()),n=j(r.un());if(s!==null&&d!==null&&s.vs>d.vs)return{barsBefore:t.from-_,barsAfter:n-t.to};var a={barsBefore:s===null||s.vs===_?t.from-_:s.vs-_,barsAfter:d===null||d.vs===n?n-t.to:n-d.vs};return s!==null&&d!==null&&(a.from=s.rt.Co||s.rt.So,a.to=d.rt.Co||d.rt.So),a},i.prototype.setData=function(t){this.Kn.Rr(),this.cM._M(this.Kn,t)},i.prototype.update=function(t){this.Kn.Rr(),this.cM.dM(this.Kn,t)},i.prototype.setMarkers=function(t){var e=t.map(function(r){return st(st({},r),{time:ti(r.time)})});this.Kn.Le(e)},i.prototype.applyOptions=function(t){var e=Zt(t);this.Kn.Pr(e)},i.prototype.options=function(){return vt(this.Kn.W())},i.prototype.priceScale=function(){return this.vM.priceScale(this.Kn.Ct().Ke())},i.prototype.createPriceLine=function(t){var e=ut(vt(Rh),t),r=this.Kn.Ee(e);return new Lh(r)},i.prototype.removePriceLine=function(t){this.Kn.Fe(t.fM())},i.prototype.seriesType=function(){return this.Kn.Rr()},i}(),Dh=function(i){function t(){return i!==null&&i.apply(this,arguments)||this}return rt(t,i),t.prototype.applyOptions=function(e){Ns(e),i.prototype.applyOptions.call(this,e)},t}(ce),Li={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,drawTicks:!0,scaleMargins:{bottom:.1,top:.2}},Th={color:"rgba(0, 0, 0, 0)",visible:!1,fontSize:48,fontFamily:Gi,fontStyle:"",text:"",horzAlign:"center",vertAlign:"center"},ns={width:0,height:0,layout:{background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:11,fontFamily:Gi},crosshair:{vertLine:{color:"#758696",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},horzLine:{color:"#758696",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#4c525e"},mode:1},grid:{vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},overlayPriceScales:st({},Li),leftPriceScale:st(st({},Li),{visible:!1}),rightPriceScale:st(st({},Li),{visible:!0}),timeScale:{rightOffset:0,barSpacing:6,minBarSpacing:.5,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0},watermark:Th,localization:{locale:gi?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:!0,mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}},Ah={upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},Ph={upColor:"#26a69a",downColor:"#ef5350",openVisible:!0,thinBars:!0},Oh={color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},Ih={topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},Hh={baseValue:{type:"price",price:0},topFillColor1:"rgba(38, 166, 154, 0.28)",topFillColor2:"rgba(38, 166, 154, 0.05)",topLineColor:"rgba(38, 166, 154, 1)",bottomFillColor1:"rgba(239, 83, 80, 0.05)",bottomFillColor2:"rgba(239, 83, 80, 0.28)",bottomLineColor:"rgba(239, 83, 80, 1)",lineWidth:3,lineStyle:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBackgroundColor:"",lastPriceAnimation:0},Fh={color:"#26a69a",base:0},he={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}},Wh=function(){function i(t,e){this.wM=t,this.MM=e}return i.prototype.applyOptions=function(t){this.wM.jt().Nf(this.MM,t)},i.prototype.options=function(){return this._i().W()},i.prototype.width=function(){return _i(this.MM)?this.wM.Fw(this.MM==="left"?"left":"right"):0},i.prototype._i=function(){return j(this.wM.jt().xf(this.MM)).Ct},i}(),zh=function(){function i(t,e){this.bM=new dt,this.Go=new dt,this.Zd=new dt,this.pi=t,this.Da=t.bt(),this.Nw=e,this.Da.Ol().u(this.mM.bind(this)),this.Da.Vl().u(this.pM.bind(this)),this.Nw.hw().u(this.gM.bind(this))}return i.prototype.g=function(){this.Da.Ol().M(this),this.Da.Vl().M(this),this.Nw.hw().M(this),this.bM.g(),this.Go.g(),this.Zd.g()},i.prototype.scrollPosition=function(){return this.Da.Nl()},i.prototype.scrollToPosition=function(t,e){e?this.Da.Fl(t,1e3):this.pi.yn(t)},i.prototype.scrollToRealTime=function(){this.Da.El()},i.prototype.getVisibleRange=function(){var t,e,r=this.Da.cl();return r===null?null:{from:(t=r.from.Co)!==null&&t!==void 0?t:r.from.So,to:(e=r.to.Co)!==null&&e!==void 0?e:r.to.So}},i.prototype.setVisibleRange=function(t){var e={from:ti(t.from),to:ti(t.to)},r=this.Da.wl(e);this.pi.$f(r)},i.prototype.getVisibleLogicalRange=function(){var t=this.Da.fl();return t===null?null:{from:t.In(),to:t.jn()}},i.prototype.setVisibleLogicalRange=function(t){ge(t.from<=t.to,"The from index cannot be after the to index."),this.pi.$f(t)},i.prototype.resetTimeScale=function(){this.pi.pn()},i.prototype.fitContent=function(){this.pi.zl()},i.prototype.logicalToCoordinate=function(t){var e=this.pi.bt();return e.wi()?null:e.At(t)},i.prototype.coordinateToLogical=function(t){return this.Da.wi()?null:this.Da.pl(t)},i.prototype.timeToCoordinate=function(t){var e=ti(t),r=this.Da.Ze(e,!1);return r===null?null:this.Da.At(r)},i.prototype.coordinateToTime=function(t){var e,r=this.pi.bt(),s=r.pl(t),d=r.gi(s);return d===null?null:(e=d.Co)!==null&&e!==void 0?e:d.So},i.prototype.width=function(){return this.Nw.Ld().Ft},i.prototype.height=function(){return this.Nw.Ld().Ot},i.prototype.subscribeVisibleTimeRangeChange=function(t){this.bM.u(t)},i.prototype.unsubscribeVisibleTimeRangeChange=function(t){this.bM._(t)},i.prototype.subscribeVisibleLogicalRangeChange=function(t){this.Go.u(t)},i.prototype.unsubscribeVisibleLogicalRangeChange=function(t){this.Go._(t)},i.prototype.subscribeSizeChange=function(t){this.Zd.u(t)},i.prototype.unsubscribeSizeChange=function(t){this.Zd._(t)},i.prototype.applyOptions=function(t){this.Da.Pr(t)},i.prototype.options=function(){return vt(this.Da.W())},i.prototype.mM=function(){this.bM.p()&&this.bM.m(this.getVisibleRange())},i.prototype.pM=function(){this.Go.p()&&this.Go.m(this.getVisibleLogicalRange())},i.prototype.gM=function(t){this.Zd.m(t.Ft,t.Ot)},i}();function le(i){if(i!==void 0&&i.type!=="custom"){var t=i;t.minMove!==void 0&&t.precision===void 0&&(t.precision=function(e){if(e>=1)return 0;for(var r=0;r<8;r++){var s=Math.round(e);if(Math.abs(s-e)<1e-8)return r;e*=10}return r}(t.minMove))}}function os(i){return function(t){if(yi(t.handleScale)){var e=t.handleScale;t.handleScale={axisDoubleClickReset:e,axisPressedMouseMove:{time:e,price:e},mouseWheel:e,pinch:e}}else if(t.handleScale!==void 0&&yi(t.handleScale.axisPressedMouseMove)){var r=t.handleScale.axisPressedMouseMove;t.handleScale.axisPressedMouseMove={time:r,price:r}}var s=t.handleScroll;yi(s)&&(t.handleScroll={horzTouchDrag:s,vertTouchDrag:s,mouseWheel:s,pressedMouseMove:s})}(i),function(t){if(t.priceScale){t.leftPriceScale=t.leftPriceScale||{},t.rightPriceScale=t.rightPriceScale||{};var e=t.priceScale.position;delete t.priceScale.position,t.leftPriceScale=ut(t.leftPriceScale,t.priceScale),t.rightPriceScale=ut(t.rightPriceScale,t.priceScale),e==="left"&&(t.leftPriceScale.visible=!0,t.rightPriceScale.visible=!1),e==="right"&&(t.leftPriceScale.visible=!1,t.rightPriceScale.visible=!0),e==="none"&&(t.leftPriceScale.visible=!1,t.rightPriceScale.visible=!1),t.overlayPriceScales=t.overlayPriceScales||{},t.priceScale.invertScale!==void 0&&(t.overlayPriceScales.invertScale=t.priceScale.invertScale),t.priceScale.scaleMargins!==void 0&&(t.overlayPriceScales.scaleMargins=t.priceScale.scaleMargins)}}(i),function(t){t.layout&&t.layout.backgroundColor&&!t.layout.background&&(t.layout.background={type:"solid",color:t.layout.backgroundColor})}(i),i}var Nh=function(){function i(t,e){var r=this;this.yM=new Bh,this.kM=new Map,this.NM=new Map,this.xM=new dt,this.CM=new dt;var s=e===void 0?vt(ns):ut(vt(ns),os(e));this.wM=new xh(t,s),this.wM.Sd().u(function(_){r.xM.p()&&r.xM.m(r.SM(_()))},this),this.wM.Df().u(function(_){r.CM.p()&&r.CM.m(r.SM(_()))},this);var d=this.wM.jt();this.TM=new zh(d,this.wM.Dw())}return i.prototype.remove=function(){this.wM.Sd().M(this),this.wM.Df().M(this),this.TM.g(),this.wM.g(),this.kM.clear(),this.NM.clear(),this.xM.g(),this.CM.g(),this.yM.g()},i.prototype.resize=function(t,e,r){this.wM.xw(t,e,r)},i.prototype.addAreaSeries=function(t){t===void 0&&(t={}),le((t=Zt(t)).priceFormat);var e=ut(vt(he),Ih,t),r=this.wM.jt().Uf("Area",e),s=new ce(r,this,this);return this.kM.set(s,r),this.NM.set(r,s),s},i.prototype.addBaselineSeries=function(t){t===void 0&&(t={}),le((t=Zt(t)).priceFormat);var e=ut(vt(he),vt(Hh),t),r=this.wM.jt().Uf("Baseline",e),s=new ce(r,this,this);return this.kM.set(s,r),this.NM.set(r,s),s},i.prototype.addBarSeries=function(t){t===void 0&&(t={}),le((t=Zt(t)).priceFormat);var e=ut(vt(he),Ph,t),r=this.wM.jt().Uf("Bar",e),s=new ce(r,this,this);return this.kM.set(s,r),this.NM.set(r,s),s},i.prototype.addCandlestickSeries=function(t){t===void 0&&(t={}),Ns(t=Zt(t)),le(t.priceFormat);var e=ut(vt(he),Ah,t),r=this.wM.jt().Uf("Candlestick",e),s=new Dh(r,this,this);return this.kM.set(s,r),this.NM.set(r,s),s},i.prototype.addHistogramSeries=function(t){t===void 0&&(t={}),le((t=Zt(t)).priceFormat);var e=ut(vt(he),Fh,t),r=this.wM.jt().Uf("Histogram",e),s=new ce(r,this,this);return this.kM.set(s,r),this.NM.set(r,s),s},i.prototype.addLineSeries=function(t){t===void 0&&(t={}),le((t=Zt(t)).priceFormat);var e=ut(vt(he),Oh,t),r=this.wM.jt().Uf("Line",e),s=new ce(r,this,this);return this.kM.set(s,r),this.NM.set(r,s),s},i.prototype.removeSeries=function(t){var e=Rt(this.kM.get(t)),r=this.yM.Yf(e);this.wM.jt().Yf(e),this.DM(r),this.kM.delete(t),this.NM.delete(e)},i.prototype._M=function(t,e){this.DM(this.yM.Qw(t,e))},i.prototype.dM=function(t,e){this.DM(this.yM.hM(t,e))},i.prototype.subscribeClick=function(t){this.xM.u(t)},i.prototype.unsubscribeClick=function(t){this.xM._(t)},i.prototype.subscribeCrosshairMove=function(t){this.CM.u(t)},i.prototype.unsubscribeCrosshairMove=function(t){this.CM._(t)},i.prototype.priceScale=function(t){return t===void 0&&(t=this.wM.jt().Kf()),new Wh(this.wM,t)},i.prototype.timeScale=function(){return this.TM},i.prototype.applyOptions=function(t){this.wM.Pr(os(t))},i.prototype.options=function(){return this.wM.W()},i.prototype.takeScreenshot=function(){return this.wM.Bw()},i.prototype.DM=function(t){var e=this.wM.jt();e.jf(t.bt.ml,t.bt.oM,t.bt.lM),t.uM.forEach(function(r,s){return s.Z(r.ph,r.aM)}),e.yl()},i.prototype.AM=function(t){return Rt(this.NM.get(t))},i.prototype.SM=function(t){var e=this,r=new Map;t.qw.forEach(function(d,_){r.set(e.AM(_),d)});var s=t.jw===void 0?void 0:this.AM(t.jw);return{time:t.rt&&(t.rt.Co||t.rt.So),point:t.Iw,hoveredSeries:s,hoveredMarkerId:t.Uw,seriesPrices:r}},i}();function $h(i,t){var e;if(Ki(i)){var r=document.getElementById(i);ge(r!==null,"Cannot find element in DOM with id=".concat(i)),e=r}else e=i;return new Nh(e,t)}const jh=X.forwardRef(({initialData:i},t)=>{const e=X.useRef(null),r=X.useRef(null),s=X.useRef(null),d=X.useRef([]),_=X.useRef(new Map);return X.useEffect(()=>{if(!e.current)return;const n=e.current,a=$h(n,{layout:{background:{color:"#111827"},textColor:"rgba(255, 255, 255, 0.9)"},grid:{vertLines:{color:"#374151"},horzLines:{color:"#374151"}},timeScale:{timeVisible:!0,secondsVisible:!1}});r.current=a;const u=a.addCandlestickSeries({upColor:"#34D399",downColor:"#F87171",borderDownColor:"#F87171",borderUpColor:"#34D399",wickDownColor:"#F87171",wickUpColor:"#34D399"});s.current=u;const p=i.map(g=>({time:g.time,open:g.open,high:g.high,low:g.low,close:g.close}));u.setData(p);const c=new ResizeObserver(g=>{if(g.length===0||!g[0].target)return;const{width:S,height:w}=g[0].contentRect;S>0&&w>0&&a.applyOptions({width:S,height:w})});return c.observe(n),()=>{c.disconnect(),a.remove()}},[i]),X.useImperativeHandle(t,()=>({addTradeMarker(n){if(!s.current)return;const a=n.side==="BUY",u={time:n.timestamp,position:a?"belowBar":"aboveBar",color:a?"#00ff84":"#ff4976",shape:a?"arrowUp":"arrowDown",text:`${n.side} @ ${n.price.toFixed(4)}`,size:1.5,id:n.trade_id};d.current=[...d.current.filter(p=>p.id!==u.id),u].sort((p,c)=>p.time-c.time),s.current.setMarkers(d.current)},visualizeAISignal(n){if(!s.current)return;const a={time:n.timestamp,position:"inBar",color:"#007acc",shape:"circle",text:`AI: ${n.signal_type}`,size:.8,id:n.signal_id};d.current=[...d.current.filter(u=>u.id!==a.id),a].sort((u,p)=>u.time-p.time),s.current.setMarkers(d.current)},manageAIStructureLine(n,a,u){if(s.current){if(u==="CREATE"){if(_.current.has(n))return;const p=s.current.createPriceLine(a);_.current.set(n,p)}else if(u==="REMOVE"){const p=_.current.get(n);p&&(s.current.removePriceLine(p),_.current.delete(n))}}},clearDrawings(){s.current&&(s.current.setMarkers([]),d.current=[],_.current.forEach(n=>{var a;return(a=s.current)==null?void 0:a.removePriceLine(n)}),_.current.clear())}})),Q.jsx("div",{ref:e,style:{minHeight:"500px",border:"2px solid red"}})});var Ks={exports:{}};(function(i,t){(function(e,r){i.exports=r()})(self,()=>(()=>{var e={4567:function(_,n,a){var u=this&&this.__decorate||function(f,v,b,C){var M,y=arguments.length,E=y<3?v:C===null?C=Object.getOwnPropertyDescriptor(v,b):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(f,v,b,C);else for(var B=f.length-1;B>=0;B--)(M=f[B])&&(E=(y<3?M(E):y>3?M(v,b,E):M(v,b))||E);return y>3&&E&&Object.defineProperty(v,b,E),E},p=this&&this.__param||function(f,v){return function(b,C){v(b,C,f)}};Object.defineProperty(n,"__esModule",{value:!0}),n.AccessibilityManager=void 0;const c=a(9042),g=a(6114),S=a(9924),w=a(844),m=a(5596),o=a(4725),h=a(3656);let l=n.AccessibilityManager=class extends w.Disposable{constructor(f,v){super(),this._terminal=f,this._renderService=v,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=document.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let b=0;b<this._terminal.rows;b++)this._rowElements[b]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[b]);if(this._topBoundaryFocusListener=b=>this._handleBoundaryFocus(b,0),this._bottomBoundaryFocusListener=b=>this._handleBoundaryFocus(b,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new S.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(b=>this._handleResize(b.rows))),this.register(this._terminal.onRender(b=>this._refreshRows(b.start,b.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(b=>this._handleChar(b))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(b=>this._handleTab(b))),this.register(this._terminal.onKey(b=>this._handleKey(b.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new m.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,h.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,w.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(f){for(let v=0;v<f;v++)this._handleChar(" ")}_handleChar(f){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==f&&(this._charsToAnnounce+=f):this._charsToAnnounce+=f,f===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=c.tooMuchOutput)),g.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityContainer.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,g.isMac&&this._liveRegion.remove()}_handleKey(f){this._clearLiveRegion(),new RegExp("\\p{Control}","u").test(f)||this._charsToConsume.push(f)}_refreshRows(f,v){this._liveRegionDebouncer.refresh(f,v,this._terminal.rows)}_renderRows(f,v){const b=this._terminal.buffer,C=b.lines.length.toString();for(let M=f;M<=v;M++){const y=b.translateBufferLineToString(b.ydisp+M,!0),E=(b.ydisp+M+1).toString(),B=this._rowElements[M];B&&(y.length===0?B.innerText=" ":B.textContent=y,B.setAttribute("aria-posinset",E),B.setAttribute("aria-setsize",C))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(f,v){const b=f.target,C=this._rowElements[v===0?1:this._rowElements.length-2];if(b.getAttribute("aria-posinset")===(v===0?"1":`${this._terminal.buffer.lines.length}`)||f.relatedTarget!==C)return;let M,y;if(v===0?(M=b,y=this._rowElements.pop(),this._rowContainer.removeChild(y)):(M=this._rowElements.shift(),y=b,this._rowContainer.removeChild(M)),M.removeEventListener("focus",this._topBoundaryFocusListener),y.removeEventListener("focus",this._bottomBoundaryFocusListener),v===0){const E=this._createAccessibilityTreeNode();this._rowElements.unshift(E),this._rowContainer.insertAdjacentElement("afterbegin",E)}else{const E=this._createAccessibilityTreeNode();this._rowElements.push(E),this._rowContainer.appendChild(E)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(v===0?-1:1),this._rowElements[v===0?1:this._rowElements.length-2].focus(),f.preventDefault(),f.stopImmediatePropagation()}_handleResize(f){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let v=this._rowContainer.children.length;v<this._terminal.rows;v++)this._rowElements[v]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[v]);for(;this._rowElements.length>f;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const f=document.createElement("div");return f.setAttribute("role","listitem"),f.tabIndex=-1,this._refreshRowDimensions(f),f}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let f=0;f<this._terminal.rows;f++)this._refreshRowDimensions(this._rowElements[f])}}_refreshRowDimensions(f){f.style.height=`${this._renderService.dimensions.css.cell.height}px`}};n.AccessibilityManager=l=u([p(1,o.IRenderService)],l)},3614:(_,n)=>{function a(g){return g.replace(/\r?\n/g,"\r")}function u(g,S){return S?"\x1B[200~"+g+"\x1B[201~":g}function p(g,S,w,m){g=u(g=a(g),w.decPrivateModes.bracketedPasteMode&&m.rawOptions.ignoreBracketedPasteMode!==!0),w.triggerDataEvent(g,!0),S.value=""}function c(g,S,w){const m=w.getBoundingClientRect(),o=g.clientX-m.left-10,h=g.clientY-m.top-10;S.style.width="20px",S.style.height="20px",S.style.left=`${o}px`,S.style.top=`${h}px`,S.style.zIndex="1000",S.focus()}Object.defineProperty(n,"__esModule",{value:!0}),n.rightClickHandler=n.moveTextAreaUnderMouseCursor=n.paste=n.handlePasteEvent=n.copyHandler=n.bracketTextForPaste=n.prepareTextForTerminal=void 0,n.prepareTextForTerminal=a,n.bracketTextForPaste=u,n.copyHandler=function(g,S){g.clipboardData&&g.clipboardData.setData("text/plain",S.selectionText),g.preventDefault()},n.handlePasteEvent=function(g,S,w,m){g.stopPropagation(),g.clipboardData&&p(g.clipboardData.getData("text/plain"),S,w,m)},n.paste=p,n.moveTextAreaUnderMouseCursor=c,n.rightClickHandler=function(g,S,w,m,o){c(g,S,w),o&&m.rightClickSelect(g),S.value=m.selectionText,S.select()}},7239:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorContrastCache=void 0;const u=a(1505);n.ColorContrastCache=class{constructor(){this._color=new u.TwoKeyMap,this._css=new u.TwoKeyMap}setCss(p,c,g){this._css.set(p,c,g)}getCss(p,c){return this._css.get(p,c)}setColor(p,c,g){this._color.set(p,c,g)}getColor(p,c){return this._color.get(p,c)}clear(){this._color.clear(),this._css.clear()}}},3656:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.addDisposableDomListener=void 0,n.addDisposableDomListener=function(a,u,p,c){a.addEventListener(u,p,c);let g=!1;return{dispose:()=>{g||(g=!0,a.removeEventListener(u,p,c))}}}},6465:function(_,n,a){var u=this&&this.__decorate||function(o,h,l,f){var v,b=arguments.length,C=b<3?h:f===null?f=Object.getOwnPropertyDescriptor(h,l):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(o,h,l,f);else for(var M=o.length-1;M>=0;M--)(v=o[M])&&(C=(b<3?v(C):b>3?v(h,l,C):v(h,l))||C);return b>3&&C&&Object.defineProperty(h,l,C),C},p=this&&this.__param||function(o,h){return function(l,f){h(l,f,o)}};Object.defineProperty(n,"__esModule",{value:!0}),n.Linkifier2=void 0;const c=a(3656),g=a(8460),S=a(844),w=a(2585);let m=n.Linkifier2=class extends S.Disposable{get currentLink(){return this._currentLink}constructor(o){super(),this._bufferService=o,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new g.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new g.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,S.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,S.toDisposable)(()=>{this._lastMouseEvent=void 0})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0}))}registerLinkProvider(o){return this._linkProviders.push(o),{dispose:()=>{const h=this._linkProviders.indexOf(o);h!==-1&&this._linkProviders.splice(h,1)}}}attachToDom(o,h,l){this._element=o,this._mouseService=h,this._renderService=l,this.register((0,c.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,c.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,c.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,c.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(o){if(this._lastMouseEvent=o,!this._element||!this._mouseService)return;const h=this._positionFromMouseEvent(o,this._element,this._mouseService);if(!h)return;this._isMouseOut=!1;const l=o.composedPath();for(let f=0;f<l.length;f++){const v=l[f];if(v.classList.contains("xterm"))break;if(v.classList.contains("xterm-hover"))return}this._lastBufferCell&&h.x===this._lastBufferCell.x&&h.y===this._lastBufferCell.y||(this._handleHover(h),this._lastBufferCell=h)}_handleHover(o){if(this._activeLine!==o.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(o,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,o)||(this._clearCurrentLink(),this._askForLink(o,!0))}_askForLink(o,h){var l,f;this._activeProviderReplies&&h||((l=this._activeProviderReplies)===null||l===void 0||l.forEach(b=>{b==null||b.forEach(C=>{C.link.dispose&&C.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=o.y);let v=!1;for(const[b,C]of this._linkProviders.entries())h?!((f=this._activeProviderReplies)===null||f===void 0)&&f.get(b)&&(v=this._checkLinkProviderResult(b,o,v)):C.provideLinks(o.y,M=>{var y,E;if(this._isMouseOut)return;const B=M==null?void 0:M.map(T=>({link:T}));(y=this._activeProviderReplies)===null||y===void 0||y.set(b,B),v=this._checkLinkProviderResult(b,o,v),((E=this._activeProviderReplies)===null||E===void 0?void 0:E.size)===this._linkProviders.length&&this._removeIntersectingLinks(o.y,this._activeProviderReplies)})}_removeIntersectingLinks(o,h){const l=new Set;for(let f=0;f<h.size;f++){const v=h.get(f);if(v)for(let b=0;b<v.length;b++){const C=v[b],M=C.link.range.start.y<o?0:C.link.range.start.x,y=C.link.range.end.y>o?this._bufferService.cols:C.link.range.end.x;for(let E=M;E<=y;E++){if(l.has(E)){v.splice(b--,1);break}l.add(E)}}}}_checkLinkProviderResult(o,h,l){var f;if(!this._activeProviderReplies)return l;const v=this._activeProviderReplies.get(o);let b=!1;for(let C=0;C<o;C++)this._activeProviderReplies.has(C)&&!this._activeProviderReplies.get(C)||(b=!0);if(!b&&v){const C=v.find(M=>this._linkAtPosition(M.link,h));C&&(l=!0,this._handleNewLink(C))}if(this._activeProviderReplies.size===this._linkProviders.length&&!l)for(let C=0;C<this._activeProviderReplies.size;C++){const M=(f=this._activeProviderReplies.get(C))===null||f===void 0?void 0:f.find(y=>this._linkAtPosition(y.link,h));if(M){l=!0,this._handleNewLink(M);break}}return l}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(o){if(!this._element||!this._mouseService||!this._currentLink)return;const h=this._positionFromMouseEvent(o,this._element,this._mouseService);h&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,h)&&this._currentLink.link.activate(o,this._currentLink.link.text)}_clearCurrentLink(o,h){this._element&&this._currentLink&&this._lastMouseEvent&&(!o||!h||this._currentLink.link.range.start.y>=o&&this._currentLink.link.range.end.y<=h)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,S.disposeArray)(this._linkCacheDisposables))}_handleNewLink(o){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const h=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);h&&this._linkAtPosition(o.link,h)&&(this._currentLink=o,this._currentLink.state={decorations:{underline:o.link.decorations===void 0||o.link.decorations.underline,pointerCursor:o.link.decorations===void 0||o.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,o.link,this._lastMouseEvent),o.link.decorations={},Object.defineProperties(o.link.decorations,{pointerCursor:{get:()=>{var l,f;return(f=(l=this._currentLink)===null||l===void 0?void 0:l.state)===null||f===void 0?void 0:f.decorations.pointerCursor},set:l=>{var f,v;!((f=this._currentLink)===null||f===void 0)&&f.state&&this._currentLink.state.decorations.pointerCursor!==l&&(this._currentLink.state.decorations.pointerCursor=l,this._currentLink.state.isHovered&&((v=this._element)===null||v===void 0||v.classList.toggle("xterm-cursor-pointer",l)))}},underline:{get:()=>{var l,f;return(f=(l=this._currentLink)===null||l===void 0?void 0:l.state)===null||f===void 0?void 0:f.decorations.underline},set:l=>{var f,v,b;!((f=this._currentLink)===null||f===void 0)&&f.state&&((b=(v=this._currentLink)===null||v===void 0?void 0:v.state)===null||b===void 0?void 0:b.decorations.underline)!==l&&(this._currentLink.state.decorations.underline=l,this._currentLink.state.isHovered&&this._fireUnderlineEvent(o.link,l))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(l=>{if(!this._currentLink)return;const f=l.start===0?0:l.start+1+this._bufferService.buffer.ydisp,v=this._bufferService.buffer.ydisp+1+l.end;if(this._currentLink.link.range.start.y>=f&&this._currentLink.link.range.end.y<=v&&(this._clearCurrentLink(f,v),this._lastMouseEvent&&this._element)){const b=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);b&&this._askForLink(b,!1)}})))}_linkHover(o,h,l){var f;!((f=this._currentLink)===null||f===void 0)&&f.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(h,!0),this._currentLink.state.decorations.pointerCursor&&o.classList.add("xterm-cursor-pointer")),h.hover&&h.hover(l,h.text)}_fireUnderlineEvent(o,h){const l=o.range,f=this._bufferService.buffer.ydisp,v=this._createLinkUnderlineEvent(l.start.x-1,l.start.y-f-1,l.end.x,l.end.y-f-1,void 0);(h?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(v)}_linkLeave(o,h,l){var f;!((f=this._currentLink)===null||f===void 0)&&f.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(h,!1),this._currentLink.state.decorations.pointerCursor&&o.classList.remove("xterm-cursor-pointer")),h.leave&&h.leave(l,h.text)}_linkAtPosition(o,h){const l=o.range.start.y*this._bufferService.cols+o.range.start.x,f=o.range.end.y*this._bufferService.cols+o.range.end.x,v=h.y*this._bufferService.cols+h.x;return l<=v&&v<=f}_positionFromMouseEvent(o,h,l){const f=l.getCoords(o,h,this._bufferService.cols,this._bufferService.rows);if(f)return{x:f[0],y:f[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(o,h,l,f,v){return{x1:o,y1:h,x2:l,y2:f,cols:this._bufferService.cols,fg:v}}};n.Linkifier2=m=u([p(0,w.IBufferService)],m)},9042:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.tooMuchOutput=n.promptLabel=void 0,n.promptLabel="Terminal input",n.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(_,n,a){var u=this&&this.__decorate||function(m,o,h,l){var f,v=arguments.length,b=v<3?o:l===null?l=Object.getOwnPropertyDescriptor(o,h):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(m,o,h,l);else for(var C=m.length-1;C>=0;C--)(f=m[C])&&(b=(v<3?f(b):v>3?f(o,h,b):f(o,h))||b);return v>3&&b&&Object.defineProperty(o,h,b),b},p=this&&this.__param||function(m,o){return function(h,l){o(h,l,m)}};Object.defineProperty(n,"__esModule",{value:!0}),n.OscLinkProvider=void 0;const c=a(511),g=a(2585);let S=n.OscLinkProvider=class{constructor(m,o,h){this._bufferService=m,this._optionsService=o,this._oscLinkService=h}provideLinks(m,o){var h;const l=this._bufferService.buffer.lines.get(m-1);if(!l)return void o(void 0);const f=[],v=this._optionsService.rawOptions.linkHandler,b=new c.CellData,C=l.getTrimmedLength();let M=-1,y=-1,E=!1;for(let B=0;B<C;B++)if(y!==-1||l.hasContent(B)){if(l.loadCell(B,b),b.hasExtendedAttrs()&&b.extended.urlId){if(y===-1){y=B,M=b.extended.urlId;continue}E=b.extended.urlId!==M}else y!==-1&&(E=!0);if(E||y!==-1&&B===C-1){const T=(h=this._oscLinkService.getLinkData(M))===null||h===void 0?void 0:h.uri;if(T){const R={start:{x:y+1,y:m},end:{x:B+(E||B!==C-1?0:1),y:m}};let D=!1;if(!(v!=null&&v.allowNonHttpProtocols))try{const I=new URL(T);["http:","https:"].includes(I.protocol)||(D=!0)}catch{D=!0}D||f.push({text:T,range:R,activate:(I,F)=>v?v.activate(I,F,R):w(0,F),hover:(I,F)=>{var W;return(W=v==null?void 0:v.hover)===null||W===void 0?void 0:W.call(v,I,F,R)},leave:(I,F)=>{var W;return(W=v==null?void 0:v.leave)===null||W===void 0?void 0:W.call(v,I,F,R)}})}E=!1,b.hasExtendedAttrs()&&b.extended.urlId?(y=B,M=b.extended.urlId):(y=-1,M=-1)}}o(f)}};function w(m,o){if(confirm(`Do you want to navigate to ${o}?

WARNING: This link could potentially be dangerous`)){const h=window.open();if(h){try{h.opener=null}catch{}h.location.href=o}else console.warn("Opening link blocked as opener could not be cleared")}}n.OscLinkProvider=S=u([p(0,g.IBufferService),p(1,g.IOptionsService),p(2,g.IOscLinkService)],S)},6193:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.RenderDebouncer=void 0,n.RenderDebouncer=class{constructor(a,u){this._parentWindow=a,this._renderCallback=u,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(a){return this._refreshCallbacks.push(a),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(a,u,p){this._rowCount=p,a=a!==void 0?a:0,u=u!==void 0?u:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,a):a,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,u):u,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const a=Math.max(this._rowStart,0),u=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(a,u),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const a of this._refreshCallbacks)a(0);this._refreshCallbacks=[]}}},5596:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ScreenDprMonitor=void 0;const u=a(844);class p extends u.Disposable{constructor(g){super(),this._parentWindow=g,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,u.toDisposable)(()=>{this.clearListener()}))}setListener(g){this._listener&&this.clearListener(),this._listener=g,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var g;this._outerListener&&((g=this._resolutionMediaMatchList)===null||g===void 0||g.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}n.ScreenDprMonitor=p},3236:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Terminal=void 0;const u=a(3614),p=a(3656),c=a(6465),g=a(9042),S=a(3730),w=a(1680),m=a(3107),o=a(5744),h=a(2950),l=a(1296),f=a(428),v=a(4269),b=a(5114),C=a(8934),M=a(3230),y=a(9312),E=a(4725),B=a(6731),T=a(8055),R=a(8969),D=a(8460),I=a(844),F=a(6114),W=a(8437),H=a(2584),x=a(7399),L=a(5941),A=a(9074),P=a(2585),$=a(5435),V=a(4567),G=typeof window<"u"?window.document:null;class K extends R.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(k={}){super(k),this.browser=F,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new I.MutableDisposable),this._onCursorMove=this.register(new D.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new D.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new D.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new D.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new D.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new D.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new D.EventEmitter),this._onBlur=this.register(new D.EventEmitter),this._onA11yCharEmitter=this.register(new D.EventEmitter),this._onA11yTabEmitter=this.register(new D.EventEmitter),this._onWillOpen=this.register(new D.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(c.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(S.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(A.DecorationService),this._instantiationService.setService(P.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((O,z)=>this.refresh(O,z))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(O=>this._reportWindowsOptions(O))),this.register(this._inputHandler.onColor(O=>this._handleColorEvent(O))),this.register((0,D.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,D.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,D.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,D.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(O=>this._afterResize(O.cols,O.rows))),this.register((0,I.toDisposable)(()=>{var O,z;this._customKeyEventHandler=void 0,(z=(O=this.element)===null||O===void 0?void 0:O.parentNode)===null||z===void 0||z.removeChild(this.element)}))}_handleColorEvent(k){if(this._themeService)for(const O of k){let z,N="";switch(O.index){case 256:z="foreground",N="10";break;case 257:z="background",N="11";break;case 258:z="cursor",N="12";break;default:z="ansi",N="4;"+O.index}switch(O.type){case 0:const q=T.color.toColorRGB(z==="ansi"?this._themeService.colors.ansi[O.index]:this._themeService.colors[z]);this.coreService.triggerDataEvent(`${H.C0.ESC}]${N};${(0,L.toRgbString)(q)}${H.C1_ESCAPED.ST}`);break;case 1:if(z==="ansi")this._themeService.modifyColors(U=>U.ansi[O.index]=T.rgba.toColor(...O.color));else{const U=z;this._themeService.modifyColors(tt=>tt[U]=T.rgba.toColor(...O.color))}break;case 2:this._themeService.restoreColor(O.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(k){k?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(V.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(k){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(H.C0.ESC+"[I"),this.updateCursorStyle(k),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var k;return(k=this.textarea)===null||k===void 0?void 0:k.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(H.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const k=this.buffer.ybase+this.buffer.y,O=this.buffer.lines.get(k);if(!O)return;const z=Math.min(this.buffer.x,this.cols-1),N=this._renderService.dimensions.css.cell.height,q=O.getWidth(z),U=this._renderService.dimensions.css.cell.width*q,tt=this.buffer.y*this._renderService.dimensions.css.cell.height,ot=z*this._renderService.dimensions.css.cell.width;this.textarea.style.left=ot+"px",this.textarea.style.top=tt+"px",this.textarea.style.width=U+"px",this.textarea.style.height=N+"px",this.textarea.style.lineHeight=N+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,p.addDisposableDomListener)(this.element,"copy",O=>{this.hasSelection()&&(0,u.copyHandler)(O,this._selectionService)}));const k=O=>(0,u.handlePasteEvent)(O,this.textarea,this.coreService,this.optionsService);this.register((0,p.addDisposableDomListener)(this.textarea,"paste",k)),this.register((0,p.addDisposableDomListener)(this.element,"paste",k)),F.isFirefox?this.register((0,p.addDisposableDomListener)(this.element,"mousedown",O=>{O.button===2&&(0,u.rightClickHandler)(O,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,p.addDisposableDomListener)(this.element,"contextmenu",O=>{(0,u.rightClickHandler)(O,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),F.isLinux&&this.register((0,p.addDisposableDomListener)(this.element,"auxclick",O=>{O.button===1&&(0,u.moveTextAreaUnderMouseCursor)(O,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,p.addDisposableDomListener)(this.textarea,"keyup",k=>this._keyUp(k),!0)),this.register((0,p.addDisposableDomListener)(this.textarea,"keydown",k=>this._keyDown(k),!0)),this.register((0,p.addDisposableDomListener)(this.textarea,"keypress",k=>this._keyPress(k),!0)),this.register((0,p.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,p.addDisposableDomListener)(this.textarea,"compositionupdate",k=>this._compositionHelper.compositionupdate(k))),this.register((0,p.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,p.addDisposableDomListener)(this.textarea,"input",k=>this._inputEvent(k),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(k){var O;if(!k)throw new Error("Terminal requires a parent element.");k.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=k.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),k.appendChild(this.element);const z=G.createDocumentFragment();this._viewportElement=G.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),z.appendChild(this._viewportElement),this._viewportScrollArea=G.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=G.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=G.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),z.appendChild(this.screenElement),this.textarea=G.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",g.promptLabel),F.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(b.CoreBrowserService,this.textarea,(O=this._document.defaultView)!==null&&O!==void 0?O:window),this._instantiationService.setService(E.ICoreBrowserService,this._coreBrowserService),this.register((0,p.addDisposableDomListener)(this.textarea,"focus",N=>this._handleTextAreaFocus(N))),this.register((0,p.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(f.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(E.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(B.ThemeService),this._instantiationService.setService(E.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(v.CharacterJoinerService),this._instantiationService.setService(E.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(M.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(E.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(N=>this._onRender.fire(N))),this.onResize(N=>this._renderService.resize(N.cols,N.rows)),this._compositionView=G.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(h.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(z);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(C.MouseService),this._instantiationService.setService(E.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(w.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(N=>this.scrollLines(N.amount,N.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(y.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(E.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(N=>this.scrollLines(N.amount,N.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(N=>this._renderService.handleSelectionChanged(N.start,N.end,N.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(N=>{this.textarea.value=N,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(N=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,p.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(m.BufferDecorationRenderer,this.screenElement)),this.register((0,p.addDisposableDomListener)(this.element,"mousedown",N=>this._selectionService.handleMouseDown(N))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(V.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",N=>this._handleScreenReaderModeOptionChange(N))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(o.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",N=>{!this._overviewRulerRenderer&&N&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(o.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(l.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const k=this,O=this.element;function z(U){const tt=k._mouseService.getMouseReportCoords(U,k.screenElement);if(!tt)return!1;let ot,ht;switch(U.overrideType||U.type){case"mousemove":ht=32,U.buttons===void 0?(ot=3,U.button!==void 0&&(ot=U.button<3?U.button:3)):ot=1&U.buttons?0:4&U.buttons?1:2&U.buttons?2:3;break;case"mouseup":ht=0,ot=U.button<3?U.button:3;break;case"mousedown":ht=1,ot=U.button<3?U.button:3;break;case"wheel":if(k.viewport.getLinesScrolled(U)===0)return!1;ht=U.deltaY<0?0:1,ot=4;break;default:return!1}return!(ht===void 0||ot===void 0||ot>4)&&k.coreMouseService.triggerMouseEvent({col:tt.col,row:tt.row,x:tt.x,y:tt.y,button:ot,action:ht,ctrl:U.ctrlKey,alt:U.altKey,shift:U.shiftKey})}const N={mouseup:null,wheel:null,mousedrag:null,mousemove:null},q={mouseup:U=>(z(U),U.buttons||(this._document.removeEventListener("mouseup",N.mouseup),N.mousedrag&&this._document.removeEventListener("mousemove",N.mousedrag)),this.cancel(U)),wheel:U=>(z(U),this.cancel(U,!0)),mousedrag:U=>{U.buttons&&z(U)},mousemove:U=>{U.buttons||z(U)}};this.register(this.coreMouseService.onProtocolChange(U=>{U?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(U)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&U?N.mousemove||(O.addEventListener("mousemove",q.mousemove),N.mousemove=q.mousemove):(O.removeEventListener("mousemove",N.mousemove),N.mousemove=null),16&U?N.wheel||(O.addEventListener("wheel",q.wheel,{passive:!1}),N.wheel=q.wheel):(O.removeEventListener("wheel",N.wheel),N.wheel=null),2&U?N.mouseup||(O.addEventListener("mouseup",q.mouseup),N.mouseup=q.mouseup):(this._document.removeEventListener("mouseup",N.mouseup),O.removeEventListener("mouseup",N.mouseup),N.mouseup=null),4&U?N.mousedrag||(N.mousedrag=q.mousedrag):(this._document.removeEventListener("mousemove",N.mousedrag),N.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,p.addDisposableDomListener)(O,"mousedown",U=>{if(U.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(U))return z(U),N.mouseup&&this._document.addEventListener("mouseup",N.mouseup),N.mousedrag&&this._document.addEventListener("mousemove",N.mousedrag),this.cancel(U)})),this.register((0,p.addDisposableDomListener)(O,"wheel",U=>{if(!N.wheel){if(!this.buffer.hasScrollback){const tt=this.viewport.getLinesScrolled(U);if(tt===0)return;const ot=H.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(U.deltaY<0?"A":"B");let ht="";for(let bt=0;bt<Math.abs(tt);bt++)ht+=ot;return this.coreService.triggerDataEvent(ht,!0),this.cancel(U,!0)}return this.viewport.handleWheel(U)?this.cancel(U):void 0}},{passive:!1})),this.register((0,p.addDisposableDomListener)(O,"touchstart",U=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(U),this.cancel(U)},{passive:!0})),this.register((0,p.addDisposableDomListener)(O,"touchmove",U=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(U)?void 0:this.cancel(U)},{passive:!1}))}refresh(k,O){var z;(z=this._renderService)===null||z===void 0||z.refreshRows(k,O)}updateCursorStyle(k){var O;!((O=this._selectionService)===null||O===void 0)&&O.shouldColumnSelect(k)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(k,O,z=0){var N;z===1?(super.scrollLines(k,O,z),this.refresh(0,this.rows-1)):(N=this.viewport)===null||N===void 0||N.scrollLines(k)}paste(k){(0,u.paste)(k,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(k){this._customKeyEventHandler=k}registerLinkProvider(k){return this.linkifier2.registerLinkProvider(k)}registerCharacterJoiner(k){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const O=this._characterJoinerService.register(k);return this.refresh(0,this.rows-1),O}deregisterCharacterJoiner(k){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(k)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(k){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+k)}registerDecoration(k){return this._decorationService.registerDecoration(k)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(k,O,z){this._selectionService.setSelection(k,O,z)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var k;(k=this._selectionService)===null||k===void 0||k.clearSelection()}selectAll(){var k;(k=this._selectionService)===null||k===void 0||k.selectAll()}selectLines(k,O){var z;(z=this._selectionService)===null||z===void 0||z.selectLines(k,O)}_keyDown(k){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(k)===!1)return!1;const O=this.browser.isMac&&this.options.macOptionIsMeta&&k.altKey;if(!O&&!this._compositionHelper.keydown(k))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;O||k.key!=="Dead"&&k.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const z=(0,x.evaluateKeyboardEvent)(k,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(k),z.type===3||z.type===2){const N=this.rows-1;return this.scrollLines(z.type===2?-N:N),this.cancel(k,!0)}return z.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,k)||(z.cancel&&this.cancel(k,!0),!z.key||!!(k.key&&!k.ctrlKey&&!k.altKey&&!k.metaKey&&k.key.length===1&&k.key.charCodeAt(0)>=65&&k.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(z.key!==H.C0.ETX&&z.key!==H.C0.CR||(this.textarea.value=""),this._onKey.fire({key:z.key,domEvent:k}),this._showCursor(),this.coreService.triggerDataEvent(z.key,!0),!this.optionsService.rawOptions.screenReaderMode||k.altKey||k.ctrlKey?this.cancel(k,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(k,O){const z=k.isMac&&!this.options.macOptionIsMeta&&O.altKey&&!O.ctrlKey&&!O.metaKey||k.isWindows&&O.altKey&&O.ctrlKey&&!O.metaKey||k.isWindows&&O.getModifierState("AltGraph");return O.type==="keypress"?z:z&&(!O.keyCode||O.keyCode>47)}_keyUp(k){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(k)===!1||(function(O){return O.keyCode===16||O.keyCode===17||O.keyCode===18}(k)||this.focus(),this.updateCursorStyle(k),this._keyPressHandled=!1)}_keyPress(k){let O;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(k)===!1)return!1;if(this.cancel(k),k.charCode)O=k.charCode;else if(k.which===null||k.which===void 0)O=k.keyCode;else{if(k.which===0||k.charCode===0)return!1;O=k.which}return!(!O||(k.altKey||k.ctrlKey||k.metaKey)&&!this._isThirdLevelShift(this.browser,k)||(O=String.fromCharCode(O),this._onKey.fire({key:O,domEvent:k}),this._showCursor(),this.coreService.triggerDataEvent(O,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(k){if(k.data&&k.inputType==="insertText"&&(!k.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const O=k.data;return this.coreService.triggerDataEvent(O,!0),this.cancel(k),!0}return!1}resize(k,O){k!==this.cols||O!==this.rows?super.resize(k,O):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(k,O){var z,N;(z=this._charSizeService)===null||z===void 0||z.measure(),(N=this.viewport)===null||N===void 0||N.syncScrollArea(!0)}clear(){var k;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let O=1;O<this.rows;O++)this.buffer.lines.push(this.buffer.getBlankLine(W.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(k=this.viewport)===null||k===void 0||k.reset(),this.refresh(0,this.rows-1)}}reset(){var k,O;this.options.rows=this.rows,this.options.cols=this.cols;const z=this._customKeyEventHandler;this._setup(),super.reset(),(k=this._selectionService)===null||k===void 0||k.reset(),this._decorationService.reset(),(O=this.viewport)===null||O===void 0||O.reset(),this._customKeyEventHandler=z,this.refresh(0,this.rows-1)}clearTextureAtlas(){var k;(k=this._renderService)===null||k===void 0||k.clearTextureAtlas()}_reportFocus(){var k;!((k=this.element)===null||k===void 0)&&k.classList.contains("focus")?this.coreService.triggerDataEvent(H.C0.ESC+"[I"):this.coreService.triggerDataEvent(H.C0.ESC+"[O")}_reportWindowsOptions(k){if(this._renderService)switch(k){case $.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const O=this._renderService.dimensions.css.canvas.width.toFixed(0),z=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${H.C0.ESC}[4;${z};${O}t`);break;case $.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const N=this._renderService.dimensions.css.cell.width.toFixed(0),q=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${H.C0.ESC}[6;${q};${N}t`)}}cancel(k,O){if(this.options.cancelEvents||O)return k.preventDefault(),k.stopPropagation(),!1}}n.Terminal=K},9924:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TimeBasedDebouncer=void 0,n.TimeBasedDebouncer=class{constructor(a,u=1e3){this._renderCallback=a,this._debounceThresholdMS=u,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(a,u,p){this._rowCount=p,a=a!==void 0?a:0,u=u!==void 0?u:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,a):a,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,u):u;const c=Date.now();if(c-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=c,this._innerRefresh();else if(!this._additionalRefreshRequested){const g=c-this._lastRefreshMs,S=this._debounceThresholdMS-g;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},S)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const a=Math.max(this._rowStart,0),u=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(a,u)}}},1680:function(_,n,a){var u=this&&this.__decorate||function(h,l,f,v){var b,C=arguments.length,M=C<3?l:v===null?v=Object.getOwnPropertyDescriptor(l,f):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(h,l,f,v);else for(var y=h.length-1;y>=0;y--)(b=h[y])&&(M=(C<3?b(M):C>3?b(l,f,M):b(l,f))||M);return C>3&&M&&Object.defineProperty(l,f,M),M},p=this&&this.__param||function(h,l){return function(f,v){l(f,v,h)}};Object.defineProperty(n,"__esModule",{value:!0}),n.Viewport=void 0;const c=a(3656),g=a(4725),S=a(8460),w=a(844),m=a(2585);let o=n.Viewport=class extends w.Disposable{constructor(h,l,f,v,b,C,M,y){super(),this._viewportElement=h,this._scrollArea=l,this._bufferService=f,this._optionsService=v,this._charSizeService=b,this._renderService=C,this._coreBrowserService=M,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new S.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,c.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(E=>this._activeBuffer=E.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(E=>this._renderDimensions=E)),this._handleThemeChange(y.colors),this.register(y.onChangeColors(E=>this._handleThemeChange(E))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(h){this._viewportElement.style.backgroundColor=h.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(h){if(h)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const l=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==l&&(this._lastRecordedBufferHeight=l,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const h=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==h&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=h),this._refreshAnimationFrame=null}syncScrollArea(h=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(h);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(h)}_handleScroll(h){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const l=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:l,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const h=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(h*(this._smoothScrollState.target-this._smoothScrollState.origin)),h<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(h,l){const f=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(l<0&&this._viewportElement.scrollTop!==0||l>0&&f<this._lastRecordedBufferHeight)||(h.cancelable&&h.preventDefault(),!1)}handleWheel(h){const l=this._getPixelsScrolled(h);return l!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+l:this._smoothScrollState.target+=l,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=l,this._bubbleScroll(h,l))}scrollLines(h){if(h!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const l=h*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+l,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:h,suppressScrollEvent:!1})}_getPixelsScrolled(h){if(h.deltaY===0||h.shiftKey)return 0;let l=this._applyScrollModifier(h.deltaY,h);return h.deltaMode===WheelEvent.DOM_DELTA_LINE?l*=this._currentRowHeight:h.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(l*=this._currentRowHeight*this._bufferService.rows),l}getBufferElements(h,l){var f;let v,b="";const C=[],M=l??this._bufferService.buffer.lines.length,y=this._bufferService.buffer.lines;for(let E=h;E<M;E++){const B=y.get(E);if(!B)continue;const T=(f=y.get(E+1))===null||f===void 0?void 0:f.isWrapped;if(b+=B.translateToString(!T),!T||E===y.length-1){const R=document.createElement("div");R.textContent=b,C.push(R),b.length>0&&(v=R),b=""}}return{bufferElements:C,cursorElement:v}}getLinesScrolled(h){if(h.deltaY===0||h.shiftKey)return 0;let l=this._applyScrollModifier(h.deltaY,h);return h.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(l/=this._currentRowHeight+0,this._wheelPartialScroll+=l,l=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):h.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(l*=this._bufferService.rows),l}_applyScrollModifier(h,l){const f=this._optionsService.rawOptions.fastScrollModifier;return f==="alt"&&l.altKey||f==="ctrl"&&l.ctrlKey||f==="shift"&&l.shiftKey?h*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:h*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(h){this._lastTouchY=h.touches[0].pageY}handleTouchMove(h){const l=this._lastTouchY-h.touches[0].pageY;return this._lastTouchY=h.touches[0].pageY,l!==0&&(this._viewportElement.scrollTop+=l,this._bubbleScroll(h,l))}};n.Viewport=o=u([p(2,m.IBufferService),p(3,m.IOptionsService),p(4,g.ICharSizeService),p(5,g.IRenderService),p(6,g.ICoreBrowserService),p(7,g.IThemeService)],o)},3107:function(_,n,a){var u=this&&this.__decorate||function(o,h,l,f){var v,b=arguments.length,C=b<3?h:f===null?f=Object.getOwnPropertyDescriptor(h,l):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(o,h,l,f);else for(var M=o.length-1;M>=0;M--)(v=o[M])&&(C=(b<3?v(C):b>3?v(h,l,C):v(h,l))||C);return b>3&&C&&Object.defineProperty(h,l,C),C},p=this&&this.__param||function(o,h){return function(l,f){h(l,f,o)}};Object.defineProperty(n,"__esModule",{value:!0}),n.BufferDecorationRenderer=void 0;const c=a(3656),g=a(4725),S=a(844),w=a(2585);let m=n.BufferDecorationRenderer=class extends S.Disposable{constructor(o,h,l,f){super(),this._screenElement=o,this._bufferService=h,this._decorationService=l,this._renderService=f,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,c.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(v=>this._removeDecoration(v))),this.register((0,S.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const o of this._decorationService.decorations)this._renderDecoration(o);this._dimensionsChanged=!1}_renderDecoration(o){this._refreshStyle(o),this._dimensionsChanged&&this._refreshXPosition(o)}_createElement(o){var h,l;const f=document.createElement("div");f.classList.add("xterm-decoration"),f.classList.toggle("xterm-decoration-top-layer",((h=o==null?void 0:o.options)===null||h===void 0?void 0:h.layer)==="top"),f.style.width=`${Math.round((o.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,f.style.height=(o.options.height||1)*this._renderService.dimensions.css.cell.height+"px",f.style.top=(o.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",f.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const v=(l=o.options.x)!==null&&l!==void 0?l:0;return v&&v>this._bufferService.cols&&(f.style.display="none"),this._refreshXPosition(o,f),f}_refreshStyle(o){const h=o.marker.line-this._bufferService.buffers.active.ydisp;if(h<0||h>=this._bufferService.rows)o.element&&(o.element.style.display="none",o.onRenderEmitter.fire(o.element));else{let l=this._decorationElements.get(o);l||(l=this._createElement(o),o.element=l,this._decorationElements.set(o,l),this._container.appendChild(l),o.onDispose(()=>{this._decorationElements.delete(o),l.remove()})),l.style.top=h*this._renderService.dimensions.css.cell.height+"px",l.style.display=this._altBufferIsActive?"none":"block",o.onRenderEmitter.fire(l)}}_refreshXPosition(o,h=o.element){var l;if(!h)return;const f=(l=o.options.x)!==null&&l!==void 0?l:0;(o.options.anchor||"left")==="right"?h.style.right=f?f*this._renderService.dimensions.css.cell.width+"px":"":h.style.left=f?f*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(o){var h;(h=this._decorationElements.get(o))===null||h===void 0||h.remove(),this._decorationElements.delete(o),o.dispose()}};n.BufferDecorationRenderer=m=u([p(1,w.IBufferService),p(2,w.IDecorationService),p(3,g.IRenderService)],m)},5871:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorZoneStore=void 0,n.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(a){if(a.options.overviewRulerOptions){for(const u of this._zones)if(u.color===a.options.overviewRulerOptions.color&&u.position===a.options.overviewRulerOptions.position){if(this._lineIntersectsZone(u,a.marker.line))return;if(this._lineAdjacentToZone(u,a.marker.line,a.options.overviewRulerOptions.position))return void this._addLineToZone(u,a.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=a.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=a.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=a.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=a.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:a.options.overviewRulerOptions.color,position:a.options.overviewRulerOptions.position,startBufferLine:a.marker.line,endBufferLine:a.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(a){this._linePadding=a}_lineIntersectsZone(a,u){return u>=a.startBufferLine&&u<=a.endBufferLine}_lineAdjacentToZone(a,u,p){return u>=a.startBufferLine-this._linePadding[p||"full"]&&u<=a.endBufferLine+this._linePadding[p||"full"]}_addLineToZone(a,u){a.startBufferLine=Math.min(a.startBufferLine,u),a.endBufferLine=Math.max(a.endBufferLine,u)}}},5744:function(_,n,a){var u=this&&this.__decorate||function(v,b,C,M){var y,E=arguments.length,B=E<3?b:M===null?M=Object.getOwnPropertyDescriptor(b,C):M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(v,b,C,M);else for(var T=v.length-1;T>=0;T--)(y=v[T])&&(B=(E<3?y(B):E>3?y(b,C,B):y(b,C))||B);return E>3&&B&&Object.defineProperty(b,C,B),B},p=this&&this.__param||function(v,b){return function(C,M){b(C,M,v)}};Object.defineProperty(n,"__esModule",{value:!0}),n.OverviewRulerRenderer=void 0;const c=a(5871),g=a(3656),S=a(4725),w=a(844),m=a(2585),o={full:0,left:0,center:0,right:0},h={full:0,left:0,center:0,right:0},l={full:0,left:0,center:0,right:0};let f=n.OverviewRulerRenderer=class extends w.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(v,b,C,M,y,E,B){var T;super(),this._viewportElement=v,this._screenElement=b,this._bufferService=C,this._decorationService=M,this._renderService=y,this._optionsService=E,this._coreBrowseService=B,this._colorZoneStore=new c.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(T=this._viewportElement.parentElement)===null||T===void 0||T.insertBefore(this._canvas,this._viewportElement);const R=this._canvas.getContext("2d");if(!R)throw new Error("Ctx cannot be null");this._ctx=R,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,w.toDisposable)(()=>{var D;(D=this._canvas)===null||D===void 0||D.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,g.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const v=Math.floor(this._canvas.width/3),b=Math.ceil(this._canvas.width/3);h.full=this._canvas.width,h.left=v,h.center=b,h.right=v,this._refreshDrawHeightConstants(),l.full=0,l.left=0,l.center=h.left,l.right=h.left+h.center}_refreshDrawHeightConstants(){o.full=Math.round(2*this._coreBrowseService.dpr);const v=this._canvas.height/this._bufferService.buffer.lines.length,b=Math.round(Math.max(Math.min(v,12),6)*this._coreBrowseService.dpr);o.left=b,o.center=b,o.right=b}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*o.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*o.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*o.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*o.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const b of this._decorationService.decorations)this._colorZoneStore.addDecoration(b);this._ctx.lineWidth=1;const v=this._colorZoneStore.zones;for(const b of v)b.position!=="full"&&this._renderColorZone(b);for(const b of v)b.position==="full"&&this._renderColorZone(b);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(v){this._ctx.fillStyle=v.color,this._ctx.fillRect(l[v.position||"full"],Math.round((this._canvas.height-1)*(v.startBufferLine/this._bufferService.buffers.active.lines.length)-o[v.position||"full"]/2),h[v.position||"full"],Math.round((this._canvas.height-1)*((v.endBufferLine-v.startBufferLine)/this._bufferService.buffers.active.lines.length)+o[v.position||"full"]))}_queueRefresh(v,b){this._shouldUpdateDimensions=v||this._shouldUpdateDimensions,this._shouldUpdateAnchor=b||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};n.OverviewRulerRenderer=f=u([p(2,m.IBufferService),p(3,m.IDecorationService),p(4,S.IRenderService),p(5,m.IOptionsService),p(6,S.ICoreBrowserService)],f)},2950:function(_,n,a){var u=this&&this.__decorate||function(m,o,h,l){var f,v=arguments.length,b=v<3?o:l===null?l=Object.getOwnPropertyDescriptor(o,h):l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(m,o,h,l);else for(var C=m.length-1;C>=0;C--)(f=m[C])&&(b=(v<3?f(b):v>3?f(o,h,b):f(o,h))||b);return v>3&&b&&Object.defineProperty(o,h,b),b},p=this&&this.__param||function(m,o){return function(h,l){o(h,l,m)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CompositionHelper=void 0;const c=a(4725),g=a(2585),S=a(2584);let w=n.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(m,o,h,l,f,v){this._textarea=m,this._compositionView=o,this._bufferService=h,this._optionsService=l,this._coreService=f,this._renderService=v,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(m){this._compositionView.textContent=m.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(m){if(this._isComposing||this._isSendingComposition){if(m.keyCode===229||m.keyCode===16||m.keyCode===17||m.keyCode===18)return!1;this._finalizeComposition(!1)}return m.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(m){if(this._compositionView.classList.remove("active"),this._isComposing=!1,m){const o={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let h;this._isSendingComposition=!1,o.start+=this._dataAlreadySent.length,h=this._isComposing?this._textarea.value.substring(o.start,o.end):this._textarea.value.substring(o.start),h.length>0&&this._coreService.triggerDataEvent(h,!0)}},0)}else{this._isSendingComposition=!1;const o=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(o,!0)}}_handleAnyTextareaChanges(){const m=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const o=this._textarea.value,h=o.replace(m,"");this._dataAlreadySent=h,o.length>m.length?this._coreService.triggerDataEvent(h,!0):o.length<m.length?this._coreService.triggerDataEvent(`${S.C0.DEL}`,!0):o.length===m.length&&o!==m&&this._coreService.triggerDataEvent(o,!0)}},0)}updateCompositionElements(m){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const o=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),h=this._renderService.dimensions.css.cell.height,l=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,f=o*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=f+"px",this._compositionView.style.top=l+"px",this._compositionView.style.height=h+"px",this._compositionView.style.lineHeight=h+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const v=this._compositionView.getBoundingClientRect();this._textarea.style.left=f+"px",this._textarea.style.top=l+"px",this._textarea.style.width=Math.max(v.width,1)+"px",this._textarea.style.height=Math.max(v.height,1)+"px",this._textarea.style.lineHeight=v.height+"px"}m||setTimeout(()=>this.updateCompositionElements(!0),0)}}};n.CompositionHelper=w=u([p(2,g.IBufferService),p(3,g.IOptionsService),p(4,g.ICoreService),p(5,c.IRenderService)],w)},9806:(_,n)=>{function a(u,p,c){const g=c.getBoundingClientRect(),S=u.getComputedStyle(c),w=parseInt(S.getPropertyValue("padding-left")),m=parseInt(S.getPropertyValue("padding-top"));return[p.clientX-g.left-w,p.clientY-g.top-m]}Object.defineProperty(n,"__esModule",{value:!0}),n.getCoords=n.getCoordsRelativeToElement=void 0,n.getCoordsRelativeToElement=a,n.getCoords=function(u,p,c,g,S,w,m,o,h){if(!w)return;const l=a(u,p,c);return l?(l[0]=Math.ceil((l[0]+(h?m/2:0))/m),l[1]=Math.ceil(l[1]/o),l[0]=Math.min(Math.max(l[0],1),g+(h?1:0)),l[1]=Math.min(Math.max(l[1],1),S),l):void 0}},9504:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.moveToCellSequence=void 0;const u=a(2584);function p(o,h,l,f){const v=o-c(o,l),b=h-c(h,l),C=Math.abs(v-b)-function(M,y,E){let B=0;const T=M-c(M,E),R=y-c(y,E);for(let D=0;D<Math.abs(T-R);D++){const I=g(M,y)==="A"?-1:1,F=E.buffer.lines.get(T+I*D);F!=null&&F.isWrapped&&B++}return B}(o,h,l);return m(C,w(g(o,h),f))}function c(o,h){let l=0,f=h.buffer.lines.get(o),v=f==null?void 0:f.isWrapped;for(;v&&o>=0&&o<h.rows;)l++,f=h.buffer.lines.get(--o),v=f==null?void 0:f.isWrapped;return l}function g(o,h){return o>h?"A":"B"}function S(o,h,l,f,v,b){let C=o,M=h,y="";for(;C!==l||M!==f;)C+=v?1:-1,v&&C>b.cols-1?(y+=b.buffer.translateBufferLineToString(M,!1,o,C),C=0,o=0,M++):!v&&C<0&&(y+=b.buffer.translateBufferLineToString(M,!1,0,o+1),C=b.cols-1,o=C,M--);return y+b.buffer.translateBufferLineToString(M,!1,o,C)}function w(o,h){const l=h?"O":"[";return u.C0.ESC+l+o}function m(o,h){o=Math.floor(o);let l="";for(let f=0;f<o;f++)l+=h;return l}n.moveToCellSequence=function(o,h,l,f){const v=l.buffer.x,b=l.buffer.y;if(!l.buffer.hasScrollback)return function(y,E,B,T,R,D){return p(E,T,R,D).length===0?"":m(S(y,E,y,E-c(E,R),!1,R).length,w("D",D))}(v,b,0,h,l,f)+p(b,h,l,f)+function(y,E,B,T,R,D){let I;I=p(E,T,R,D).length>0?T-c(T,R):E;const F=T,W=function(H,x,L,A,P,$){let V;return V=p(L,A,P,$).length>0?A-c(A,P):x,H<L&&V<=A||H>=L&&V<A?"C":"D"}(y,E,B,T,R,D);return m(S(y,I,B,F,W==="C",R).length,w(W,D))}(v,b,o,h,l,f);let C;if(b===h)return C=v>o?"D":"C",m(Math.abs(v-o),w(C,f));C=b>h?"D":"C";const M=Math.abs(b-h);return m(function(y,E){return E.cols-y}(b>h?o:v,l)+(M-1)*l.cols+1+((b>h?v:o)-1),w(C,f))}},1296:function(_,n,a){var u=this&&this.__decorate||function(R,D,I,F){var W,H=arguments.length,x=H<3?D:F===null?F=Object.getOwnPropertyDescriptor(D,I):F;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(R,D,I,F);else for(var L=R.length-1;L>=0;L--)(W=R[L])&&(x=(H<3?W(x):H>3?W(D,I,x):W(D,I))||x);return H>3&&x&&Object.defineProperty(D,I,x),x},p=this&&this.__param||function(R,D){return function(I,F){D(I,F,R)}};Object.defineProperty(n,"__esModule",{value:!0}),n.DomRenderer=void 0;const c=a(3787),g=a(2550),S=a(2223),w=a(6171),m=a(4725),o=a(8055),h=a(8460),l=a(844),f=a(2585),v="xterm-dom-renderer-owner-",b="xterm-rows",C="xterm-fg-",M="xterm-bg-",y="xterm-focus",E="xterm-selection";let B=1,T=n.DomRenderer=class extends l.Disposable{constructor(R,D,I,F,W,H,x,L,A,P){super(),this._element=R,this._screenElement=D,this._viewportElement=I,this._linkifier2=F,this._charSizeService=H,this._optionsService=x,this._bufferService=L,this._coreBrowserService=A,this._themeService=P,this._terminalClass=B++,this._rowElements=[],this.onRequestRedraw=this.register(new h.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add(b),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add(E),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,w.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors($=>this._injectCss($))),this._injectCss(this._themeService.colors),this._rowFactory=W.createInstance(c.DomRendererRowFactory,document),this._element.classList.add(v+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline($=>this._handleLinkHover($))),this.register(this._linkifier2.onHideLinkUnderline($=>this._handleLinkLeave($))),this.register((0,l.toDisposable)(()=>{this._element.classList.remove(v+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new g.WidthCache(document),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const R=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*R,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*R),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/R),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/R),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const I of this._rowElements)I.style.width=`${this.dimensions.css.canvas.width}px`,I.style.height=`${this.dimensions.css.cell.height}px`,I.style.lineHeight=`${this.dimensions.css.cell.height}px`,I.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const D=`${this._terminalSelector} .${b} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=D,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(R){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let D=`${this._terminalSelector} .${b} { color: ${R.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;D+=`${this._terminalSelector} .${b} .xterm-dim { color: ${o.color.multiplyOpacity(R.foreground,.5).css};}`,D+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`,D+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  border-bottom-style: hidden; }}",D+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${R.cursor.css};  color: ${R.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${R.cursor.css}; }}`,D+=`${this._terminalSelector} .${b}.${y} .xterm-cursor.xterm-cursor-blink:not(.xterm-cursor-block) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${b}.${y} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-block { background-color: ${R.cursor.css}; color: ${R.cursorAccent.css};}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${R.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${R.cursor.css} inset;}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${R.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,D+=`${this._terminalSelector} .${E} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${E} div { position: absolute; background-color: ${R.selectionBackgroundOpaque.css};}${this._terminalSelector} .${E} div { position: absolute; background-color: ${R.selectionInactiveBackgroundOpaque.css};}`;for(const[I,F]of R.ansi.entries())D+=`${this._terminalSelector} .${C}${I} { color: ${F.css}; }${this._terminalSelector} .${C}${I}.xterm-dim { color: ${o.color.multiplyOpacity(F,.5).css}; }${this._terminalSelector} .${M}${I} { background-color: ${F.css}; }`;D+=`${this._terminalSelector} .${C}${S.INVERTED_DEFAULT_COLOR} { color: ${o.color.opaque(R.background).css}; }${this._terminalSelector} .${C}${S.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${o.color.multiplyOpacity(o.color.opaque(R.background),.5).css}; }${this._terminalSelector} .${M}${S.INVERTED_DEFAULT_COLOR} { background-color: ${R.foreground.css}; }`,this._themeStyleElement.textContent=D}_setDefaultSpacing(){const R=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${R}px`,this._rowFactory.defaultSpacing=R}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(R,D){for(let I=this._rowElements.length;I<=D;I++){const F=document.createElement("div");this._rowContainer.appendChild(F),this._rowElements.push(F)}for(;this._rowElements.length>D;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(R,D){this._refreshRowElements(R,D),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(y)}handleFocus(){this._rowContainer.classList.add(y),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(R,D,I){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(R,D,I),this.renderRows(0,this._bufferService.rows-1),!R||!D)return;const F=R[1]-this._bufferService.buffer.ydisp,W=D[1]-this._bufferService.buffer.ydisp,H=Math.max(F,0),x=Math.min(W,this._bufferService.rows-1);if(H>=this._bufferService.rows||x<0)return;const L=document.createDocumentFragment();if(I){const A=R[0]>D[0];L.appendChild(this._createSelectionElement(H,A?D[0]:R[0],A?R[0]:D[0],x-H+1))}else{const A=F===H?R[0]:0,P=H===W?D[0]:this._bufferService.cols;L.appendChild(this._createSelectionElement(H,A,P));const $=x-H-1;if(L.appendChild(this._createSelectionElement(H+1,0,this._bufferService.cols,$)),H!==x){const V=W===x?D[0]:this._bufferService.cols;L.appendChild(this._createSelectionElement(x,0,V))}}this._selectionContainer.appendChild(L)}_createSelectionElement(R,D,I,F=1){const W=document.createElement("div");return W.style.height=F*this.dimensions.css.cell.height+"px",W.style.top=R*this.dimensions.css.cell.height+"px",W.style.left=D*this.dimensions.css.cell.width+"px",W.style.width=this.dimensions.css.cell.width*(I-D)+"px",W}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const R of this._rowElements)R.replaceChildren()}renderRows(R,D){const I=this._bufferService.buffer,F=I.ybase+I.y,W=Math.min(I.x,this._bufferService.cols-1),H=this._optionsService.rawOptions.cursorBlink,x=this._optionsService.rawOptions.cursorStyle,L=this._optionsService.rawOptions.cursorInactiveStyle;for(let A=R;A<=D;A++){const P=A+I.ydisp,$=this._rowElements[A],V=I.lines.get(P);if(!$||!V)break;$.replaceChildren(...this._rowFactory.createRow(V,P,P===F,x,L,W,H,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${v}${this._terminalClass}`}_handleLinkHover(R){this._setCellUnderline(R.x1,R.x2,R.y1,R.y2,R.cols,!0)}_handleLinkLeave(R){this._setCellUnderline(R.x1,R.x2,R.y1,R.y2,R.cols,!1)}_setCellUnderline(R,D,I,F,W,H){I<0&&(R=0),F<0&&(D=0);const x=this._bufferService.rows-1;I=Math.max(Math.min(I,x),0),F=Math.max(Math.min(F,x),0),W=Math.min(W,this._bufferService.cols);const L=this._bufferService.buffer,A=L.ybase+L.y,P=Math.min(L.x,W-1),$=this._optionsService.rawOptions.cursorBlink,V=this._optionsService.rawOptions.cursorStyle,G=this._optionsService.rawOptions.cursorInactiveStyle;for(let K=I;K<=F;++K){const et=K+L.ydisp,k=this._rowElements[K],O=L.lines.get(et);if(!k||!O)break;k.replaceChildren(...this._rowFactory.createRow(O,et,et===A,V,G,P,$,this.dimensions.css.cell.width,this._widthCache,H?K===I?R:0:-1,H?(K===F?D:W)-1:-1))}}};n.DomRenderer=T=u([p(4,f.IInstantiationService),p(5,m.ICharSizeService),p(6,f.IOptionsService),p(7,f.IBufferService),p(8,m.ICoreBrowserService),p(9,m.IThemeService)],T)},3787:function(_,n,a){var u=this&&this.__decorate||function(C,M,y,E){var B,T=arguments.length,R=T<3?M:E===null?E=Object.getOwnPropertyDescriptor(M,y):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(C,M,y,E);else for(var D=C.length-1;D>=0;D--)(B=C[D])&&(R=(T<3?B(R):T>3?B(M,y,R):B(M,y))||R);return T>3&&R&&Object.defineProperty(M,y,R),R},p=this&&this.__param||function(C,M){return function(y,E){M(y,E,C)}};Object.defineProperty(n,"__esModule",{value:!0}),n.DomRendererRowFactory=void 0;const c=a(2223),g=a(643),S=a(511),w=a(2585),m=a(8055),o=a(4725),h=a(4269),l=a(6171),f=a(3734);let v=n.DomRendererRowFactory=class{constructor(C,M,y,E,B,T,R){this._document=C,this._characterJoinerService=M,this._optionsService=y,this._coreBrowserService=E,this._coreService=B,this._decorationService=T,this._themeService=R,this._workCell=new S.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(C,M,y){this._selectionStart=C,this._selectionEnd=M,this._columnSelectMode=y}createRow(C,M,y,E,B,T,R,D,I,F,W){const H=[],x=this._characterJoinerService.getJoinedCharacters(M),L=this._themeService.colors;let A,P=C.getNoBgTrimmedLength();y&&P<T+1&&(P=T+1);let $=0,V="",G=0,K=0,et=0,k=!1,O=0,z=!1,N=0;const q=[],U=F!==-1&&W!==-1;for(let tt=0;tt<P;tt++){C.loadCell(tt,this._workCell);let ot=this._workCell.getWidth();if(ot===0)continue;let ht=!1,bt=tt,Y=this._workCell;if(x.length>0&&tt===x[0][0]){ht=!0;const it=x.shift();Y=new h.JoinedCellData(this._workCell,C.translateToString(!0,it[0],it[1]),it[1]-it[0]),bt=it[1]-1,ot=Y.getWidth()}const wt=this._isCellInSelection(tt,M),Ut=y&&tt===T,_t=U&&tt>=F&&tt<=W;let Lt=!1;this._decorationService.forEachDecorationAtCell(tt,M,void 0,it=>{Lt=!0});let Pt=Y.getChars()||g.WHITESPACE_CELL_CHAR;if(Pt===" "&&(Y.isUnderline()||Y.isOverline())&&(Pt=" "),N=ot*D-I.get(Pt,Y.isBold(),Y.isItalic()),A){if($&&(wt&&z||!wt&&!z&&Y.bg===G)&&(wt&&z&&L.selectionForeground||Y.fg===K)&&Y.extended.ext===et&&_t===k&&N===O&&!Ut&&!ht&&!Lt){V+=Pt,$++;continue}$&&(A.textContent=V),A=this._document.createElement("span"),$=0,V=""}else A=this._document.createElement("span");if(G=Y.bg,K=Y.fg,et=Y.extended.ext,k=_t,O=N,z=wt,ht&&T>=tt&&T<=bt&&(T=tt),!this._coreService.isCursorHidden&&Ut){if(q.push("xterm-cursor"),this._coreBrowserService.isFocused)R&&q.push("xterm-cursor-blink"),q.push(E==="bar"?"xterm-cursor-bar":E==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(B)switch(B){case"outline":q.push("xterm-cursor-outline");break;case"block":q.push("xterm-cursor-block");break;case"bar":q.push("xterm-cursor-bar");break;case"underline":q.push("xterm-cursor-underline")}}if(Y.isBold()&&q.push("xterm-bold"),Y.isItalic()&&q.push("xterm-italic"),Y.isDim()&&q.push("xterm-dim"),V=Y.isInvisible()?g.WHITESPACE_CELL_CHAR:Y.getChars()||g.WHITESPACE_CELL_CHAR,Y.isUnderline()&&(q.push(`xterm-underline-${Y.extended.underlineStyle}`),V===" "&&(V=" "),!Y.isUnderlineColorDefault()))if(Y.isUnderlineColorRGB())A.style.textDecorationColor=`rgb(${f.AttributeData.toColorRGB(Y.getUnderlineColor()).join(",")})`;else{let it=Y.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&Y.isBold()&&it<8&&(it+=8),A.style.textDecorationColor=L.ansi[it].css}Y.isOverline()&&(q.push("xterm-overline"),V===" "&&(V=" ")),Y.isStrikethrough()&&q.push("xterm-strikethrough"),_t&&(A.style.textDecoration="underline");let lt=Y.getFgColor(),Dt=Y.getFgColorMode(),pt=Y.getBgColor(),Ot=Y.getBgColorMode();const It=!!Y.isInverse();if(It){const it=lt;lt=pt,pt=it;const Kt=Dt;Dt=Ot,Ot=Kt}let yt,Vt,Ct,ct=!1;switch(this._decorationService.forEachDecorationAtCell(tt,M,void 0,it=>{it.options.layer!=="top"&&ct||(it.backgroundColorRGB&&(Ot=50331648,pt=it.backgroundColorRGB.rgba>>8&16777215,yt=it.backgroundColorRGB),it.foregroundColorRGB&&(Dt=50331648,lt=it.foregroundColorRGB.rgba>>8&16777215,Vt=it.foregroundColorRGB),ct=it.options.layer==="top")}),!ct&&wt&&(yt=this._coreBrowserService.isFocused?L.selectionBackgroundOpaque:L.selectionInactiveBackgroundOpaque,pt=yt.rgba>>8&16777215,Ot=50331648,ct=!0,L.selectionForeground&&(Dt=50331648,lt=L.selectionForeground.rgba>>8&16777215,Vt=L.selectionForeground)),ct&&q.push("xterm-decoration-top"),Ot){case 16777216:case 33554432:Ct=L.ansi[pt],q.push(`xterm-bg-${pt}`);break;case 50331648:Ct=m.rgba.toColor(pt>>16,pt>>8&255,255&pt),this._addStyle(A,`background-color:#${b((pt>>>0).toString(16),"0",6)}`);break;default:It?(Ct=L.foreground,q.push(`xterm-bg-${c.INVERTED_DEFAULT_COLOR}`)):Ct=L.background}switch(yt||Y.isDim()&&(yt=m.color.multiplyOpacity(Ct,.5)),Dt){case 16777216:case 33554432:Y.isBold()&&lt<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(lt+=8),this._applyMinimumContrast(A,Ct,L.ansi[lt],Y,yt,void 0)||q.push(`xterm-fg-${lt}`);break;case 50331648:const it=m.rgba.toColor(lt>>16&255,lt>>8&255,255&lt);this._applyMinimumContrast(A,Ct,it,Y,yt,Vt)||this._addStyle(A,`color:#${b(lt.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(A,Ct,L.foreground,Y,yt,void 0)||It&&q.push(`xterm-fg-${c.INVERTED_DEFAULT_COLOR}`)}q.length&&(A.className=q.join(" "),q.length=0),Ut||ht||Lt?A.textContent=V:$++,N!==this.defaultSpacing&&(A.style.letterSpacing=`${N}px`),H.push(A),tt=bt}return A&&$&&(A.textContent=V),H}_applyMinimumContrast(C,M,y,E,B,T){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,l.excludeFromContrastRatioDemands)(E.getCode()))return!1;const R=this._getContrastCache(E);let D;if(B||T||(D=R.getColor(M.rgba,y.rgba)),D===void 0){const I=this._optionsService.rawOptions.minimumContrastRatio/(E.isDim()?2:1);D=m.color.ensureContrastRatio(B||M,T||y,I),R.setColor((B||M).rgba,(T||y).rgba,D??null)}return!!D&&(this._addStyle(C,`color:${D.css}`),!0)}_getContrastCache(C){return C.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(C,M){C.setAttribute("style",`${C.getAttribute("style")||""}${M};`)}_isCellInSelection(C,M){const y=this._selectionStart,E=this._selectionEnd;return!(!y||!E)&&(this._columnSelectMode?y[0]<=E[0]?C>=y[0]&&M>=y[1]&&C<E[0]&&M<=E[1]:C<y[0]&&M>=y[1]&&C>=E[0]&&M<=E[1]:M>y[1]&&M<E[1]||y[1]===E[1]&&M===y[1]&&C>=y[0]&&C<E[0]||y[1]<E[1]&&M===E[1]&&C<E[0]||y[1]<E[1]&&M===y[1]&&C>=y[0])}};function b(C,M,y){for(;C.length<y;)C=M+C;return C}n.DomRendererRowFactory=v=u([p(1,o.ICharacterJoinerService),p(2,w.IOptionsService),p(3,o.ICoreBrowserService),p(4,w.ICoreService),p(5,w.IDecorationService),p(6,o.IThemeService)],v)},2550:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WidthCache=void 0,n.WidthCache=class{constructor(a){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=a.createElement("div"),this._container.style.position="absolute",this._container.style.top="-50000px",this._container.style.width="50000px",this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const u=a.createElement("span"),p=a.createElement("span");p.style.fontWeight="bold";const c=a.createElement("span");c.style.fontStyle="italic";const g=a.createElement("span");g.style.fontWeight="bold",g.style.fontStyle="italic",this._measureElements=[u,p,c,g],this._container.appendChild(u),this._container.appendChild(p),this._container.appendChild(c),this._container.appendChild(g),a.body.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(a,u,p,c){a===this._font&&u===this._fontSize&&p===this._weight&&c===this._weightBold||(this._font=a,this._fontSize=u,this._weight=p,this._weightBold=c,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${p}`,this._measureElements[1].style.fontWeight=`${c}`,this._measureElements[2].style.fontWeight=`${p}`,this._measureElements[3].style.fontWeight=`${c}`,this.clear())}get(a,u,p){let c=0;if(!u&&!p&&a.length===1&&(c=a.charCodeAt(0))<256)return this._flat[c]!==-9999?this._flat[c]:this._flat[c]=this._measure(a,0);let g=a;u&&(g+="B"),p&&(g+="I");let S=this._holey.get(g);if(S===void 0){let w=0;u&&(w|=1),p&&(w|=2),S=this._measure(a,w),this._holey.set(g,S)}return S}_measure(a,u){const p=this._measureElements[u];return p.textContent=a.repeat(32),p.offsetWidth/32}}},2223:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TEXT_BASELINE=n.DIM_OPACITY=n.INVERTED_DEFAULT_COLOR=void 0;const u=a(6114);n.INVERTED_DEFAULT_COLOR=257,n.DIM_OPACITY=.5,n.TEXT_BASELINE=u.isFirefox||u.isLegacyEdge?"bottom":"ideographic"},6171:(_,n)=>{function a(u){return 57508<=u&&u<=57558}Object.defineProperty(n,"__esModule",{value:!0}),n.createRenderDimensions=n.excludeFromContrastRatioDemands=n.isRestrictedPowerlineGlyph=n.isPowerlineGlyph=n.throwIfFalsy=void 0,n.throwIfFalsy=function(u){if(!u)throw new Error("value must not be falsy");return u},n.isPowerlineGlyph=a,n.isRestrictedPowerlineGlyph=function(u){return 57520<=u&&u<=57527},n.excludeFromContrastRatioDemands=function(u){return a(u)||function(p){return 9472<=p&&p<=9631}(u)},n.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SelectionModel=void 0,n.SelectionModel=class{constructor(a){this._bufferService=a,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const a=this.selectionStart[0]+this.selectionStartLength;return a>this._bufferService.cols?a%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)-1]:[a%this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)]:[a,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const a=this.selectionStart[0]+this.selectionStartLength;return a>this._bufferService.cols?[a%this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)]:[Math.max(a,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const a=this.selectionStart,u=this.selectionEnd;return!(!a||!u)&&(a[1]>u[1]||a[1]===u[1]&&a[0]>u[0])}handleTrim(a){return this.selectionStart&&(this.selectionStart[1]-=a),this.selectionEnd&&(this.selectionEnd[1]-=a),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(_,n,a){var u=this&&this.__decorate||function(o,h,l,f){var v,b=arguments.length,C=b<3?h:f===null?f=Object.getOwnPropertyDescriptor(h,l):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(o,h,l,f);else for(var M=o.length-1;M>=0;M--)(v=o[M])&&(C=(b<3?v(C):b>3?v(h,l,C):v(h,l))||C);return b>3&&C&&Object.defineProperty(h,l,C),C},p=this&&this.__param||function(o,h){return function(l,f){h(l,f,o)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CharSizeService=void 0;const c=a(2585),g=a(8460),S=a(844);let w=n.CharSizeService=class extends S.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(o,h,l){super(),this._optionsService=l,this.width=0,this.height=0,this._onCharSizeChange=this.register(new g.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new m(o,h,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const o=this._measureStrategy.measure();o.width===this.width&&o.height===this.height||(this.width=o.width,this.height=o.height,this._onCharSizeChange.fire())}};n.CharSizeService=w=u([p(2,c.IOptionsService)],w);class m{constructor(h,l,f){this._document=h,this._parentElement=l,this._optionsService=f,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const h={height:Number(this._measureElement.offsetHeight),width:Number(this._measureElement.offsetWidth)};return h.width!==0&&h.height!==0&&(this._result.width=h.width/32,this._result.height=Math.ceil(h.height)),this._result}}},4269:function(_,n,a){var u=this&&this.__decorate||function(h,l,f,v){var b,C=arguments.length,M=C<3?l:v===null?v=Object.getOwnPropertyDescriptor(l,f):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(h,l,f,v);else for(var y=h.length-1;y>=0;y--)(b=h[y])&&(M=(C<3?b(M):C>3?b(l,f,M):b(l,f))||M);return C>3&&M&&Object.defineProperty(l,f,M),M},p=this&&this.__param||function(h,l){return function(f,v){l(f,v,h)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CharacterJoinerService=n.JoinedCellData=void 0;const c=a(3734),g=a(643),S=a(511),w=a(2585);class m extends c.AttributeData{constructor(l,f,v){super(),this.content=0,this.combinedData="",this.fg=l.fg,this.bg=l.bg,this.combinedData=f,this._width=v}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(l){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}n.JoinedCellData=m;let o=n.CharacterJoinerService=class Gs{constructor(l){this._bufferService=l,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new S.CellData}register(l){const f={id:this._nextCharacterJoinerId++,handler:l};return this._characterJoiners.push(f),f.id}deregister(l){for(let f=0;f<this._characterJoiners.length;f++)if(this._characterJoiners[f].id===l)return this._characterJoiners.splice(f,1),!0;return!1}getJoinedCharacters(l){if(this._characterJoiners.length===0)return[];const f=this._bufferService.buffer.lines.get(l);if(!f||f.length===0)return[];const v=[],b=f.translateToString(!0);let C=0,M=0,y=0,E=f.getFg(0),B=f.getBg(0);for(let T=0;T<f.getTrimmedLength();T++)if(f.loadCell(T,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==E||this._workCell.bg!==B){if(T-C>1){const R=this._getJoinedRanges(b,y,M,f,C);for(let D=0;D<R.length;D++)v.push(R[D])}C=T,y=M,E=this._workCell.fg,B=this._workCell.bg}M+=this._workCell.getChars().length||g.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-C>1){const T=this._getJoinedRanges(b,y,M,f,C);for(let R=0;R<T.length;R++)v.push(T[R])}return v}_getJoinedRanges(l,f,v,b,C){const M=l.substring(f,v);let y=[];try{y=this._characterJoiners[0].handler(M)}catch(E){console.error(E)}for(let E=1;E<this._characterJoiners.length;E++)try{const B=this._characterJoiners[E].handler(M);for(let T=0;T<B.length;T++)Gs._mergeRanges(y,B[T])}catch(B){console.error(B)}return this._stringRangesToCellRanges(y,b,C),y}_stringRangesToCellRanges(l,f,v){let b=0,C=!1,M=0,y=l[b];if(y){for(let E=v;E<this._bufferService.cols;E++){const B=f.getWidth(E),T=f.getString(E).length||g.WHITESPACE_CELL_CHAR.length;if(B!==0){if(!C&&y[0]<=M&&(y[0]=E,C=!0),y[1]<=M){if(y[1]=E,y=l[++b],!y)break;y[0]<=M?(y[0]=E,C=!0):C=!1}M+=T}}y&&(y[1]=this._bufferService.cols)}}static _mergeRanges(l,f){let v=!1;for(let b=0;b<l.length;b++){const C=l[b];if(v){if(f[1]<=C[0])return l[b-1][1]=f[1],l;if(f[1]<=C[1])return l[b-1][1]=Math.max(f[1],C[1]),l.splice(b,1),l;l.splice(b,1),b--}else{if(f[1]<=C[0])return l.splice(b,0,f),l;if(f[1]<=C[1])return C[0]=Math.min(f[0],C[0]),l;f[0]<C[1]&&(C[0]=Math.min(f[0],C[0]),v=!0)}}return v?l[l.length-1][1]=f[1]:l.push(f),l}};n.CharacterJoinerService=o=u([p(0,w.IBufferService)],o)},5114:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CoreBrowserService=void 0,n.CoreBrowserService=class{constructor(a,u){this._textarea=a,this.window=u,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(_,n,a){var u=this&&this.__decorate||function(w,m,o,h){var l,f=arguments.length,v=f<3?m:h===null?h=Object.getOwnPropertyDescriptor(m,o):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(w,m,o,h);else for(var b=w.length-1;b>=0;b--)(l=w[b])&&(v=(f<3?l(v):f>3?l(m,o,v):l(m,o))||v);return f>3&&v&&Object.defineProperty(m,o,v),v},p=this&&this.__param||function(w,m){return function(o,h){m(o,h,w)}};Object.defineProperty(n,"__esModule",{value:!0}),n.MouseService=void 0;const c=a(4725),g=a(9806);let S=n.MouseService=class{constructor(w,m){this._renderService=w,this._charSizeService=m}getCoords(w,m,o,h,l){return(0,g.getCoords)(window,w,m,o,h,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,l)}getMouseReportCoords(w,m){const o=(0,g.getCoordsRelativeToElement)(window,w,m);if(this._charSizeService.hasValidSize)return o[0]=Math.min(Math.max(o[0],0),this._renderService.dimensions.css.canvas.width-1),o[1]=Math.min(Math.max(o[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(o[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(o[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(o[0]),y:Math.floor(o[1])}}};n.MouseService=S=u([p(0,c.IRenderService),p(1,c.ICharSizeService)],S)},3230:function(_,n,a){var u=this&&this.__decorate||function(v,b,C,M){var y,E=arguments.length,B=E<3?b:M===null?M=Object.getOwnPropertyDescriptor(b,C):M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(v,b,C,M);else for(var T=v.length-1;T>=0;T--)(y=v[T])&&(B=(E<3?y(B):E>3?y(b,C,B):y(b,C))||B);return E>3&&B&&Object.defineProperty(b,C,B),B},p=this&&this.__param||function(v,b){return function(C,M){b(C,M,v)}};Object.defineProperty(n,"__esModule",{value:!0}),n.RenderService=void 0;const c=a(3656),g=a(6193),S=a(5596),w=a(4725),m=a(8460),o=a(844),h=a(7226),l=a(2585);let f=n.RenderService=class extends o.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(v,b,C,M,y,E,B,T){if(super(),this._rowCount=v,this._charSizeService=M,this._renderer=this.register(new o.MutableDisposable),this._pausedResizeTask=new h.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new m.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new m.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new m.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new m.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new g.RenderDebouncer(B.window,(R,D)=>this._renderRows(R,D)),this.register(this._renderDebouncer),this._screenDprMonitor=new S.ScreenDprMonitor(B.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(E.onResize(()=>this._fullRefresh())),this.register(E.buffers.onBufferActivate(()=>{var R;return(R=this._renderer.value)===null||R===void 0?void 0:R.clear()})),this.register(C.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(y.onDecorationRegistered(()=>this._fullRefresh())),this.register(y.onDecorationRemoved(()=>this._fullRefresh())),this.register(C.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(E.cols,E.rows),this._fullRefresh()})),this.register(C.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(E.buffer.y,E.buffer.y,!0))),this.register((0,c.addDisposableDomListener)(B.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(T.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in B.window){const R=new B.window.IntersectionObserver(D=>this._handleIntersectionChange(D[D.length-1]),{threshold:0});R.observe(b),this.register({dispose:()=>R.disconnect()})}}_handleIntersectionChange(v){this._isPaused=v.isIntersecting===void 0?v.intersectionRatio===0:!v.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(v,b,C=!1){this._isPaused?this._needsFullRefresh=!0:(C||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(v,b,this._rowCount))}_renderRows(v,b){this._renderer.value&&(v=Math.min(v,this._rowCount-1),b=Math.min(b,this._rowCount-1),this._renderer.value.renderRows(v,b),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:v,end:b}),this._onRender.fire({start:v,end:b}),this._isNextRenderRedrawOnly=!0)}resize(v,b){this._rowCount=b,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(v){this._renderer.value=v,this._renderer.value.onRequestRedraw(b=>this.refreshRows(b.start,b.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(v){return this._renderDebouncer.addRefreshCallback(v)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var v,b;this._renderer.value&&((b=(v=this._renderer.value).clearTextureAtlas)===null||b===void 0||b.call(v),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(v,b){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value.handleResize(v,b)):this._renderer.value.handleResize(v,b),this._fullRefresh())}handleCharSizeChanged(){var v;(v=this._renderer.value)===null||v===void 0||v.handleCharSizeChanged()}handleBlur(){var v;(v=this._renderer.value)===null||v===void 0||v.handleBlur()}handleFocus(){var v;(v=this._renderer.value)===null||v===void 0||v.handleFocus()}handleSelectionChanged(v,b,C){var M;this._selectionState.start=v,this._selectionState.end=b,this._selectionState.columnSelectMode=C,(M=this._renderer.value)===null||M===void 0||M.handleSelectionChanged(v,b,C)}handleCursorMove(){var v;(v=this._renderer.value)===null||v===void 0||v.handleCursorMove()}clear(){var v;(v=this._renderer.value)===null||v===void 0||v.clear()}};n.RenderService=f=u([p(2,l.IOptionsService),p(3,w.ICharSizeService),p(4,l.IDecorationService),p(5,l.IBufferService),p(6,w.ICoreBrowserService),p(7,w.IThemeService)],f)},9312:function(_,n,a){var u=this&&this.__decorate||function(y,E,B,T){var R,D=arguments.length,I=D<3?E:T===null?T=Object.getOwnPropertyDescriptor(E,B):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(y,E,B,T);else for(var F=y.length-1;F>=0;F--)(R=y[F])&&(I=(D<3?R(I):D>3?R(E,B,I):R(E,B))||I);return D>3&&I&&Object.defineProperty(E,B,I),I},p=this&&this.__param||function(y,E){return function(B,T){E(B,T,y)}};Object.defineProperty(n,"__esModule",{value:!0}),n.SelectionService=void 0;const c=a(9806),g=a(9504),S=a(456),w=a(4725),m=a(8460),o=a(844),h=a(6114),l=a(4841),f=a(511),v=a(2585),b=" ",C=new RegExp(b,"g");let M=n.SelectionService=class extends o.Disposable{constructor(y,E,B,T,R,D,I,F,W){super(),this._element=y,this._screenElement=E,this._linkifier=B,this._bufferService=T,this._coreService=R,this._mouseService=D,this._optionsService=I,this._renderService=F,this._coreBrowserService=W,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new f.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new m.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new m.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new m.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new m.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=H=>this._handleMouseMove(H),this._mouseUpListener=H=>this._handleMouseUp(H),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(H=>this._handleTrim(H)),this.register(this._bufferService.buffers.onBufferActivate(H=>this._handleBufferActivate(H))),this.enable(),this._model=new S.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,o.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const y=this._model.finalSelectionStart,E=this._model.finalSelectionEnd;return!(!y||!E||y[0]===E[0]&&y[1]===E[1])}get selectionText(){const y=this._model.finalSelectionStart,E=this._model.finalSelectionEnd;if(!y||!E)return"";const B=this._bufferService.buffer,T=[];if(this._activeSelectionMode===3){if(y[0]===E[0])return"";const R=y[0]<E[0]?y[0]:E[0],D=y[0]<E[0]?E[0]:y[0];for(let I=y[1];I<=E[1];I++){const F=B.translateBufferLineToString(I,!0,R,D);T.push(F)}}else{const R=y[1]===E[1]?E[0]:void 0;T.push(B.translateBufferLineToString(y[1],!0,y[0],R));for(let D=y[1]+1;D<=E[1]-1;D++){const I=B.lines.get(D),F=B.translateBufferLineToString(D,!0);I!=null&&I.isWrapped?T[T.length-1]+=F:T.push(F)}if(y[1]!==E[1]){const D=B.lines.get(E[1]),I=B.translateBufferLineToString(E[1],!0,0,E[0]);D&&D.isWrapped?T[T.length-1]+=I:T.push(I)}}return T.map(R=>R.replace(C," ")).join(h.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(y){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),h.isLinux&&y&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(y){const E=this._getMouseBufferCoords(y),B=this._model.finalSelectionStart,T=this._model.finalSelectionEnd;return!!(B&&T&&E)&&this._areCoordsInSelection(E,B,T)}isCellInSelection(y,E){const B=this._model.finalSelectionStart,T=this._model.finalSelectionEnd;return!(!B||!T)&&this._areCoordsInSelection([y,E],B,T)}_areCoordsInSelection(y,E,B){return y[1]>E[1]&&y[1]<B[1]||E[1]===B[1]&&y[1]===E[1]&&y[0]>=E[0]&&y[0]<B[0]||E[1]<B[1]&&y[1]===B[1]&&y[0]<B[0]||E[1]<B[1]&&y[1]===E[1]&&y[0]>=E[0]}_selectWordAtCursor(y,E){var B,T;const R=(T=(B=this._linkifier.currentLink)===null||B===void 0?void 0:B.link)===null||T===void 0?void 0:T.range;if(R)return this._model.selectionStart=[R.start.x-1,R.start.y-1],this._model.selectionStartLength=(0,l.getRangeLength)(R,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const D=this._getMouseBufferCoords(y);return!!D&&(this._selectWordAt(D,E),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(y,E){this._model.clearSelection(),y=Math.max(y,0),E=Math.min(E,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,y],this._model.selectionEnd=[this._bufferService.cols,E],this.refresh(),this._onSelectionChange.fire()}_handleTrim(y){this._model.handleTrim(y)&&this.refresh()}_getMouseBufferCoords(y){const E=this._mouseService.getCoords(y,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(E)return E[0]--,E[1]--,E[1]+=this._bufferService.buffer.ydisp,E}_getMouseEventScrollAmount(y){let E=(0,c.getCoordsRelativeToElement)(this._coreBrowserService.window,y,this._screenElement)[1];const B=this._renderService.dimensions.css.canvas.height;return E>=0&&E<=B?0:(E>B&&(E-=B),E=Math.min(Math.max(E,-50),50),E/=50,E/Math.abs(E)+Math.round(14*E))}shouldForceSelection(y){return h.isMac?y.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:y.shiftKey}handleMouseDown(y){if(this._mouseDownTimeStamp=y.timeStamp,(y.button!==2||!this.hasSelection)&&y.button===0){if(!this._enabled){if(!this.shouldForceSelection(y))return;y.stopPropagation()}y.preventDefault(),this._dragScrollAmount=0,this._enabled&&y.shiftKey?this._handleIncrementalClick(y):y.detail===1?this._handleSingleClick(y):y.detail===2?this._handleDoubleClick(y):y.detail===3&&this._handleTripleClick(y),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(y){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(y))}_handleSingleClick(y){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(y)?3:0,this._model.selectionStart=this._getMouseBufferCoords(y),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const E=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);E&&E.length!==this._model.selectionStart[0]&&E.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(y){this._selectWordAtCursor(y,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(y){const E=this._getMouseBufferCoords(y);E&&(this._activeSelectionMode=2,this._selectLineAt(E[1]))}shouldColumnSelect(y){return y.altKey&&!(h.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(y){if(y.stopImmediatePropagation(),!this._model.selectionStart)return;const E=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(y),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(y),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const B=this._bufferService.buffer;if(this._model.selectionEnd[1]<B.lines.length){const T=B.lines.get(this._model.selectionEnd[1]);T&&T.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}E&&E[0]===this._model.selectionEnd[0]&&E[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const y=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(y.ydisp+this._bufferService.rows,y.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=y.ydisp),this.refresh()}}_handleMouseUp(y){const E=y.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&E<500&&y.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const B=this._mouseService.getCoords(y,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(B&&B[0]!==void 0&&B[1]!==void 0){const T=(0,g.moveToCellSequence)(B[0]-1,B[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(T,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const y=this._model.finalSelectionStart,E=this._model.finalSelectionEnd,B=!(!y||!E||y[0]===E[0]&&y[1]===E[1]);B?y&&E&&(this._oldSelectionStart&&this._oldSelectionEnd&&y[0]===this._oldSelectionStart[0]&&y[1]===this._oldSelectionStart[1]&&E[0]===this._oldSelectionEnd[0]&&E[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(y,E,B)):this._oldHasSelection&&this._fireOnSelectionChange(y,E,B)}_fireOnSelectionChange(y,E,B){this._oldSelectionStart=y,this._oldSelectionEnd=E,this._oldHasSelection=B,this._onSelectionChange.fire()}_handleBufferActivate(y){this.clearSelection(),this._trimListener.dispose(),this._trimListener=y.activeBuffer.lines.onTrim(E=>this._handleTrim(E))}_convertViewportColToCharacterIndex(y,E){let B=E;for(let T=0;E>=T;T++){const R=y.loadCell(T,this._workCell).getChars().length;this._workCell.getWidth()===0?B--:R>1&&E!==T&&(B+=R-1)}return B}setSelection(y,E,B){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[y,E],this._model.selectionStartLength=B,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(y){this._isClickInSelection(y)||(this._selectWordAtCursor(y,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(y,E,B=!0,T=!0){if(y[0]>=this._bufferService.cols)return;const R=this._bufferService.buffer,D=R.lines.get(y[1]);if(!D)return;const I=R.translateBufferLineToString(y[1],!1);let F=this._convertViewportColToCharacterIndex(D,y[0]),W=F;const H=y[0]-F;let x=0,L=0,A=0,P=0;if(I.charAt(F)===" "){for(;F>0&&I.charAt(F-1)===" ";)F--;for(;W<I.length&&I.charAt(W+1)===" ";)W++}else{let G=y[0],K=y[0];D.getWidth(G)===0&&(x++,G--),D.getWidth(K)===2&&(L++,K++);const et=D.getString(K).length;for(et>1&&(P+=et-1,W+=et-1);G>0&&F>0&&!this._isCharWordSeparator(D.loadCell(G-1,this._workCell));){D.loadCell(G-1,this._workCell);const k=this._workCell.getChars().length;this._workCell.getWidth()===0?(x++,G--):k>1&&(A+=k-1,F-=k-1),F--,G--}for(;K<D.length&&W+1<I.length&&!this._isCharWordSeparator(D.loadCell(K+1,this._workCell));){D.loadCell(K+1,this._workCell);const k=this._workCell.getChars().length;this._workCell.getWidth()===2?(L++,K++):k>1&&(P+=k-1,W+=k-1),W++,K++}}W++;let $=F+H-x+A,V=Math.min(this._bufferService.cols,W-F+x+L-A-P);if(E||I.slice(F,W).trim()!==""){if(B&&$===0&&D.getCodePoint(0)!==32){const G=R.lines.get(y[1]-1);if(G&&D.isWrapped&&G.getCodePoint(this._bufferService.cols-1)!==32){const K=this._getWordAt([this._bufferService.cols-1,y[1]-1],!1,!0,!1);if(K){const et=this._bufferService.cols-K.start;$-=et,V+=et}}}if(T&&$+V===this._bufferService.cols&&D.getCodePoint(this._bufferService.cols-1)!==32){const G=R.lines.get(y[1]+1);if(G!=null&&G.isWrapped&&G.getCodePoint(0)!==32){const K=this._getWordAt([0,y[1]+1],!1,!1,!0);K&&(V+=K.length)}}return{start:$,length:V}}}_selectWordAt(y,E){const B=this._getWordAt(y,E);if(B){for(;B.start<0;)B.start+=this._bufferService.cols,y[1]--;this._model.selectionStart=[B.start,y[1]],this._model.selectionStartLength=B.length}}_selectToWordAt(y){const E=this._getWordAt(y,!0);if(E){let B=y[1];for(;E.start<0;)E.start+=this._bufferService.cols,B--;if(!this._model.areSelectionValuesReversed())for(;E.start+E.length>this._bufferService.cols;)E.length-=this._bufferService.cols,B++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?E.start:E.start+E.length,B]}}_isCharWordSeparator(y){return y.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(y.getChars())>=0}_selectLineAt(y){const E=this._bufferService.buffer.getWrappedRangeForLine(y),B={start:{x:0,y:E.first},end:{x:this._bufferService.cols-1,y:E.last}};this._model.selectionStart=[0,E.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,l.getRangeLength)(B,this._bufferService.cols)}};n.SelectionService=M=u([p(3,v.IBufferService),p(4,v.ICoreService),p(5,w.IMouseService),p(6,v.IOptionsService),p(7,w.IRenderService),p(8,w.ICoreBrowserService)],M)},4725:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.IThemeService=n.ICharacterJoinerService=n.ISelectionService=n.IRenderService=n.IMouseService=n.ICoreBrowserService=n.ICharSizeService=void 0;const u=a(8343);n.ICharSizeService=(0,u.createDecorator)("CharSizeService"),n.ICoreBrowserService=(0,u.createDecorator)("CoreBrowserService"),n.IMouseService=(0,u.createDecorator)("MouseService"),n.IRenderService=(0,u.createDecorator)("RenderService"),n.ISelectionService=(0,u.createDecorator)("SelectionService"),n.ICharacterJoinerService=(0,u.createDecorator)("CharacterJoinerService"),n.IThemeService=(0,u.createDecorator)("ThemeService")},6731:function(_,n,a){var u=this&&this.__decorate||function(M,y,E,B){var T,R=arguments.length,D=R<3?y:B===null?B=Object.getOwnPropertyDescriptor(y,E):B;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(M,y,E,B);else for(var I=M.length-1;I>=0;I--)(T=M[I])&&(D=(R<3?T(D):R>3?T(y,E,D):T(y,E))||D);return R>3&&D&&Object.defineProperty(y,E,D),D},p=this&&this.__param||function(M,y){return function(E,B){y(E,B,M)}};Object.defineProperty(n,"__esModule",{value:!0}),n.ThemeService=n.DEFAULT_ANSI_COLORS=void 0;const c=a(7239),g=a(8055),S=a(8460),w=a(844),m=a(2585),o=g.css.toColor("#ffffff"),h=g.css.toColor("#000000"),l=g.css.toColor("#ffffff"),f=g.css.toColor("#000000"),v={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};n.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const M=[g.css.toColor("#2e3436"),g.css.toColor("#cc0000"),g.css.toColor("#4e9a06"),g.css.toColor("#c4a000"),g.css.toColor("#3465a4"),g.css.toColor("#75507b"),g.css.toColor("#06989a"),g.css.toColor("#d3d7cf"),g.css.toColor("#555753"),g.css.toColor("#ef2929"),g.css.toColor("#8ae234"),g.css.toColor("#fce94f"),g.css.toColor("#729fcf"),g.css.toColor("#ad7fa8"),g.css.toColor("#34e2e2"),g.css.toColor("#eeeeec")],y=[0,95,135,175,215,255];for(let E=0;E<216;E++){const B=y[E/36%6|0],T=y[E/6%6|0],R=y[E%6];M.push({css:g.channels.toCss(B,T,R),rgba:g.channels.toRgba(B,T,R)})}for(let E=0;E<24;E++){const B=8+10*E;M.push({css:g.channels.toCss(B,B,B),rgba:g.channels.toRgba(B,B,B)})}return M})());let b=n.ThemeService=class extends w.Disposable{get colors(){return this._colors}constructor(M){super(),this._optionsService=M,this._contrastCache=new c.ColorContrastCache,this._halfContrastCache=new c.ColorContrastCache,this._onChangeColors=this.register(new S.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:o,background:h,cursor:l,cursorAccent:f,selectionForeground:void 0,selectionBackgroundTransparent:v,selectionBackgroundOpaque:g.color.blend(h,v),selectionInactiveBackgroundTransparent:v,selectionInactiveBackgroundOpaque:g.color.blend(h,v),ansi:n.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(M={}){const y=this._colors;if(y.foreground=C(M.foreground,o),y.background=C(M.background,h),y.cursor=C(M.cursor,l),y.cursorAccent=C(M.cursorAccent,f),y.selectionBackgroundTransparent=C(M.selectionBackground,v),y.selectionBackgroundOpaque=g.color.blend(y.background,y.selectionBackgroundTransparent),y.selectionInactiveBackgroundTransparent=C(M.selectionInactiveBackground,y.selectionBackgroundTransparent),y.selectionInactiveBackgroundOpaque=g.color.blend(y.background,y.selectionInactiveBackgroundTransparent),y.selectionForeground=M.selectionForeground?C(M.selectionForeground,g.NULL_COLOR):void 0,y.selectionForeground===g.NULL_COLOR&&(y.selectionForeground=void 0),g.color.isOpaque(y.selectionBackgroundTransparent)&&(y.selectionBackgroundTransparent=g.color.opacity(y.selectionBackgroundTransparent,.3)),g.color.isOpaque(y.selectionInactiveBackgroundTransparent)&&(y.selectionInactiveBackgroundTransparent=g.color.opacity(y.selectionInactiveBackgroundTransparent,.3)),y.ansi=n.DEFAULT_ANSI_COLORS.slice(),y.ansi[0]=C(M.black,n.DEFAULT_ANSI_COLORS[0]),y.ansi[1]=C(M.red,n.DEFAULT_ANSI_COLORS[1]),y.ansi[2]=C(M.green,n.DEFAULT_ANSI_COLORS[2]),y.ansi[3]=C(M.yellow,n.DEFAULT_ANSI_COLORS[3]),y.ansi[4]=C(M.blue,n.DEFAULT_ANSI_COLORS[4]),y.ansi[5]=C(M.magenta,n.DEFAULT_ANSI_COLORS[5]),y.ansi[6]=C(M.cyan,n.DEFAULT_ANSI_COLORS[6]),y.ansi[7]=C(M.white,n.DEFAULT_ANSI_COLORS[7]),y.ansi[8]=C(M.brightBlack,n.DEFAULT_ANSI_COLORS[8]),y.ansi[9]=C(M.brightRed,n.DEFAULT_ANSI_COLORS[9]),y.ansi[10]=C(M.brightGreen,n.DEFAULT_ANSI_COLORS[10]),y.ansi[11]=C(M.brightYellow,n.DEFAULT_ANSI_COLORS[11]),y.ansi[12]=C(M.brightBlue,n.DEFAULT_ANSI_COLORS[12]),y.ansi[13]=C(M.brightMagenta,n.DEFAULT_ANSI_COLORS[13]),y.ansi[14]=C(M.brightCyan,n.DEFAULT_ANSI_COLORS[14]),y.ansi[15]=C(M.brightWhite,n.DEFAULT_ANSI_COLORS[15]),M.extendedAnsi){const E=Math.min(y.ansi.length-16,M.extendedAnsi.length);for(let B=0;B<E;B++)y.ansi[B+16]=C(M.extendedAnsi[B],n.DEFAULT_ANSI_COLORS[B+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(M){this._restoreColor(M),this._onChangeColors.fire(this.colors)}_restoreColor(M){if(M!==void 0)switch(M){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[M]=this._restoreColors.ansi[M]}else for(let y=0;y<this._restoreColors.ansi.length;++y)this._colors.ansi[y]=this._restoreColors.ansi[y]}modifyColors(M){M(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function C(M,y){if(M!==void 0)try{return g.css.toColor(M)}catch{}return y}n.ThemeService=b=u([p(0,m.IOptionsService)],b)},6349:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CircularList=void 0;const u=a(8460),p=a(844);class c extends p.Disposable{constructor(S){super(),this._maxLength=S,this.onDeleteEmitter=this.register(new u.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new u.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new u.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(S){if(this._maxLength===S)return;const w=new Array(S);for(let m=0;m<Math.min(S,this.length);m++)w[m]=this._array[this._getCyclicIndex(m)];this._array=w,this._maxLength=S,this._startIndex=0}get length(){return this._length}set length(S){if(S>this._length)for(let w=this._length;w<S;w++)this._array[w]=void 0;this._length=S}get(S){return this._array[this._getCyclicIndex(S)]}set(S,w){this._array[this._getCyclicIndex(S)]=w}push(S){this._array[this._getCyclicIndex(this._length)]=S,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(S,w,...m){if(w){for(let o=S;o<this._length-w;o++)this._array[this._getCyclicIndex(o)]=this._array[this._getCyclicIndex(o+w)];this._length-=w,this.onDeleteEmitter.fire({index:S,amount:w})}for(let o=this._length-1;o>=S;o--)this._array[this._getCyclicIndex(o+m.length)]=this._array[this._getCyclicIndex(o)];for(let o=0;o<m.length;o++)this._array[this._getCyclicIndex(S+o)]=m[o];if(m.length&&this.onInsertEmitter.fire({index:S,amount:m.length}),this._length+m.length>this._maxLength){const o=this._length+m.length-this._maxLength;this._startIndex+=o,this._length=this._maxLength,this.onTrimEmitter.fire(o)}else this._length+=m.length}trimStart(S){S>this._length&&(S=this._length),this._startIndex+=S,this._length-=S,this.onTrimEmitter.fire(S)}shiftElements(S,w,m){if(!(w<=0)){if(S<0||S>=this._length)throw new Error("start argument out of range");if(S+m<0)throw new Error("Cannot shift elements in list beyond index 0");if(m>0){for(let h=w-1;h>=0;h--)this.set(S+h+m,this.get(S+h));const o=S+w+m-this._length;if(o>0)for(this._length+=o;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let o=0;o<w;o++)this.set(S+o+m,this.get(S+o))}}_getCyclicIndex(S){return(this._startIndex+S)%this._maxLength}}n.CircularList=c},1439:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.clone=void 0,n.clone=function a(u,p=5){if(typeof u!="object")return u;const c=Array.isArray(u)?[]:{};for(const g in u)c[g]=p<=1?u[g]:u[g]&&a(u[g],p-1);return c}},8055:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.contrastRatio=n.toPaddedHex=n.rgba=n.rgb=n.css=n.color=n.channels=n.NULL_COLOR=void 0;const u=a(6114);let p=0,c=0,g=0,S=0;var w,m,o,h,l;function f(b){const C=b.toString(16);return C.length<2?"0"+C:C}function v(b,C){return b<C?(C+.05)/(b+.05):(b+.05)/(C+.05)}n.NULL_COLOR={css:"#00000000",rgba:0},function(b){b.toCss=function(C,M,y,E){return E!==void 0?`#${f(C)}${f(M)}${f(y)}${f(E)}`:`#${f(C)}${f(M)}${f(y)}`},b.toRgba=function(C,M,y,E=255){return(C<<24|M<<16|y<<8|E)>>>0}}(w||(n.channels=w={})),function(b){function C(M,y){return S=Math.round(255*y),[p,c,g]=l.toChannels(M.rgba),{css:w.toCss(p,c,g,S),rgba:w.toRgba(p,c,g,S)}}b.blend=function(M,y){if(S=(255&y.rgba)/255,S===1)return{css:y.css,rgba:y.rgba};const E=y.rgba>>24&255,B=y.rgba>>16&255,T=y.rgba>>8&255,R=M.rgba>>24&255,D=M.rgba>>16&255,I=M.rgba>>8&255;return p=R+Math.round((E-R)*S),c=D+Math.round((B-D)*S),g=I+Math.round((T-I)*S),{css:w.toCss(p,c,g),rgba:w.toRgba(p,c,g)}},b.isOpaque=function(M){return(255&M.rgba)==255},b.ensureContrastRatio=function(M,y,E){const B=l.ensureContrastRatio(M.rgba,y.rgba,E);if(B)return l.toColor(B>>24&255,B>>16&255,B>>8&255)},b.opaque=function(M){const y=(255|M.rgba)>>>0;return[p,c,g]=l.toChannels(y),{css:w.toCss(p,c,g),rgba:y}},b.opacity=C,b.multiplyOpacity=function(M,y){return S=255&M.rgba,C(M,S*y/255)},b.toColorRGB=function(M){return[M.rgba>>24&255,M.rgba>>16&255,M.rgba>>8&255]}}(m||(n.color=m={})),function(b){let C,M;if(!u.isNode){const y=document.createElement("canvas");y.width=1,y.height=1;const E=y.getContext("2d",{willReadFrequently:!0});E&&(C=E,C.globalCompositeOperation="copy",M=C.createLinearGradient(0,0,1,1))}b.toColor=function(y){if(y.match(/#[\da-f]{3,8}/i))switch(y.length){case 4:return p=parseInt(y.slice(1,2).repeat(2),16),c=parseInt(y.slice(2,3).repeat(2),16),g=parseInt(y.slice(3,4).repeat(2),16),l.toColor(p,c,g);case 5:return p=parseInt(y.slice(1,2).repeat(2),16),c=parseInt(y.slice(2,3).repeat(2),16),g=parseInt(y.slice(3,4).repeat(2),16),S=parseInt(y.slice(4,5).repeat(2),16),l.toColor(p,c,g,S);case 7:return{css:y,rgba:(parseInt(y.slice(1),16)<<8|255)>>>0};case 9:return{css:y,rgba:parseInt(y.slice(1),16)>>>0}}const E=y.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(E)return p=parseInt(E[1]),c=parseInt(E[2]),g=parseInt(E[3]),S=Math.round(255*(E[5]===void 0?1:parseFloat(E[5]))),l.toColor(p,c,g,S);if(!C||!M)throw new Error("css.toColor: Unsupported css format");if(C.fillStyle=M,C.fillStyle=y,typeof C.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(C.fillRect(0,0,1,1),[p,c,g,S]=C.getImageData(0,0,1,1).data,S!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:w.toRgba(p,c,g,S),css:y}}}(o||(n.css=o={})),function(b){function C(M,y,E){const B=M/255,T=y/255,R=E/255;return .2126*(B<=.03928?B/12.92:Math.pow((B+.055)/1.055,2.4))+.7152*(T<=.03928?T/12.92:Math.pow((T+.055)/1.055,2.4))+.0722*(R<=.03928?R/12.92:Math.pow((R+.055)/1.055,2.4))}b.relativeLuminance=function(M){return C(M>>16&255,M>>8&255,255&M)},b.relativeLuminance2=C}(h||(n.rgb=h={})),function(b){function C(y,E,B){const T=y>>24&255,R=y>>16&255,D=y>>8&255;let I=E>>24&255,F=E>>16&255,W=E>>8&255,H=v(h.relativeLuminance2(I,F,W),h.relativeLuminance2(T,R,D));for(;H<B&&(I>0||F>0||W>0);)I-=Math.max(0,Math.ceil(.1*I)),F-=Math.max(0,Math.ceil(.1*F)),W-=Math.max(0,Math.ceil(.1*W)),H=v(h.relativeLuminance2(I,F,W),h.relativeLuminance2(T,R,D));return(I<<24|F<<16|W<<8|255)>>>0}function M(y,E,B){const T=y>>24&255,R=y>>16&255,D=y>>8&255;let I=E>>24&255,F=E>>16&255,W=E>>8&255,H=v(h.relativeLuminance2(I,F,W),h.relativeLuminance2(T,R,D));for(;H<B&&(I<255||F<255||W<255);)I=Math.min(255,I+Math.ceil(.1*(255-I))),F=Math.min(255,F+Math.ceil(.1*(255-F))),W=Math.min(255,W+Math.ceil(.1*(255-W))),H=v(h.relativeLuminance2(I,F,W),h.relativeLuminance2(T,R,D));return(I<<24|F<<16|W<<8|255)>>>0}b.ensureContrastRatio=function(y,E,B){const T=h.relativeLuminance(y>>8),R=h.relativeLuminance(E>>8);if(v(T,R)<B){if(R<T){const F=C(y,E,B),W=v(T,h.relativeLuminance(F>>8));if(W<B){const H=M(y,E,B);return W>v(T,h.relativeLuminance(H>>8))?F:H}return F}const D=M(y,E,B),I=v(T,h.relativeLuminance(D>>8));if(I<B){const F=C(y,E,B);return I>v(T,h.relativeLuminance(F>>8))?D:F}return D}},b.reduceLuminance=C,b.increaseLuminance=M,b.toChannels=function(y){return[y>>24&255,y>>16&255,y>>8&255,255&y]},b.toColor=function(y,E,B,T){return{css:w.toCss(y,E,B,T),rgba:w.toRgba(y,E,B,T)}}}(l||(n.rgba=l={})),n.toPaddedHex=f,n.contrastRatio=v},8969:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CoreTerminal=void 0;const u=a(844),p=a(2585),c=a(4348),g=a(7866),S=a(744),w=a(7302),m=a(6975),o=a(8460),h=a(1753),l=a(1480),f=a(7994),v=a(9282),b=a(5435),C=a(5981),M=a(2660);let y=!1;class E extends u.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new o.EventEmitter),this._onScroll.event(T=>{var R;(R=this._onScrollApi)===null||R===void 0||R.fire(T.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(T){for(const R in T)this.optionsService.options[R]=T[R]}constructor(T){super(),this._windowsWrappingHeuristics=this.register(new u.MutableDisposable),this._onBinary=this.register(new o.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new o.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new o.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new o.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new o.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new o.EventEmitter),this._instantiationService=new c.InstantiationService,this.optionsService=this.register(new w.OptionsService(T)),this._instantiationService.setService(p.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(S.BufferService)),this._instantiationService.setService(p.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(g.LogService)),this._instantiationService.setService(p.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(m.CoreService)),this._instantiationService.setService(p.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(h.CoreMouseService)),this._instantiationService.setService(p.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(l.UnicodeService)),this._instantiationService.setService(p.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(f.CharsetService),this._instantiationService.setService(p.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(M.OscLinkService),this._instantiationService.setService(p.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new b.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,o.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,o.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,o.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,o.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(R=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(R=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new C.WriteBuffer((R,D)=>this._inputHandler.parse(R,D))),this.register((0,o.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(T,R){this._writeBuffer.write(T,R)}writeSync(T,R){this._logService.logLevel<=p.LogLevelEnum.WARN&&!y&&(this._logService.warn("writeSync is unreliable and will be removed soon."),y=!0),this._writeBuffer.writeSync(T,R)}resize(T,R){isNaN(T)||isNaN(R)||(T=Math.max(T,S.MINIMUM_COLS),R=Math.max(R,S.MINIMUM_ROWS),this._bufferService.resize(T,R))}scroll(T,R=!1){this._bufferService.scroll(T,R)}scrollLines(T,R,D){this._bufferService.scrollLines(T,R,D)}scrollPages(T){this.scrollLines(T*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(T){const R=T-this._bufferService.buffer.ydisp;R!==0&&this.scrollLines(R)}registerEscHandler(T,R){return this._inputHandler.registerEscHandler(T,R)}registerDcsHandler(T,R){return this._inputHandler.registerDcsHandler(T,R)}registerCsiHandler(T,R){return this._inputHandler.registerCsiHandler(T,R)}registerOscHandler(T,R){return this._inputHandler.registerOscHandler(T,R)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let T=!1;const R=this.optionsService.rawOptions.windowsPty;R&&R.buildNumber!==void 0&&R.buildNumber!==void 0?T=R.backend==="conpty"&&R.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(T=!0),T?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const T=[];T.push(this.onLineFeed(v.updateWindowsModeWrappedState.bind(null,this._bufferService))),T.push(this.registerCsiHandler({final:"H"},()=>((0,v.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,u.toDisposable)(()=>{for(const R of T)R.dispose()})}}}n.CoreTerminal=E},8460:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.forwardEvent=n.EventEmitter=void 0,n.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=a=>(this._listeners.push(a),{dispose:()=>{if(!this._disposed){for(let u=0;u<this._listeners.length;u++)if(this._listeners[u]===a)return void this._listeners.splice(u,1)}}})),this._event}fire(a,u){const p=[];for(let c=0;c<this._listeners.length;c++)p.push(this._listeners[c]);for(let c=0;c<p.length;c++)p[c].call(void 0,a,u)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},n.forwardEvent=function(a,u){return a(p=>u.fire(p))}},5435:function(_,n,a){var u=this&&this.__decorate||function(H,x,L,A){var P,$=arguments.length,V=$<3?x:A===null?A=Object.getOwnPropertyDescriptor(x,L):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")V=Reflect.decorate(H,x,L,A);else for(var G=H.length-1;G>=0;G--)(P=H[G])&&(V=($<3?P(V):$>3?P(x,L,V):P(x,L))||V);return $>3&&V&&Object.defineProperty(x,L,V),V},p=this&&this.__param||function(H,x){return function(L,A){x(L,A,H)}};Object.defineProperty(n,"__esModule",{value:!0}),n.InputHandler=n.WindowsOptionsReportType=void 0;const c=a(2584),g=a(7116),S=a(2015),w=a(844),m=a(482),o=a(8437),h=a(8460),l=a(643),f=a(511),v=a(3734),b=a(2585),C=a(6242),M=a(6351),y=a(5941),E={"(":0,")":1,"*":2,"+":3,"-":1,".":2},B=131072;function T(H,x){if(H>24)return x.setWinLines||!1;switch(H){case 1:return!!x.restoreWin;case 2:return!!x.minimizeWin;case 3:return!!x.setWinPosition;case 4:return!!x.setWinSizePixels;case 5:return!!x.raiseWin;case 6:return!!x.lowerWin;case 7:return!!x.refreshWin;case 8:return!!x.setWinSizeChars;case 9:return!!x.maximizeWin;case 10:return!!x.fullscreenWin;case 11:return!!x.getWinState;case 13:return!!x.getWinPosition;case 14:return!!x.getWinSizePixels;case 15:return!!x.getScreenSizePixels;case 16:return!!x.getCellSizePixels;case 18:return!!x.getWinSizeChars;case 19:return!!x.getScreenSizeChars;case 20:return!!x.getIconTitle;case 21:return!!x.getWinTitle;case 22:return!!x.pushTitle;case 23:return!!x.popTitle;case 24:return!!x.setWinLines}return!1}var R;(function(H){H[H.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",H[H.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(R||(n.WindowsOptionsReportType=R={}));let D=0;class I extends w.Disposable{getAttrData(){return this._curAttrData}constructor(x,L,A,P,$,V,G,K,et=new S.EscapeSequenceParser){super(),this._bufferService=x,this._charsetService=L,this._coreService=A,this._logService=P,this._optionsService=$,this._oscLinkService=V,this._coreMouseService=G,this._unicodeService=K,this._parser=et,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new m.StringToUtf32,this._utf8Decoder=new m.Utf8ToUtf32,this._workCell=new f.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=o.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=o.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new h.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new h.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new h.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new h.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new h.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new h.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new h.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new h.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new h.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new h.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new h.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new h.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new h.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new F(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(k=>this._activeBuffer=k.activeBuffer)),this._parser.setCsiHandlerFallback((k,O)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(k),params:O.toArray()})}),this._parser.setEscHandlerFallback(k=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(k)})}),this._parser.setExecuteHandlerFallback(k=>{this._logService.debug("Unknown EXECUTE code: ",{code:k})}),this._parser.setOscHandlerFallback((k,O,z)=>{this._logService.debug("Unknown OSC code: ",{identifier:k,action:O,data:z})}),this._parser.setDcsHandlerFallback((k,O,z)=>{O==="HOOK"&&(z=z.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(k),action:O,payload:z})}),this._parser.setPrintHandler((k,O,z)=>this.print(k,O,z)),this._parser.registerCsiHandler({final:"@"},k=>this.insertChars(k)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},k=>this.scrollLeft(k)),this._parser.registerCsiHandler({final:"A"},k=>this.cursorUp(k)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},k=>this.scrollRight(k)),this._parser.registerCsiHandler({final:"B"},k=>this.cursorDown(k)),this._parser.registerCsiHandler({final:"C"},k=>this.cursorForward(k)),this._parser.registerCsiHandler({final:"D"},k=>this.cursorBackward(k)),this._parser.registerCsiHandler({final:"E"},k=>this.cursorNextLine(k)),this._parser.registerCsiHandler({final:"F"},k=>this.cursorPrecedingLine(k)),this._parser.registerCsiHandler({final:"G"},k=>this.cursorCharAbsolute(k)),this._parser.registerCsiHandler({final:"H"},k=>this.cursorPosition(k)),this._parser.registerCsiHandler({final:"I"},k=>this.cursorForwardTab(k)),this._parser.registerCsiHandler({final:"J"},k=>this.eraseInDisplay(k,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},k=>this.eraseInDisplay(k,!0)),this._parser.registerCsiHandler({final:"K"},k=>this.eraseInLine(k,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},k=>this.eraseInLine(k,!0)),this._parser.registerCsiHandler({final:"L"},k=>this.insertLines(k)),this._parser.registerCsiHandler({final:"M"},k=>this.deleteLines(k)),this._parser.registerCsiHandler({final:"P"},k=>this.deleteChars(k)),this._parser.registerCsiHandler({final:"S"},k=>this.scrollUp(k)),this._parser.registerCsiHandler({final:"T"},k=>this.scrollDown(k)),this._parser.registerCsiHandler({final:"X"},k=>this.eraseChars(k)),this._parser.registerCsiHandler({final:"Z"},k=>this.cursorBackwardTab(k)),this._parser.registerCsiHandler({final:"`"},k=>this.charPosAbsolute(k)),this._parser.registerCsiHandler({final:"a"},k=>this.hPositionRelative(k)),this._parser.registerCsiHandler({final:"b"},k=>this.repeatPrecedingCharacter(k)),this._parser.registerCsiHandler({final:"c"},k=>this.sendDeviceAttributesPrimary(k)),this._parser.registerCsiHandler({prefix:">",final:"c"},k=>this.sendDeviceAttributesSecondary(k)),this._parser.registerCsiHandler({final:"d"},k=>this.linePosAbsolute(k)),this._parser.registerCsiHandler({final:"e"},k=>this.vPositionRelative(k)),this._parser.registerCsiHandler({final:"f"},k=>this.hVPosition(k)),this._parser.registerCsiHandler({final:"g"},k=>this.tabClear(k)),this._parser.registerCsiHandler({final:"h"},k=>this.setMode(k)),this._parser.registerCsiHandler({prefix:"?",final:"h"},k=>this.setModePrivate(k)),this._parser.registerCsiHandler({final:"l"},k=>this.resetMode(k)),this._parser.registerCsiHandler({prefix:"?",final:"l"},k=>this.resetModePrivate(k)),this._parser.registerCsiHandler({final:"m"},k=>this.charAttributes(k)),this._parser.registerCsiHandler({final:"n"},k=>this.deviceStatus(k)),this._parser.registerCsiHandler({prefix:"?",final:"n"},k=>this.deviceStatusPrivate(k)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},k=>this.softReset(k)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},k=>this.setCursorStyle(k)),this._parser.registerCsiHandler({final:"r"},k=>this.setScrollRegion(k)),this._parser.registerCsiHandler({final:"s"},k=>this.saveCursor(k)),this._parser.registerCsiHandler({final:"t"},k=>this.windowOptions(k)),this._parser.registerCsiHandler({final:"u"},k=>this.restoreCursor(k)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},k=>this.insertColumns(k)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},k=>this.deleteColumns(k)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},k=>this.selectProtected(k)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},k=>this.requestMode(k,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},k=>this.requestMode(k,!1)),this._parser.setExecuteHandler(c.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(c.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(c.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(c.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(c.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(c.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(c.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(c.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(c.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(c.C1.IND,()=>this.index()),this._parser.setExecuteHandler(c.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(c.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new C.OscHandler(k=>(this.setTitle(k),this.setIconName(k),!0))),this._parser.registerOscHandler(1,new C.OscHandler(k=>this.setIconName(k))),this._parser.registerOscHandler(2,new C.OscHandler(k=>this.setTitle(k))),this._parser.registerOscHandler(4,new C.OscHandler(k=>this.setOrReportIndexedColor(k))),this._parser.registerOscHandler(8,new C.OscHandler(k=>this.setHyperlink(k))),this._parser.registerOscHandler(10,new C.OscHandler(k=>this.setOrReportFgColor(k))),this._parser.registerOscHandler(11,new C.OscHandler(k=>this.setOrReportBgColor(k))),this._parser.registerOscHandler(12,new C.OscHandler(k=>this.setOrReportCursorColor(k))),this._parser.registerOscHandler(104,new C.OscHandler(k=>this.restoreIndexedColor(k))),this._parser.registerOscHandler(110,new C.OscHandler(k=>this.restoreFgColor(k))),this._parser.registerOscHandler(111,new C.OscHandler(k=>this.restoreBgColor(k))),this._parser.registerOscHandler(112,new C.OscHandler(k=>this.restoreCursorColor(k))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const k in g.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:k},()=>this.selectCharset("("+k)),this._parser.registerEscHandler({intermediates:")",final:k},()=>this.selectCharset(")"+k)),this._parser.registerEscHandler({intermediates:"*",final:k},()=>this.selectCharset("*"+k)),this._parser.registerEscHandler({intermediates:"+",final:k},()=>this.selectCharset("+"+k)),this._parser.registerEscHandler({intermediates:"-",final:k},()=>this.selectCharset("-"+k)),this._parser.registerEscHandler({intermediates:".",final:k},()=>this.selectCharset("."+k)),this._parser.registerEscHandler({intermediates:"/",final:k},()=>this.selectCharset("/"+k));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(k=>(this._logService.error("Parsing error: ",k),k)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new M.DcsHandler((k,O)=>this.requestStatusString(k,O)))}_preserveStack(x,L,A,P){this._parseStack.paused=!0,this._parseStack.cursorStartX=x,this._parseStack.cursorStartY=L,this._parseStack.decodedLength=A,this._parseStack.position=P}_logSlowResolvingAsync(x){this._logService.logLevel<=b.LogLevelEnum.WARN&&Promise.race([x,new Promise((L,A)=>setTimeout(()=>A("#SLOW_TIMEOUT"),5e3))]).catch(L=>{if(L!=="#SLOW_TIMEOUT")throw L;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(x,L){let A,P=this._activeBuffer.x,$=this._activeBuffer.y,V=0;const G=this._parseStack.paused;if(G){if(A=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,L))return this._logSlowResolvingAsync(A),A;P=this._parseStack.cursorStartX,$=this._parseStack.cursorStartY,this._parseStack.paused=!1,x.length>B&&(V=this._parseStack.position+B)}if(this._logService.logLevel<=b.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof x=="string"?` "${x}"`:` "${Array.prototype.map.call(x,K=>String.fromCharCode(K)).join("")}"`),typeof x=="string"?x.split("").map(K=>K.charCodeAt(0)):x),this._parseBuffer.length<x.length&&this._parseBuffer.length<B&&(this._parseBuffer=new Uint32Array(Math.min(x.length,B))),G||this._dirtyRowTracker.clearRange(),x.length>B)for(let K=V;K<x.length;K+=B){const et=K+B<x.length?K+B:x.length,k=typeof x=="string"?this._stringDecoder.decode(x.substring(K,et),this._parseBuffer):this._utf8Decoder.decode(x.subarray(K,et),this._parseBuffer);if(A=this._parser.parse(this._parseBuffer,k))return this._preserveStack(P,$,k,K),this._logSlowResolvingAsync(A),A}else if(!G){const K=typeof x=="string"?this._stringDecoder.decode(x,this._parseBuffer):this._utf8Decoder.decode(x,this._parseBuffer);if(A=this._parser.parse(this._parseBuffer,K))return this._preserveStack(P,$,K,0),this._logSlowResolvingAsync(A),A}this._activeBuffer.x===P&&this._activeBuffer.y===$||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(x,L,A){let P,$;const V=this._charsetService.charset,G=this._optionsService.rawOptions.screenReaderMode,K=this._bufferService.cols,et=this._coreService.decPrivateModes.wraparound,k=this._coreService.modes.insertMode,O=this._curAttrData;let z=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&A-L>0&&z.getWidth(this._activeBuffer.x-1)===2&&z.setCellFromCodePoint(this._activeBuffer.x-1,0,1,O.fg,O.bg,O.extended);for(let N=L;N<A;++N){if(P=x[N],$=this._unicodeService.wcwidth(P),P<127&&V){const q=V[String.fromCharCode(P)];q&&(P=q.charCodeAt(0))}if(G&&this._onA11yChar.fire((0,m.stringFromCodePoint)(P)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),$||!this._activeBuffer.x){if(this._activeBuffer.x+$-1>=K){if(et){for(;this._activeBuffer.x<K;)z.setCellFromCodePoint(this._activeBuffer.x++,0,1,O.fg,O.bg,O.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),z=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=K-1,$===2)continue}if(k&&(z.insertCells(this._activeBuffer.x,$,this._activeBuffer.getNullCell(O),O),z.getWidth(K-1)===2&&z.setCellFromCodePoint(K-1,l.NULL_CELL_CODE,l.NULL_CELL_WIDTH,O.fg,O.bg,O.extended)),z.setCellFromCodePoint(this._activeBuffer.x++,P,$,O.fg,O.bg,O.extended),$>0)for(;--$;)z.setCellFromCodePoint(this._activeBuffer.x++,0,0,O.fg,O.bg,O.extended)}else z.getWidth(this._activeBuffer.x-1)?z.addCodepointToCell(this._activeBuffer.x-1,P):z.addCodepointToCell(this._activeBuffer.x-2,P)}A-L>0&&(z.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<K&&A-L>0&&z.getWidth(this._activeBuffer.x)===0&&!z.hasContent(this._activeBuffer.x)&&z.setCellFromCodePoint(this._activeBuffer.x,0,1,O.fg,O.bg,O.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(x,L){return x.final!=="t"||x.prefix||x.intermediates?this._parser.registerCsiHandler(x,L):this._parser.registerCsiHandler(x,A=>!T(A.params[0],this._optionsService.rawOptions.windowOptions)||L(A))}registerDcsHandler(x,L){return this._parser.registerDcsHandler(x,new M.DcsHandler(L))}registerEscHandler(x,L){return this._parser.registerEscHandler(x,L)}registerOscHandler(x,L){return this._parser.registerOscHandler(x,new C.OscHandler(L))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var x;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((x=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||x===void 0)&&x.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);L.hasWidth(this._activeBuffer.x)&&!L.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const x=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-x),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(x=this._bufferService.cols-1){this._activeBuffer.x=Math.min(x,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(x,L){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=x,this._activeBuffer.y=this._activeBuffer.scrollTop+L):(this._activeBuffer.x=x,this._activeBuffer.y=L),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(x,L){this._restrictCursor(),this._setCursor(this._activeBuffer.x+x,this._activeBuffer.y+L)}cursorUp(x){const L=this._activeBuffer.y-this._activeBuffer.scrollTop;return L>=0?this._moveCursor(0,-Math.min(L,x.params[0]||1)):this._moveCursor(0,-(x.params[0]||1)),!0}cursorDown(x){const L=this._activeBuffer.scrollBottom-this._activeBuffer.y;return L>=0?this._moveCursor(0,Math.min(L,x.params[0]||1)):this._moveCursor(0,x.params[0]||1),!0}cursorForward(x){return this._moveCursor(x.params[0]||1,0),!0}cursorBackward(x){return this._moveCursor(-(x.params[0]||1),0),!0}cursorNextLine(x){return this.cursorDown(x),this._activeBuffer.x=0,!0}cursorPrecedingLine(x){return this.cursorUp(x),this._activeBuffer.x=0,!0}cursorCharAbsolute(x){return this._setCursor((x.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(x){return this._setCursor(x.length>=2?(x.params[1]||1)-1:0,(x.params[0]||1)-1),!0}charPosAbsolute(x){return this._setCursor((x.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(x){return this._moveCursor(x.params[0]||1,0),!0}linePosAbsolute(x){return this._setCursor(this._activeBuffer.x,(x.params[0]||1)-1),!0}vPositionRelative(x){return this._moveCursor(0,x.params[0]||1),!0}hVPosition(x){return this.cursorPosition(x),!0}tabClear(x){const L=x.params[0];return L===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:L===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(x){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let L=x.params[0]||1;for(;L--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(x){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let L=x.params[0]||1;for(;L--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(x){const L=x.params[0];return L===1&&(this._curAttrData.bg|=536870912),L!==2&&L!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(x,L,A,P=!1,$=!1){const V=this._activeBuffer.lines.get(this._activeBuffer.ybase+x);V.replaceCells(L,A,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),$),P&&(V.isWrapped=!1)}_resetBufferLine(x,L=!1){const A=this._activeBuffer.lines.get(this._activeBuffer.ybase+x);A&&(A.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),L),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+x),A.isWrapped=!1)}eraseInDisplay(x,L=!1){let A;switch(this._restrictCursor(this._bufferService.cols),x.params[0]){case 0:for(A=this._activeBuffer.y,this._dirtyRowTracker.markDirty(A),this._eraseInBufferLine(A++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,L);A<this._bufferService.rows;A++)this._resetBufferLine(A,L);this._dirtyRowTracker.markDirty(A);break;case 1:for(A=this._activeBuffer.y,this._dirtyRowTracker.markDirty(A),this._eraseInBufferLine(A,0,this._activeBuffer.x+1,!0,L),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(A+1).isWrapped=!1);A--;)this._resetBufferLine(A,L);this._dirtyRowTracker.markDirty(0);break;case 2:for(A=this._bufferService.rows,this._dirtyRowTracker.markDirty(A-1);A--;)this._resetBufferLine(A,L);this._dirtyRowTracker.markDirty(0);break;case 3:const P=this._activeBuffer.lines.length-this._bufferService.rows;P>0&&(this._activeBuffer.lines.trimStart(P),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-P,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-P,0),this._onScroll.fire(0))}return!0}eraseInLine(x,L=!1){switch(this._restrictCursor(this._bufferService.cols),x.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,L);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,L);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,L)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(x){this._restrictCursor();let L=x.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const A=this._activeBuffer.ybase+this._activeBuffer.y,P=this._bufferService.rows-1-this._activeBuffer.scrollBottom,$=this._bufferService.rows-1+this._activeBuffer.ybase-P+1;for(;L--;)this._activeBuffer.lines.splice($-1,1),this._activeBuffer.lines.splice(A,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(x){this._restrictCursor();let L=x.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const A=this._activeBuffer.ybase+this._activeBuffer.y;let P;for(P=this._bufferService.rows-1-this._activeBuffer.scrollBottom,P=this._bufferService.rows-1+this._activeBuffer.ybase-P;L--;)this._activeBuffer.lines.splice(A,1),this._activeBuffer.lines.splice(P,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(x){this._restrictCursor();const L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return L&&(L.insertCells(this._activeBuffer.x,x.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(x){this._restrictCursor();const L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return L&&(L.deleteCells(this._activeBuffer.x,x.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(x){let L=x.params[0]||1;for(;L--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(x){let L=x.params[0]||1;for(;L--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(o.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(x){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const L=x.params[0]||1;for(let A=this._activeBuffer.scrollTop;A<=this._activeBuffer.scrollBottom;++A){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+A);P.deleteCells(0,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(x){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const L=x.params[0]||1;for(let A=this._activeBuffer.scrollTop;A<=this._activeBuffer.scrollBottom;++A){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+A);P.insertCells(0,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(x){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const L=x.params[0]||1;for(let A=this._activeBuffer.scrollTop;A<=this._activeBuffer.scrollBottom;++A){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+A);P.insertCells(this._activeBuffer.x,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(x){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const L=x.params[0]||1;for(let A=this._activeBuffer.scrollTop;A<=this._activeBuffer.scrollBottom;++A){const P=this._activeBuffer.lines.get(this._activeBuffer.ybase+A);P.deleteCells(this._activeBuffer.x,L,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),P.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(x){this._restrictCursor();const L=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return L&&(L.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(x.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(x){if(!this._parser.precedingCodepoint)return!0;const L=x.params[0]||1,A=new Uint32Array(L);for(let P=0;P<L;++P)A[P]=this._parser.precedingCodepoint;return this.print(A,0,A.length),!0}sendDeviceAttributesPrimary(x){return x.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(c.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(c.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(x){return x.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(c.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(c.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(x.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(c.C0.ESC+"[>83;40003;0c")),!0}_is(x){return(this._optionsService.rawOptions.termName+"").indexOf(x)===0}setMode(x){for(let L=0;L<x.length;L++)switch(x.params[L]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(x){for(let L=0;L<x.length;L++)switch(x.params[L]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,g.DEFAULT_CHARSET),this._charsetService.setgCharset(1,g.DEFAULT_CHARSET),this._charsetService.setgCharset(2,g.DEFAULT_CHARSET),this._charsetService.setgCharset(3,g.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(x){for(let L=0;L<x.length;L++)switch(x.params[L]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(x){for(let L=0;L<x.length;L++)switch(x.params[L]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),x.params[L]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(x,L){const A=this._coreService.decPrivateModes,{activeProtocol:P,activeEncoding:$}=this._coreMouseService,V=this._coreService,{buffers:G,cols:K}=this._bufferService,{active:et,alt:k}=G,O=this._optionsService.rawOptions,z=tt=>tt?1:2,N=x.params[0];return q=N,U=L?N===2?4:N===4?z(V.modes.insertMode):N===12?3:N===20?z(O.convertEol):0:N===1?z(A.applicationCursorKeys):N===3?O.windowOptions.setWinLines?K===80?2:K===132?1:0:0:N===6?z(A.origin):N===7?z(A.wraparound):N===8?3:N===9?z(P==="X10"):N===12?z(O.cursorBlink):N===25?z(!V.isCursorHidden):N===45?z(A.reverseWraparound):N===66?z(A.applicationKeypad):N===67?4:N===1e3?z(P==="VT200"):N===1002?z(P==="DRAG"):N===1003?z(P==="ANY"):N===1004?z(A.sendFocus):N===1005?4:N===1006?z($==="SGR"):N===1015?4:N===1016?z($==="SGR_PIXELS"):N===1048?1:N===47||N===1047||N===1049?z(et===k):N===2004?z(A.bracketedPasteMode):0,V.triggerDataEvent(`${c.C0.ESC}[${L?"":"?"}${q};${U}$y`),!0;var q,U}_updateAttrColor(x,L,A,P,$){return L===2?(x|=50331648,x&=-16777216,x|=v.AttributeData.fromColorRGB([A,P,$])):L===5&&(x&=-50331904,x|=33554432|255&A),x}_extractColor(x,L,A){const P=[0,0,-1,0,0,0];let $=0,V=0;do{if(P[V+$]=x.params[L+V],x.hasSubParams(L+V)){const G=x.getSubParams(L+V);let K=0;do P[1]===5&&($=1),P[V+K+1+$]=G[K];while(++K<G.length&&K+V+1+$<P.length);break}if(P[1]===5&&V+$>=2||P[1]===2&&V+$>=5)break;P[1]&&($=1)}while(++V+L<x.length&&V+$<P.length);for(let G=2;G<P.length;++G)P[G]===-1&&(P[G]=0);switch(P[0]){case 38:A.fg=this._updateAttrColor(A.fg,P[1],P[3],P[4],P[5]);break;case 48:A.bg=this._updateAttrColor(A.bg,P[1],P[3],P[4],P[5]);break;case 58:A.extended=A.extended.clone(),A.extended.underlineColor=this._updateAttrColor(A.extended.underlineColor,P[1],P[3],P[4],P[5])}return V}_processUnderline(x,L){L.extended=L.extended.clone(),(!~x||x>5)&&(x=1),L.extended.underlineStyle=x,L.fg|=268435456,x===0&&(L.fg&=-268435457),L.updateExtended()}_processSGR0(x){x.fg=o.DEFAULT_ATTR_DATA.fg,x.bg=o.DEFAULT_ATTR_DATA.bg,x.extended=x.extended.clone(),x.extended.underlineStyle=0,x.extended.underlineColor&=-67108864,x.updateExtended()}charAttributes(x){if(x.length===1&&x.params[0]===0)return this._processSGR0(this._curAttrData),!0;const L=x.length;let A;const P=this._curAttrData;for(let $=0;$<L;$++)A=x.params[$],A>=30&&A<=37?(P.fg&=-50331904,P.fg|=16777216|A-30):A>=40&&A<=47?(P.bg&=-50331904,P.bg|=16777216|A-40):A>=90&&A<=97?(P.fg&=-50331904,P.fg|=16777224|A-90):A>=100&&A<=107?(P.bg&=-50331904,P.bg|=16777224|A-100):A===0?this._processSGR0(P):A===1?P.fg|=134217728:A===3?P.bg|=67108864:A===4?(P.fg|=268435456,this._processUnderline(x.hasSubParams($)?x.getSubParams($)[0]:1,P)):A===5?P.fg|=536870912:A===7?P.fg|=67108864:A===8?P.fg|=1073741824:A===9?P.fg|=2147483648:A===2?P.bg|=134217728:A===21?this._processUnderline(2,P):A===22?(P.fg&=-134217729,P.bg&=-134217729):A===23?P.bg&=-67108865:A===24?(P.fg&=-268435457,this._processUnderline(0,P)):A===25?P.fg&=-536870913:A===27?P.fg&=-67108865:A===28?P.fg&=-1073741825:A===29?P.fg&=2147483647:A===39?(P.fg&=-67108864,P.fg|=16777215&o.DEFAULT_ATTR_DATA.fg):A===49?(P.bg&=-67108864,P.bg|=16777215&o.DEFAULT_ATTR_DATA.bg):A===38||A===48||A===58?$+=this._extractColor(x,$,P):A===53?P.bg|=1073741824:A===55?P.bg&=-1073741825:A===59?(P.extended=P.extended.clone(),P.extended.underlineColor=-1,P.updateExtended()):A===100?(P.fg&=-67108864,P.fg|=16777215&o.DEFAULT_ATTR_DATA.fg,P.bg&=-67108864,P.bg|=16777215&o.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",A);return!0}deviceStatus(x){switch(x.params[0]){case 5:this._coreService.triggerDataEvent(`${c.C0.ESC}[0n`);break;case 6:const L=this._activeBuffer.y+1,A=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${c.C0.ESC}[${L};${A}R`)}return!0}deviceStatusPrivate(x){if(x.params[0]===6){const L=this._activeBuffer.y+1,A=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${c.C0.ESC}[?${L};${A}R`)}return!0}softReset(x){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=o.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(x){const L=x.params[0]||1;switch(L){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const A=L%2==1;return this._optionsService.options.cursorBlink=A,!0}setScrollRegion(x){const L=x.params[0]||1;let A;return(x.length<2||(A=x.params[1])>this._bufferService.rows||A===0)&&(A=this._bufferService.rows),A>L&&(this._activeBuffer.scrollTop=L-1,this._activeBuffer.scrollBottom=A-1,this._setCursor(0,0)),!0}windowOptions(x){if(!T(x.params[0],this._optionsService.rawOptions.windowOptions))return!0;const L=x.length>1?x.params[1]:0;switch(x.params[0]){case 14:L!==2&&this._onRequestWindowsOptionsReport.fire(R.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(R.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${c.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:L!==0&&L!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),L!==0&&L!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:L!==0&&L!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),L!==0&&L!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(x){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(x){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(x){return this._windowTitle=x,this._onTitleChange.fire(x),!0}setIconName(x){return this._iconName=x,!0}setOrReportIndexedColor(x){const L=[],A=x.split(";");for(;A.length>1;){const P=A.shift(),$=A.shift();if(/^\d+$/.exec(P)){const V=parseInt(P);if(W(V))if($==="?")L.push({type:0,index:V});else{const G=(0,y.parseColor)($);G&&L.push({type:1,index:V,color:G})}}}return L.length&&this._onColor.fire(L),!0}setHyperlink(x){const L=x.split(";");return!(L.length<2)&&(L[1]?this._createHyperlink(L[0],L[1]):!L[0]&&this._finishHyperlink())}_createHyperlink(x,L){this._getCurrentLinkId()&&this._finishHyperlink();const A=x.split(":");let P;const $=A.findIndex(V=>V.startsWith("id="));return $!==-1&&(P=A[$].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:P,uri:L}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(x,L){const A=x.split(";");for(let P=0;P<A.length&&!(L>=this._specialColors.length);++P,++L)if(A[P]==="?")this._onColor.fire([{type:0,index:this._specialColors[L]}]);else{const $=(0,y.parseColor)(A[P]);$&&this._onColor.fire([{type:1,index:this._specialColors[L],color:$}])}return!0}setOrReportFgColor(x){return this._setOrReportSpecialColor(x,0)}setOrReportBgColor(x){return this._setOrReportSpecialColor(x,1)}setOrReportCursorColor(x){return this._setOrReportSpecialColor(x,2)}restoreIndexedColor(x){if(!x)return this._onColor.fire([{type:2}]),!0;const L=[],A=x.split(";");for(let P=0;P<A.length;++P)if(/^\d+$/.exec(A[P])){const $=parseInt(A[P]);W($)&&L.push({type:2,index:$})}return L.length&&this._onColor.fire(L),!0}restoreFgColor(x){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(x){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(x){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,g.DEFAULT_CHARSET),!0}selectCharset(x){return x.length!==2?(this.selectDefaultCharset(),!0):(x[0]==="/"||this._charsetService.setgCharset(E[x[0]],g.CHARSETS[x[1]]||g.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const x=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,x,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=o.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=o.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(x){return this._charsetService.setgLevel(x),!0}screenAlignmentPattern(){const x=new f.CellData;x.content=4194373,x.fg=this._curAttrData.fg,x.bg=this._curAttrData.bg,this._setCursor(0,0);for(let L=0;L<this._bufferService.rows;++L){const A=this._activeBuffer.ybase+this._activeBuffer.y+L,P=this._activeBuffer.lines.get(A);P&&(P.fill(x),P.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(x,L){const A=this._bufferService.buffer,P=this._optionsService.rawOptions;return($=>(this._coreService.triggerDataEvent(`${c.C0.ESC}${$}${c.C0.ESC}\\`),!0))(x==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:x==='"p'?'P1$r61;1"p':x==="r"?`P1$r${A.scrollTop+1};${A.scrollBottom+1}r`:x==="m"?"P1$r0m":x===" q"?`P1$r${{block:2,underline:4,bar:6}[P.cursorStyle]-(P.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(x,L){this._dirtyRowTracker.markRangeDirty(x,L)}}n.InputHandler=I;let F=class{constructor(H){this._bufferService=H,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(H){H<this.start?this.start=H:H>this.end&&(this.end=H)}markRangeDirty(H,x){H>x&&(D=H,H=x,x=D),H<this.start&&(this.start=H),x>this.end&&(this.end=x)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function W(H){return 0<=H&&H<256}F=u([p(0,b.IBufferService)],F)},844:(_,n)=>{function a(u){for(const p of u)p.dispose();u.length=0}Object.defineProperty(n,"__esModule",{value:!0}),n.getDisposeArrayDisposable=n.disposeArray=n.toDisposable=n.MutableDisposable=n.Disposable=void 0,n.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const u of this._disposables)u.dispose();this._disposables.length=0}register(u){return this._disposables.push(u),u}unregister(u){const p=this._disposables.indexOf(u);p!==-1&&this._disposables.splice(p,1)}},n.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(u){var p;this._isDisposed||u===this._value||((p=this._value)===null||p===void 0||p.dispose(),this._value=u)}clear(){this.value=void 0}dispose(){var u;this._isDisposed=!0,(u=this._value)===null||u===void 0||u.dispose(),this._value=void 0}},n.toDisposable=function(u){return{dispose:u}},n.disposeArray=a,n.getDisposeArrayDisposable=function(u){return{dispose:()=>a(u)}}},1505:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FourKeyMap=n.TwoKeyMap=void 0;class a{constructor(){this._data={}}set(p,c,g){this._data[p]||(this._data[p]={}),this._data[p][c]=g}get(p,c){return this._data[p]?this._data[p][c]:void 0}clear(){this._data={}}}n.TwoKeyMap=a,n.FourKeyMap=class{constructor(){this._data=new a}set(u,p,c,g,S){this._data.get(u,p)||this._data.set(u,p,new a),this._data.get(u,p).set(c,g,S)}get(u,p,c,g){var S;return(S=this._data.get(u,p))===null||S===void 0?void 0:S.get(c,g)}clear(){this._data.clear()}}},6114:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.isChromeOS=n.isLinux=n.isWindows=n.isIphone=n.isIpad=n.isMac=n.getSafariVersion=n.isSafari=n.isLegacyEdge=n.isFirefox=n.isNode=void 0,n.isNode=typeof navigator>"u";const a=n.isNode?"node":navigator.userAgent,u=n.isNode?"node":navigator.platform;n.isFirefox=a.includes("Firefox"),n.isLegacyEdge=a.includes("Edge"),n.isSafari=/^((?!chrome|android).)*safari/i.test(a),n.getSafariVersion=function(){if(!n.isSafari)return 0;const p=a.match(/Version\/(\d+)/);return p===null||p.length<2?0:parseInt(p[1])},n.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(u),n.isIpad=u==="iPad",n.isIphone=u==="iPhone",n.isWindows=["Windows","Win16","Win32","WinCE"].includes(u),n.isLinux=u.indexOf("Linux")>=0,n.isChromeOS=/\bCrOS\b/.test(a)},6106:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SortedList=void 0;let a=0;n.SortedList=class{constructor(u){this._getKey=u,this._array=[]}clear(){this._array.length=0}insert(u){this._array.length!==0?(a=this._search(this._getKey(u)),this._array.splice(a,0,u)):this._array.push(u)}delete(u){if(this._array.length===0)return!1;const p=this._getKey(u);if(p===void 0||(a=this._search(p),a===-1)||this._getKey(this._array[a])!==p)return!1;do if(this._array[a]===u)return this._array.splice(a,1),!0;while(++a<this._array.length&&this._getKey(this._array[a])===p);return!1}*getKeyIterator(u){if(this._array.length!==0&&(a=this._search(u),!(a<0||a>=this._array.length)&&this._getKey(this._array[a])===u))do yield this._array[a];while(++a<this._array.length&&this._getKey(this._array[a])===u)}forEachByKey(u,p){if(this._array.length!==0&&(a=this._search(u),!(a<0||a>=this._array.length)&&this._getKey(this._array[a])===u))do p(this._array[a]);while(++a<this._array.length&&this._getKey(this._array[a])===u)}values(){return[...this._array].values()}_search(u){let p=0,c=this._array.length-1;for(;c>=p;){let g=p+c>>1;const S=this._getKey(this._array[g]);if(S>u)c=g-1;else{if(!(S<u)){for(;g>0&&this._getKey(this._array[g-1])===u;)g--;return g}p=g+1}}return p}}},7226:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DebouncedIdleTask=n.IdleTaskQueue=n.PriorityTaskQueue=void 0;const u=a(6114);class p{constructor(){this._tasks=[],this._i=0}enqueue(S){this._tasks.push(S),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(S){this._idleCallback=void 0;let w=0,m=0,o=S.timeRemaining(),h=0;for(;this._i<this._tasks.length;){if(w=Date.now(),this._tasks[this._i]()||this._i++,w=Math.max(1,Date.now()-w),m=Math.max(w,m),h=S.timeRemaining(),1.5*m>h)return o-w<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(o-w))}ms`),void this._start();o=h}this.clear()}}class c extends p{_requestCallback(S){return setTimeout(()=>S(this._createDeadline(16)))}_cancelCallback(S){clearTimeout(S)}_createDeadline(S){const w=Date.now()+S;return{timeRemaining:()=>Math.max(0,w-Date.now())}}}n.PriorityTaskQueue=c,n.IdleTaskQueue=!u.isNode&&"requestIdleCallback"in window?class extends p{_requestCallback(g){return requestIdleCallback(g)}_cancelCallback(g){cancelIdleCallback(g)}}:c,n.DebouncedIdleTask=class{constructor(){this._queue=new n.IdleTaskQueue}set(g){this._queue.clear(),this._queue.enqueue(g)}flush(){this._queue.flush()}}},9282:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.updateWindowsModeWrappedState=void 0;const u=a(643);n.updateWindowsModeWrappedState=function(p){const c=p.buffer.lines.get(p.buffer.ybase+p.buffer.y-1),g=c==null?void 0:c.get(p.cols-1),S=p.buffer.lines.get(p.buffer.ybase+p.buffer.y);S&&g&&(S.isWrapped=g[u.CHAR_DATA_CODE_INDEX]!==u.NULL_CELL_CODE&&g[u.CHAR_DATA_CODE_INDEX]!==u.WHITESPACE_CELL_CODE)}},3734:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ExtendedAttrs=n.AttributeData=void 0;class a{constructor(){this.fg=0,this.bg=0,this.extended=new u}static toColorRGB(c){return[c>>>16&255,c>>>8&255,255&c]}static fromColorRGB(c){return(255&c[0])<<16|(255&c[1])<<8|255&c[2]}clone(){const c=new a;return c.fg=this.fg,c.bg=this.bg,c.extended=this.extended.clone(),c}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}n.AttributeData=a;class u{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(c){this._ext=c}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(c){this._ext&=-469762049,this._ext|=c<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(c){this._ext&=-67108864,this._ext|=67108863&c}get urlId(){return this._urlId}set urlId(c){this._urlId=c}constructor(c=0,g=0){this._ext=0,this._urlId=0,this._ext=c,this._urlId=g}clone(){return new u(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}n.ExtendedAttrs=u},9092:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Buffer=n.MAX_BUFFER_SIZE=void 0;const u=a(6349),p=a(7226),c=a(3734),g=a(8437),S=a(4634),w=a(511),m=a(643),o=a(4863),h=a(7116);n.MAX_BUFFER_SIZE=4294967295,n.Buffer=class{constructor(l,f,v){this._hasScrollback=l,this._optionsService=f,this._bufferService=v,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=g.DEFAULT_ATTR_DATA.clone(),this.savedCharset=h.DEFAULT_CHARSET,this.markers=[],this._nullCell=w.CellData.fromCharData([0,m.NULL_CELL_CHAR,m.NULL_CELL_WIDTH,m.NULL_CELL_CODE]),this._whitespaceCell=w.CellData.fromCharData([0,m.WHITESPACE_CELL_CHAR,m.WHITESPACE_CELL_WIDTH,m.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new p.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new u.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(l){return l?(this._nullCell.fg=l.fg,this._nullCell.bg=l.bg,this._nullCell.extended=l.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new c.ExtendedAttrs),this._nullCell}getWhitespaceCell(l){return l?(this._whitespaceCell.fg=l.fg,this._whitespaceCell.bg=l.bg,this._whitespaceCell.extended=l.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new c.ExtendedAttrs),this._whitespaceCell}getBlankLine(l,f){return new g.BufferLine(this._bufferService.cols,this.getNullCell(l),f)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const l=this.ybase+this.y-this.ydisp;return l>=0&&l<this._rows}_getCorrectBufferLength(l){if(!this._hasScrollback)return l;const f=l+this._optionsService.rawOptions.scrollback;return f>n.MAX_BUFFER_SIZE?n.MAX_BUFFER_SIZE:f}fillViewportRows(l){if(this.lines.length===0){l===void 0&&(l=g.DEFAULT_ATTR_DATA);let f=this._rows;for(;f--;)this.lines.push(this.getBlankLine(l))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new u.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(l,f){const v=this.getNullCell(g.DEFAULT_ATTR_DATA);let b=0;const C=this._getCorrectBufferLength(f);if(C>this.lines.maxLength&&(this.lines.maxLength=C),this.lines.length>0){if(this._cols<l)for(let y=0;y<this.lines.length;y++)b+=+this.lines.get(y).resize(l,v);let M=0;if(this._rows<f)for(let y=this._rows;y<f;y++)this.lines.length<f+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new g.BufferLine(l,v)):this.ybase>0&&this.lines.length<=this.ybase+this.y+M+1?(this.ybase--,M++,this.ydisp>0&&this.ydisp--):this.lines.push(new g.BufferLine(l,v)));else for(let y=this._rows;y>f;y--)this.lines.length>f+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(C<this.lines.maxLength){const y=this.lines.length-C;y>0&&(this.lines.trimStart(y),this.ybase=Math.max(this.ybase-y,0),this.ydisp=Math.max(this.ydisp-y,0),this.savedY=Math.max(this.savedY-y,0)),this.lines.maxLength=C}this.x=Math.min(this.x,l-1),this.y=Math.min(this.y,f-1),M&&(this.y+=M),this.savedX=Math.min(this.savedX,l-1),this.scrollTop=0}if(this.scrollBottom=f-1,this._isReflowEnabled&&(this._reflow(l,f),this._cols>l))for(let M=0;M<this.lines.length;M++)b+=+this.lines.get(M).resize(l,v);this._cols=l,this._rows=f,this._memoryCleanupQueue.clear(),b>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let l=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,l=!1);let f=0;for(;this._memoryCleanupPosition<this.lines.length;)if(f+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),f>100)return!0;return l}get _isReflowEnabled(){const l=this._optionsService.rawOptions.windowsPty;return l&&l.buildNumber?this._hasScrollback&&l.backend==="conpty"&&l.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(l,f){this._cols!==l&&(l>this._cols?this._reflowLarger(l,f):this._reflowSmaller(l,f))}_reflowLarger(l,f){const v=(0,S.reflowLargerGetLinesToRemove)(this.lines,this._cols,l,this.ybase+this.y,this.getNullCell(g.DEFAULT_ATTR_DATA));if(v.length>0){const b=(0,S.reflowLargerCreateNewLayout)(this.lines,v);(0,S.reflowLargerApplyNewLayout)(this.lines,b.layout),this._reflowLargerAdjustViewport(l,f,b.countRemoved)}}_reflowLargerAdjustViewport(l,f,v){const b=this.getNullCell(g.DEFAULT_ATTR_DATA);let C=v;for(;C-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<f&&this.lines.push(new g.BufferLine(l,b))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-v,0)}_reflowSmaller(l,f){const v=this.getNullCell(g.DEFAULT_ATTR_DATA),b=[];let C=0;for(let M=this.lines.length-1;M>=0;M--){let y=this.lines.get(M);if(!y||!y.isWrapped&&y.getTrimmedLength()<=l)continue;const E=[y];for(;y.isWrapped&&M>0;)y=this.lines.get(--M),E.unshift(y);const B=this.ybase+this.y;if(B>=M&&B<M+E.length)continue;const T=E[E.length-1].getTrimmedLength(),R=(0,S.reflowSmallerGetNewLineLengths)(E,this._cols,l),D=R.length-E.length;let I;I=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+D):Math.max(0,this.lines.length-this.lines.maxLength+D);const F=[];for(let P=0;P<D;P++){const $=this.getBlankLine(g.DEFAULT_ATTR_DATA,!0);F.push($)}F.length>0&&(b.push({start:M+E.length+C,newLines:F}),C+=F.length),E.push(...F);let W=R.length-1,H=R[W];H===0&&(W--,H=R[W]);let x=E.length-D-1,L=T;for(;x>=0;){const P=Math.min(L,H);if(E[W]===void 0)break;if(E[W].copyCellsFrom(E[x],L-P,H-P,P,!0),H-=P,H===0&&(W--,H=R[W]),L-=P,L===0){x--;const $=Math.max(x,0);L=(0,S.getWrappedLineTrimmedLength)(E,$,this._cols)}}for(let P=0;P<E.length;P++)R[P]<l&&E[P].setCell(R[P],v);let A=D-I;for(;A-- >0;)this.ybase===0?this.y<f-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+C)-f&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+D,this.ybase+f-1)}if(b.length>0){const M=[],y=[];for(let W=0;W<this.lines.length;W++)y.push(this.lines.get(W));const E=this.lines.length;let B=E-1,T=0,R=b[T];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+C);let D=0;for(let W=Math.min(this.lines.maxLength-1,E+C-1);W>=0;W--)if(R&&R.start>B+D){for(let H=R.newLines.length-1;H>=0;H--)this.lines.set(W--,R.newLines[H]);W++,M.push({index:B+1,amount:R.newLines.length}),D+=R.newLines.length,R=b[++T]}else this.lines.set(W,y[B--]);let I=0;for(let W=M.length-1;W>=0;W--)M[W].index+=I,this.lines.onInsertEmitter.fire(M[W]),I+=M[W].amount;const F=Math.max(0,E+C-this.lines.maxLength);F>0&&this.lines.onTrimEmitter.fire(F)}}translateBufferLineToString(l,f,v=0,b){const C=this.lines.get(l);return C?C.translateToString(f,v,b):""}getWrappedRangeForLine(l){let f=l,v=l;for(;f>0&&this.lines.get(f).isWrapped;)f--;for(;v+1<this.lines.length&&this.lines.get(v+1).isWrapped;)v++;return{first:f,last:v}}setupTabStops(l){for(l!=null?this.tabs[l]||(l=this.prevStop(l)):(this.tabs={},l=0);l<this._cols;l+=this._optionsService.rawOptions.tabStopWidth)this.tabs[l]=!0}prevStop(l){for(l==null&&(l=this.x);!this.tabs[--l]&&l>0;);return l>=this._cols?this._cols-1:l<0?0:l}nextStop(l){for(l==null&&(l=this.x);!this.tabs[++l]&&l<this._cols;);return l>=this._cols?this._cols-1:l<0?0:l}clearMarkers(l){this._isClearing=!0;for(let f=0;f<this.markers.length;f++)this.markers[f].line===l&&(this.markers[f].dispose(),this.markers.splice(f--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let l=0;l<this.markers.length;l++)this.markers[l].dispose(),this.markers.splice(l--,1);this._isClearing=!1}addMarker(l){const f=new o.Marker(l);return this.markers.push(f),f.register(this.lines.onTrim(v=>{f.line-=v,f.line<0&&f.dispose()})),f.register(this.lines.onInsert(v=>{f.line>=v.index&&(f.line+=v.amount)})),f.register(this.lines.onDelete(v=>{f.line>=v.index&&f.line<v.index+v.amount&&f.dispose(),f.line>v.index&&(f.line-=v.amount)})),f.register(f.onDispose(()=>this._removeMarker(f))),f}_removeMarker(l){this._isClearing||this.markers.splice(this.markers.indexOf(l),1)}}},8437:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferLine=n.DEFAULT_ATTR_DATA=void 0;const u=a(3734),p=a(511),c=a(643),g=a(482);n.DEFAULT_ATTR_DATA=Object.freeze(new u.AttributeData);let S=0;class w{constructor(o,h,l=!1){this.isWrapped=l,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*o);const f=h||p.CellData.fromCharData([0,c.NULL_CELL_CHAR,c.NULL_CELL_WIDTH,c.NULL_CELL_CODE]);for(let v=0;v<o;++v)this.setCell(v,f);this.length=o}get(o){const h=this._data[3*o+0],l=2097151&h;return[this._data[3*o+1],2097152&h?this._combined[o]:l?(0,g.stringFromCodePoint)(l):"",h>>22,2097152&h?this._combined[o].charCodeAt(this._combined[o].length-1):l]}set(o,h){this._data[3*o+1]=h[c.CHAR_DATA_ATTR_INDEX],h[c.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[o]=h[1],this._data[3*o+0]=2097152|o|h[c.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*o+0]=h[c.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|h[c.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(o){return this._data[3*o+0]>>22}hasWidth(o){return 12582912&this._data[3*o+0]}getFg(o){return this._data[3*o+1]}getBg(o){return this._data[3*o+2]}hasContent(o){return 4194303&this._data[3*o+0]}getCodePoint(o){const h=this._data[3*o+0];return 2097152&h?this._combined[o].charCodeAt(this._combined[o].length-1):2097151&h}isCombined(o){return 2097152&this._data[3*o+0]}getString(o){const h=this._data[3*o+0];return 2097152&h?this._combined[o]:2097151&h?(0,g.stringFromCodePoint)(2097151&h):""}isProtected(o){return 536870912&this._data[3*o+2]}loadCell(o,h){return S=3*o,h.content=this._data[S+0],h.fg=this._data[S+1],h.bg=this._data[S+2],2097152&h.content&&(h.combinedData=this._combined[o]),268435456&h.bg&&(h.extended=this._extendedAttrs[o]),h}setCell(o,h){2097152&h.content&&(this._combined[o]=h.combinedData),268435456&h.bg&&(this._extendedAttrs[o]=h.extended),this._data[3*o+0]=h.content,this._data[3*o+1]=h.fg,this._data[3*o+2]=h.bg}setCellFromCodePoint(o,h,l,f,v,b){268435456&v&&(this._extendedAttrs[o]=b),this._data[3*o+0]=h|l<<22,this._data[3*o+1]=f,this._data[3*o+2]=v}addCodepointToCell(o,h){let l=this._data[3*o+0];2097152&l?this._combined[o]+=(0,g.stringFromCodePoint)(h):(2097151&l?(this._combined[o]=(0,g.stringFromCodePoint)(2097151&l)+(0,g.stringFromCodePoint)(h),l&=-2097152,l|=2097152):l=h|4194304,this._data[3*o+0]=l)}insertCells(o,h,l,f){if((o%=this.length)&&this.getWidth(o-1)===2&&this.setCellFromCodePoint(o-1,0,1,(f==null?void 0:f.fg)||0,(f==null?void 0:f.bg)||0,(f==null?void 0:f.extended)||new u.ExtendedAttrs),h<this.length-o){const v=new p.CellData;for(let b=this.length-o-h-1;b>=0;--b)this.setCell(o+h+b,this.loadCell(o+b,v));for(let b=0;b<h;++b)this.setCell(o+b,l)}else for(let v=o;v<this.length;++v)this.setCell(v,l);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(f==null?void 0:f.fg)||0,(f==null?void 0:f.bg)||0,(f==null?void 0:f.extended)||new u.ExtendedAttrs)}deleteCells(o,h,l,f){if(o%=this.length,h<this.length-o){const v=new p.CellData;for(let b=0;b<this.length-o-h;++b)this.setCell(o+b,this.loadCell(o+h+b,v));for(let b=this.length-h;b<this.length;++b)this.setCell(b,l)}else for(let v=o;v<this.length;++v)this.setCell(v,l);o&&this.getWidth(o-1)===2&&this.setCellFromCodePoint(o-1,0,1,(f==null?void 0:f.fg)||0,(f==null?void 0:f.bg)||0,(f==null?void 0:f.extended)||new u.ExtendedAttrs),this.getWidth(o)!==0||this.hasContent(o)||this.setCellFromCodePoint(o,0,1,(f==null?void 0:f.fg)||0,(f==null?void 0:f.bg)||0,(f==null?void 0:f.extended)||new u.ExtendedAttrs)}replaceCells(o,h,l,f,v=!1){if(v)for(o&&this.getWidth(o-1)===2&&!this.isProtected(o-1)&&this.setCellFromCodePoint(o-1,0,1,(f==null?void 0:f.fg)||0,(f==null?void 0:f.bg)||0,(f==null?void 0:f.extended)||new u.ExtendedAttrs),h<this.length&&this.getWidth(h-1)===2&&!this.isProtected(h)&&this.setCellFromCodePoint(h,0,1,(f==null?void 0:f.fg)||0,(f==null?void 0:f.bg)||0,(f==null?void 0:f.extended)||new u.ExtendedAttrs);o<h&&o<this.length;)this.isProtected(o)||this.setCell(o,l),o++;else for(o&&this.getWidth(o-1)===2&&this.setCellFromCodePoint(o-1,0,1,(f==null?void 0:f.fg)||0,(f==null?void 0:f.bg)||0,(f==null?void 0:f.extended)||new u.ExtendedAttrs),h<this.length&&this.getWidth(h-1)===2&&this.setCellFromCodePoint(h,0,1,(f==null?void 0:f.fg)||0,(f==null?void 0:f.bg)||0,(f==null?void 0:f.extended)||new u.ExtendedAttrs);o<h&&o<this.length;)this.setCell(o++,l)}resize(o,h){if(o===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const l=3*o;if(o>this.length){if(this._data.buffer.byteLength>=4*l)this._data=new Uint32Array(this._data.buffer,0,l);else{const f=new Uint32Array(l);f.set(this._data),this._data=f}for(let f=this.length;f<o;++f)this.setCell(f,h)}else{this._data=this._data.subarray(0,l);const f=Object.keys(this._combined);for(let b=0;b<f.length;b++){const C=parseInt(f[b],10);C>=o&&delete this._combined[C]}const v=Object.keys(this._extendedAttrs);for(let b=0;b<v.length;b++){const C=parseInt(v[b],10);C>=o&&delete this._extendedAttrs[C]}}return this.length=o,4*l*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const o=new Uint32Array(this._data.length);return o.set(this._data),this._data=o,1}return 0}fill(o,h=!1){if(h)for(let l=0;l<this.length;++l)this.isProtected(l)||this.setCell(l,o);else{this._combined={},this._extendedAttrs={};for(let l=0;l<this.length;++l)this.setCell(l,o)}}copyFrom(o){this.length!==o.length?this._data=new Uint32Array(o._data):this._data.set(o._data),this.length=o.length,this._combined={};for(const h in o._combined)this._combined[h]=o._combined[h];this._extendedAttrs={};for(const h in o._extendedAttrs)this._extendedAttrs[h]=o._extendedAttrs[h];this.isWrapped=o.isWrapped}clone(){const o=new w(0);o._data=new Uint32Array(this._data),o.length=this.length;for(const h in this._combined)o._combined[h]=this._combined[h];for(const h in this._extendedAttrs)o._extendedAttrs[h]=this._extendedAttrs[h];return o.isWrapped=this.isWrapped,o}getTrimmedLength(){for(let o=this.length-1;o>=0;--o)if(4194303&this._data[3*o+0])return o+(this._data[3*o+0]>>22);return 0}getNoBgTrimmedLength(){for(let o=this.length-1;o>=0;--o)if(4194303&this._data[3*o+0]||50331648&this._data[3*o+2])return o+(this._data[3*o+0]>>22);return 0}copyCellsFrom(o,h,l,f,v){const b=o._data;if(v)for(let M=f-1;M>=0;M--){for(let y=0;y<3;y++)this._data[3*(l+M)+y]=b[3*(h+M)+y];268435456&b[3*(h+M)+2]&&(this._extendedAttrs[l+M]=o._extendedAttrs[h+M])}else for(let M=0;M<f;M++){for(let y=0;y<3;y++)this._data[3*(l+M)+y]=b[3*(h+M)+y];268435456&b[3*(h+M)+2]&&(this._extendedAttrs[l+M]=o._extendedAttrs[h+M])}const C=Object.keys(o._combined);for(let M=0;M<C.length;M++){const y=parseInt(C[M],10);y>=h&&(this._combined[y-h+l]=o._combined[y])}}translateToString(o=!1,h=0,l=this.length){o&&(l=Math.min(l,this.getTrimmedLength()));let f="";for(;h<l;){const v=this._data[3*h+0],b=2097151&v;f+=2097152&v?this._combined[h]:b?(0,g.stringFromCodePoint)(b):c.WHITESPACE_CELL_CHAR,h+=v>>22||1}return f}}n.BufferLine=w},4841:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getRangeLength=void 0,n.getRangeLength=function(a,u){if(a.start.y>a.end.y)throw new Error(`Buffer range end (${a.end.x}, ${a.end.y}) cannot be before start (${a.start.x}, ${a.start.y})`);return u*(a.end.y-a.start.y)+(a.end.x-a.start.x+1)}},4634:(_,n)=>{function a(u,p,c){if(p===u.length-1)return u[p].getTrimmedLength();const g=!u[p].hasContent(c-1)&&u[p].getWidth(c-1)===1,S=u[p+1].getWidth(0)===2;return g&&S?c-1:c}Object.defineProperty(n,"__esModule",{value:!0}),n.getWrappedLineTrimmedLength=n.reflowSmallerGetNewLineLengths=n.reflowLargerApplyNewLayout=n.reflowLargerCreateNewLayout=n.reflowLargerGetLinesToRemove=void 0,n.reflowLargerGetLinesToRemove=function(u,p,c,g,S){const w=[];for(let m=0;m<u.length-1;m++){let o=m,h=u.get(++o);if(!h.isWrapped)continue;const l=[u.get(m)];for(;o<u.length&&h.isWrapped;)l.push(h),h=u.get(++o);if(g>=m&&g<o){m+=l.length-1;continue}let f=0,v=a(l,f,p),b=1,C=0;for(;b<l.length;){const y=a(l,b,p),E=y-C,B=c-v,T=Math.min(E,B);l[f].copyCellsFrom(l[b],C,v,T,!1),v+=T,v===c&&(f++,v=0),C+=T,C===y&&(b++,C=0),v===0&&f!==0&&l[f-1].getWidth(c-1)===2&&(l[f].copyCellsFrom(l[f-1],c-1,v++,1,!1),l[f-1].setCell(c-1,S))}l[f].replaceCells(v,c,S);let M=0;for(let y=l.length-1;y>0&&(y>f||l[y].getTrimmedLength()===0);y--)M++;M>0&&(w.push(m+l.length-M),w.push(M)),m+=l.length-1}return w},n.reflowLargerCreateNewLayout=function(u,p){const c=[];let g=0,S=p[g],w=0;for(let m=0;m<u.length;m++)if(S===m){const o=p[++g];u.onDeleteEmitter.fire({index:m-w,amount:o}),m+=o-1,w+=o,S=p[++g]}else c.push(m);return{layout:c,countRemoved:w}},n.reflowLargerApplyNewLayout=function(u,p){const c=[];for(let g=0;g<p.length;g++)c.push(u.get(p[g]));for(let g=0;g<c.length;g++)u.set(g,c[g]);u.length=p.length},n.reflowSmallerGetNewLineLengths=function(u,p,c){const g=[],S=u.map((h,l)=>a(u,l,p)).reduce((h,l)=>h+l);let w=0,m=0,o=0;for(;o<S;){if(S-o<c){g.push(S-o);break}w+=c;const h=a(u,m,p);w>h&&(w-=h,m++);const l=u[m].getWidth(w-1)===2;l&&w--;const f=l?c-1:c;g.push(f),o+=f}return g},n.getWrappedLineTrimmedLength=a},5295:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferSet=void 0;const u=a(8460),p=a(844),c=a(9092);class g extends p.Disposable{constructor(w,m){super(),this._optionsService=w,this._bufferService=m,this._onBufferActivate=this.register(new u.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new c.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new c.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(w){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(w),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(w,m){this._normal.resize(w,m),this._alt.resize(w,m),this.setupTabStops(w)}setupTabStops(w){this._normal.setupTabStops(w),this._alt.setupTabStops(w)}}n.BufferSet=g},511:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CellData=void 0;const u=a(482),p=a(643),c=a(3734);class g extends c.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new c.ExtendedAttrs,this.combinedData=""}static fromCharData(w){const m=new g;return m.setFromCharData(w),m}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,u.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(w){this.fg=w[p.CHAR_DATA_ATTR_INDEX],this.bg=0;let m=!1;if(w[p.CHAR_DATA_CHAR_INDEX].length>2)m=!0;else if(w[p.CHAR_DATA_CHAR_INDEX].length===2){const o=w[p.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=o&&o<=56319){const h=w[p.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=h&&h<=57343?this.content=1024*(o-55296)+h-56320+65536|w[p.CHAR_DATA_WIDTH_INDEX]<<22:m=!0}else m=!0}else this.content=w[p.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|w[p.CHAR_DATA_WIDTH_INDEX]<<22;m&&(this.combinedData=w[p.CHAR_DATA_CHAR_INDEX],this.content=2097152|w[p.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}n.CellData=g},643:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WHITESPACE_CELL_CODE=n.WHITESPACE_CELL_WIDTH=n.WHITESPACE_CELL_CHAR=n.NULL_CELL_CODE=n.NULL_CELL_WIDTH=n.NULL_CELL_CHAR=n.CHAR_DATA_CODE_INDEX=n.CHAR_DATA_WIDTH_INDEX=n.CHAR_DATA_CHAR_INDEX=n.CHAR_DATA_ATTR_INDEX=n.DEFAULT_EXT=n.DEFAULT_ATTR=n.DEFAULT_COLOR=void 0,n.DEFAULT_COLOR=0,n.DEFAULT_ATTR=256|n.DEFAULT_COLOR<<9,n.DEFAULT_EXT=0,n.CHAR_DATA_ATTR_INDEX=0,n.CHAR_DATA_CHAR_INDEX=1,n.CHAR_DATA_WIDTH_INDEX=2,n.CHAR_DATA_CODE_INDEX=3,n.NULL_CELL_CHAR="",n.NULL_CELL_WIDTH=1,n.NULL_CELL_CODE=0,n.WHITESPACE_CELL_CHAR=" ",n.WHITESPACE_CELL_WIDTH=1,n.WHITESPACE_CELL_CODE=32},4863:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Marker=void 0;const u=a(8460),p=a(844);class c{get id(){return this._id}constructor(S){this.line=S,this.isDisposed=!1,this._disposables=[],this._id=c._nextId++,this._onDispose=this.register(new u.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,p.disposeArray)(this._disposables),this._disposables.length=0)}register(S){return this._disposables.push(S),S}}n.Marker=c,c._nextId=1},7116:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DEFAULT_CHARSET=n.CHARSETS=void 0,n.CHARSETS={},n.DEFAULT_CHARSET=n.CHARSETS.B,n.CHARSETS[0]={"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},n.CHARSETS.A={"#":"£"},n.CHARSETS.B=void 0,n.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},n.CHARSETS.C=n.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},n.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},n.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},n.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},n.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},n.CHARSETS.E=n.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},n.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},n.CHARSETS.H=n.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},n.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},2584:(_,n)=>{var a,u,p;Object.defineProperty(n,"__esModule",{value:!0}),n.C1_ESCAPED=n.C1=n.C0=void 0,function(c){c.NUL="\0",c.SOH="",c.STX="",c.ETX="",c.EOT="",c.ENQ="",c.ACK="",c.BEL="\x07",c.BS="\b",c.HT="	",c.LF=`
`,c.VT="\v",c.FF="\f",c.CR="\r",c.SO="",c.SI="",c.DLE="",c.DC1="",c.DC2="",c.DC3="",c.DC4="",c.NAK="",c.SYN="",c.ETB="",c.CAN="",c.EM="",c.SUB="",c.ESC="\x1B",c.FS="",c.GS="",c.RS="",c.US="",c.SP=" ",c.DEL=""}(a||(n.C0=a={})),function(c){c.PAD="",c.HOP="",c.BPH="",c.NBH="",c.IND="",c.NEL="",c.SSA="",c.ESA="",c.HTS="",c.HTJ="",c.VTS="",c.PLD="",c.PLU="",c.RI="",c.SS2="",c.SS3="",c.DCS="",c.PU1="",c.PU2="",c.STS="",c.CCH="",c.MW="",c.SPA="",c.EPA="",c.SOS="",c.SGCI="",c.SCI="",c.CSI="",c.ST="",c.OSC="",c.PM="",c.APC=""}(u||(n.C1=u={})),function(c){c.ST=`${a.ESC}\\`}(p||(n.C1_ESCAPED=p={}))},7399:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.evaluateKeyboardEvent=void 0;const u=a(2584),p={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};n.evaluateKeyboardEvent=function(c,g,S,w){const m={type:0,cancel:!1,key:void 0},o=(c.shiftKey?1:0)|(c.altKey?2:0)|(c.ctrlKey?4:0)|(c.metaKey?8:0);switch(c.keyCode){case 0:c.key==="UIKeyInputUpArrow"?m.key=g?u.C0.ESC+"OA":u.C0.ESC+"[A":c.key==="UIKeyInputLeftArrow"?m.key=g?u.C0.ESC+"OD":u.C0.ESC+"[D":c.key==="UIKeyInputRightArrow"?m.key=g?u.C0.ESC+"OC":u.C0.ESC+"[C":c.key==="UIKeyInputDownArrow"&&(m.key=g?u.C0.ESC+"OB":u.C0.ESC+"[B");break;case 8:if(c.altKey){m.key=u.C0.ESC+u.C0.DEL;break}m.key=u.C0.DEL;break;case 9:if(c.shiftKey){m.key=u.C0.ESC+"[Z";break}m.key=u.C0.HT,m.cancel=!0;break;case 13:m.key=c.altKey?u.C0.ESC+u.C0.CR:u.C0.CR,m.cancel=!0;break;case 27:m.key=u.C0.ESC,c.altKey&&(m.key=u.C0.ESC+u.C0.ESC),m.cancel=!0;break;case 37:if(c.metaKey)break;o?(m.key=u.C0.ESC+"[1;"+(o+1)+"D",m.key===u.C0.ESC+"[1;3D"&&(m.key=u.C0.ESC+(S?"b":"[1;5D"))):m.key=g?u.C0.ESC+"OD":u.C0.ESC+"[D";break;case 39:if(c.metaKey)break;o?(m.key=u.C0.ESC+"[1;"+(o+1)+"C",m.key===u.C0.ESC+"[1;3C"&&(m.key=u.C0.ESC+(S?"f":"[1;5C"))):m.key=g?u.C0.ESC+"OC":u.C0.ESC+"[C";break;case 38:if(c.metaKey)break;o?(m.key=u.C0.ESC+"[1;"+(o+1)+"A",S||m.key!==u.C0.ESC+"[1;3A"||(m.key=u.C0.ESC+"[1;5A")):m.key=g?u.C0.ESC+"OA":u.C0.ESC+"[A";break;case 40:if(c.metaKey)break;o?(m.key=u.C0.ESC+"[1;"+(o+1)+"B",S||m.key!==u.C0.ESC+"[1;3B"||(m.key=u.C0.ESC+"[1;5B")):m.key=g?u.C0.ESC+"OB":u.C0.ESC+"[B";break;case 45:c.shiftKey||c.ctrlKey||(m.key=u.C0.ESC+"[2~");break;case 46:m.key=o?u.C0.ESC+"[3;"+(o+1)+"~":u.C0.ESC+"[3~";break;case 36:m.key=o?u.C0.ESC+"[1;"+(o+1)+"H":g?u.C0.ESC+"OH":u.C0.ESC+"[H";break;case 35:m.key=o?u.C0.ESC+"[1;"+(o+1)+"F":g?u.C0.ESC+"OF":u.C0.ESC+"[F";break;case 33:c.shiftKey?m.type=2:c.ctrlKey?m.key=u.C0.ESC+"[5;"+(o+1)+"~":m.key=u.C0.ESC+"[5~";break;case 34:c.shiftKey?m.type=3:c.ctrlKey?m.key=u.C0.ESC+"[6;"+(o+1)+"~":m.key=u.C0.ESC+"[6~";break;case 112:m.key=o?u.C0.ESC+"[1;"+(o+1)+"P":u.C0.ESC+"OP";break;case 113:m.key=o?u.C0.ESC+"[1;"+(o+1)+"Q":u.C0.ESC+"OQ";break;case 114:m.key=o?u.C0.ESC+"[1;"+(o+1)+"R":u.C0.ESC+"OR";break;case 115:m.key=o?u.C0.ESC+"[1;"+(o+1)+"S":u.C0.ESC+"OS";break;case 116:m.key=o?u.C0.ESC+"[15;"+(o+1)+"~":u.C0.ESC+"[15~";break;case 117:m.key=o?u.C0.ESC+"[17;"+(o+1)+"~":u.C0.ESC+"[17~";break;case 118:m.key=o?u.C0.ESC+"[18;"+(o+1)+"~":u.C0.ESC+"[18~";break;case 119:m.key=o?u.C0.ESC+"[19;"+(o+1)+"~":u.C0.ESC+"[19~";break;case 120:m.key=o?u.C0.ESC+"[20;"+(o+1)+"~":u.C0.ESC+"[20~";break;case 121:m.key=o?u.C0.ESC+"[21;"+(o+1)+"~":u.C0.ESC+"[21~";break;case 122:m.key=o?u.C0.ESC+"[23;"+(o+1)+"~":u.C0.ESC+"[23~";break;case 123:m.key=o?u.C0.ESC+"[24;"+(o+1)+"~":u.C0.ESC+"[24~";break;default:if(!c.ctrlKey||c.shiftKey||c.altKey||c.metaKey)if(S&&!w||!c.altKey||c.metaKey)!S||c.altKey||c.ctrlKey||c.shiftKey||!c.metaKey?c.key&&!c.ctrlKey&&!c.altKey&&!c.metaKey&&c.keyCode>=48&&c.key.length===1?m.key=c.key:c.key&&c.ctrlKey&&(c.key==="_"&&(m.key=u.C0.US),c.key==="@"&&(m.key=u.C0.NUL)):c.keyCode===65&&(m.type=1);else{const h=p[c.keyCode],l=h==null?void 0:h[c.shiftKey?1:0];if(l)m.key=u.C0.ESC+l;else if(c.keyCode>=65&&c.keyCode<=90){const f=c.ctrlKey?c.keyCode-64:c.keyCode+32;let v=String.fromCharCode(f);c.shiftKey&&(v=v.toUpperCase()),m.key=u.C0.ESC+v}else if(c.keyCode===32)m.key=u.C0.ESC+(c.ctrlKey?u.C0.NUL:" ");else if(c.key==="Dead"&&c.code.startsWith("Key")){let f=c.code.slice(3,4);c.shiftKey||(f=f.toLowerCase()),m.key=u.C0.ESC+f,m.cancel=!0}}else c.keyCode>=65&&c.keyCode<=90?m.key=String.fromCharCode(c.keyCode-64):c.keyCode===32?m.key=u.C0.NUL:c.keyCode>=51&&c.keyCode<=55?m.key=String.fromCharCode(c.keyCode-51+27):c.keyCode===56?m.key=u.C0.DEL:c.keyCode===219?m.key=u.C0.ESC:c.keyCode===220?m.key=u.C0.FS:c.keyCode===221&&(m.key=u.C0.GS)}return m}},482:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Utf8ToUtf32=n.StringToUtf32=n.utf32ToString=n.stringFromCodePoint=void 0,n.stringFromCodePoint=function(a){return a>65535?(a-=65536,String.fromCharCode(55296+(a>>10))+String.fromCharCode(a%1024+56320)):String.fromCharCode(a)},n.utf32ToString=function(a,u=0,p=a.length){let c="";for(let g=u;g<p;++g){let S=a[g];S>65535?(S-=65536,c+=String.fromCharCode(55296+(S>>10))+String.fromCharCode(S%1024+56320)):c+=String.fromCharCode(S)}return c},n.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(a,u){const p=a.length;if(!p)return 0;let c=0,g=0;if(this._interim){const S=a.charCodeAt(g++);56320<=S&&S<=57343?u[c++]=1024*(this._interim-55296)+S-56320+65536:(u[c++]=this._interim,u[c++]=S),this._interim=0}for(let S=g;S<p;++S){const w=a.charCodeAt(S);if(55296<=w&&w<=56319){if(++S>=p)return this._interim=w,c;const m=a.charCodeAt(S);56320<=m&&m<=57343?u[c++]=1024*(w-55296)+m-56320+65536:(u[c++]=w,u[c++]=m)}else w!==65279&&(u[c++]=w)}return c}},n.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(a,u){const p=a.length;if(!p)return 0;let c,g,S,w,m=0,o=0,h=0;if(this.interim[0]){let v=!1,b=this.interim[0];b&=(224&b)==192?31:(240&b)==224?15:7;let C,M=0;for(;(C=63&this.interim[++M])&&M<4;)b<<=6,b|=C;const y=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,E=y-M;for(;h<E;){if(h>=p)return 0;if(C=a[h++],(192&C)!=128){h--,v=!0;break}this.interim[M++]=C,b<<=6,b|=63&C}v||(y===2?b<128?h--:u[m++]=b:y===3?b<2048||b>=55296&&b<=57343||b===65279||(u[m++]=b):b<65536||b>1114111||(u[m++]=b)),this.interim.fill(0)}const l=p-4;let f=h;for(;f<p;){for(;!(!(f<l)||128&(c=a[f])||128&(g=a[f+1])||128&(S=a[f+2])||128&(w=a[f+3]));)u[m++]=c,u[m++]=g,u[m++]=S,u[m++]=w,f+=4;if(c=a[f++],c<128)u[m++]=c;else if((224&c)==192){if(f>=p)return this.interim[0]=c,m;if(g=a[f++],(192&g)!=128){f--;continue}if(o=(31&c)<<6|63&g,o<128){f--;continue}u[m++]=o}else if((240&c)==224){if(f>=p)return this.interim[0]=c,m;if(g=a[f++],(192&g)!=128){f--;continue}if(f>=p)return this.interim[0]=c,this.interim[1]=g,m;if(S=a[f++],(192&S)!=128){f--;continue}if(o=(15&c)<<12|(63&g)<<6|63&S,o<2048||o>=55296&&o<=57343||o===65279)continue;u[m++]=o}else if((248&c)==240){if(f>=p)return this.interim[0]=c,m;if(g=a[f++],(192&g)!=128){f--;continue}if(f>=p)return this.interim[0]=c,this.interim[1]=g,m;if(S=a[f++],(192&S)!=128){f--;continue}if(f>=p)return this.interim[0]=c,this.interim[1]=g,this.interim[2]=S,m;if(w=a[f++],(192&w)!=128){f--;continue}if(o=(7&c)<<18|(63&g)<<12|(63&S)<<6|63&w,o<65536||o>1114111)continue;u[m++]=o}}return m}}},225:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeV6=void 0;const a=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],u=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let p;n.UnicodeV6=class{constructor(){if(this.version="6",!p){p=new Uint8Array(65536),p.fill(1),p[0]=0,p.fill(0,1,32),p.fill(0,127,160),p.fill(2,4352,4448),p[9001]=2,p[9002]=2,p.fill(2,11904,42192),p[12351]=1,p.fill(2,44032,55204),p.fill(2,63744,64256),p.fill(2,65040,65050),p.fill(2,65072,65136),p.fill(2,65280,65377),p.fill(2,65504,65511);for(let c=0;c<a.length;++c)p.fill(0,a[c][0],a[c][1]+1)}}wcwidth(c){return c<32?0:c<127?1:c<65536?p[c]:function(g,S){let w,m=0,o=S.length-1;if(g<S[0][0]||g>S[o][1])return!1;for(;o>=m;)if(w=m+o>>1,g>S[w][1])m=w+1;else{if(!(g<S[w][0]))return!0;o=w-1}return!1}(c,u)?0:c>=131072&&c<=196605||c>=196608&&c<=262141?2:1}}},5981:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WriteBuffer=void 0;const u=a(8460),p=a(844);class c extends p.Disposable{constructor(S){super(),this._action=S,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new u.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(S,w){if(w!==void 0&&this._syncCalls>w)return void(this._syncCalls=0);if(this._pendingData+=S.length,this._writeBuffer.push(S),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let m;for(this._isSyncWriting=!0;m=this._writeBuffer.shift();){this._action(m);const o=this._callbacks.shift();o&&o()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(S,w){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=S.length,this._writeBuffer.push(S),this._callbacks.push(w),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=S.length,this._writeBuffer.push(S),this._callbacks.push(w)}_innerWrite(S=0,w=!0){const m=S||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const o=this._writeBuffer[this._bufferOffset],h=this._action(o,w);if(h){const f=v=>Date.now()-m>=12?setTimeout(()=>this._innerWrite(0,v)):this._innerWrite(m,v);return void h.catch(v=>(queueMicrotask(()=>{throw v}),Promise.resolve(!1))).then(f)}const l=this._callbacks[this._bufferOffset];if(l&&l(),this._bufferOffset++,this._pendingData-=o.length,Date.now()-m>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}n.WriteBuffer=c},5941:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.toRgbString=n.parseColor=void 0;const a=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,u=/^[\da-f]+$/;function p(c,g){const S=c.toString(16),w=S.length<2?"0"+S:S;switch(g){case 4:return S[0];case 8:return w;case 12:return(w+w).slice(0,3);default:return w+w}}n.parseColor=function(c){if(!c)return;let g=c.toLowerCase();if(g.indexOf("rgb:")===0){g=g.slice(4);const S=a.exec(g);if(S){const w=S[1]?15:S[4]?255:S[7]?4095:65535;return[Math.round(parseInt(S[1]||S[4]||S[7]||S[10],16)/w*255),Math.round(parseInt(S[2]||S[5]||S[8]||S[11],16)/w*255),Math.round(parseInt(S[3]||S[6]||S[9]||S[12],16)/w*255)]}}else if(g.indexOf("#")===0&&(g=g.slice(1),u.exec(g)&&[3,6,9,12].includes(g.length))){const S=g.length/3,w=[0,0,0];for(let m=0;m<3;++m){const o=parseInt(g.slice(S*m,S*m+S),16);w[m]=S===1?o<<4:S===2?o:S===3?o>>4:o>>8}return w}},n.toRgbString=function(c,g=16){const[S,w,m]=c;return`rgb:${p(S,g)}/${p(w,g)}/${p(m,g)}`}},5770:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PAYLOAD_LIMIT=void 0,n.PAYLOAD_LIMIT=1e7},6351:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DcsHandler=n.DcsParser=void 0;const u=a(482),p=a(8742),c=a(5770),g=[];n.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=g,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=g}registerHandler(w,m){this._handlers[w]===void 0&&(this._handlers[w]=[]);const o=this._handlers[w];return o.push(m),{dispose:()=>{const h=o.indexOf(m);h!==-1&&o.splice(h,1)}}}clearHandler(w){this._handlers[w]&&delete this._handlers[w]}setHandlerFallback(w){this._handlerFb=w}reset(){if(this._active.length)for(let w=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;w>=0;--w)this._active[w].unhook(!1);this._stack.paused=!1,this._active=g,this._ident=0}hook(w,m){if(this.reset(),this._ident=w,this._active=this._handlers[w]||g,this._active.length)for(let o=this._active.length-1;o>=0;o--)this._active[o].hook(m);else this._handlerFb(this._ident,"HOOK",m)}put(w,m,o){if(this._active.length)for(let h=this._active.length-1;h>=0;h--)this._active[h].put(w,m,o);else this._handlerFb(this._ident,"PUT",(0,u.utf32ToString)(w,m,o))}unhook(w,m=!0){if(this._active.length){let o=!1,h=this._active.length-1,l=!1;if(this._stack.paused&&(h=this._stack.loopPosition-1,o=m,l=this._stack.fallThrough,this._stack.paused=!1),!l&&o===!1){for(;h>=0&&(o=this._active[h].unhook(w),o!==!0);h--)if(o instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=h,this._stack.fallThrough=!1,o;h--}for(;h>=0;h--)if(o=this._active[h].unhook(!1),o instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=h,this._stack.fallThrough=!0,o}else this._handlerFb(this._ident,"UNHOOK",w);this._active=g,this._ident=0}};const S=new p.Params;S.addParam(0),n.DcsHandler=class{constructor(w){this._handler=w,this._data="",this._params=S,this._hitLimit=!1}hook(w){this._params=w.length>1||w.params[0]?w.clone():S,this._data="",this._hitLimit=!1}put(w,m,o){this._hitLimit||(this._data+=(0,u.utf32ToString)(w,m,o),this._data.length>c.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(w){let m=!1;if(this._hitLimit)m=!1;else if(w&&(m=this._handler(this._data,this._params),m instanceof Promise))return m.then(o=>(this._params=S,this._data="",this._hitLimit=!1,o));return this._params=S,this._data="",this._hitLimit=!1,m}}},2015:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.EscapeSequenceParser=n.VT500_TRANSITION_TABLE=n.TransitionTable=void 0;const u=a(844),p=a(8742),c=a(6242),g=a(6351);class S{constructor(h){this.table=new Uint8Array(h)}setDefault(h,l){this.table.fill(h<<4|l)}add(h,l,f,v){this.table[l<<8|h]=f<<4|v}addMany(h,l,f,v){for(let b=0;b<h.length;b++)this.table[l<<8|h[b]]=f<<4|v}}n.TransitionTable=S;const w=160;n.VT500_TRANSITION_TABLE=function(){const o=new S(4095),h=Array.apply(null,Array(256)).map((M,y)=>y),l=(M,y)=>h.slice(M,y),f=l(32,127),v=l(0,24);v.push(25),v.push.apply(v,l(28,32));const b=l(0,14);let C;for(C in o.setDefault(1,0),o.addMany(f,0,2,0),b)o.addMany([24,26,153,154],C,3,0),o.addMany(l(128,144),C,3,0),o.addMany(l(144,152),C,3,0),o.add(156,C,0,0),o.add(27,C,11,1),o.add(157,C,4,8),o.addMany([152,158,159],C,0,7),o.add(155,C,11,3),o.add(144,C,11,9);return o.addMany(v,0,3,0),o.addMany(v,1,3,1),o.add(127,1,0,1),o.addMany(v,8,0,8),o.addMany(v,3,3,3),o.add(127,3,0,3),o.addMany(v,4,3,4),o.add(127,4,0,4),o.addMany(v,6,3,6),o.addMany(v,5,3,5),o.add(127,5,0,5),o.addMany(v,2,3,2),o.add(127,2,0,2),o.add(93,1,4,8),o.addMany(f,8,5,8),o.add(127,8,5,8),o.addMany([156,27,24,26,7],8,6,0),o.addMany(l(28,32),8,0,8),o.addMany([88,94,95],1,0,7),o.addMany(f,7,0,7),o.addMany(v,7,0,7),o.add(156,7,0,0),o.add(127,7,0,7),o.add(91,1,11,3),o.addMany(l(64,127),3,7,0),o.addMany(l(48,60),3,8,4),o.addMany([60,61,62,63],3,9,4),o.addMany(l(48,60),4,8,4),o.addMany(l(64,127),4,7,0),o.addMany([60,61,62,63],4,0,6),o.addMany(l(32,64),6,0,6),o.add(127,6,0,6),o.addMany(l(64,127),6,0,0),o.addMany(l(32,48),3,9,5),o.addMany(l(32,48),5,9,5),o.addMany(l(48,64),5,0,6),o.addMany(l(64,127),5,7,0),o.addMany(l(32,48),4,9,5),o.addMany(l(32,48),1,9,2),o.addMany(l(32,48),2,9,2),o.addMany(l(48,127),2,10,0),o.addMany(l(48,80),1,10,0),o.addMany(l(81,88),1,10,0),o.addMany([89,90,92],1,10,0),o.addMany(l(96,127),1,10,0),o.add(80,1,11,9),o.addMany(v,9,0,9),o.add(127,9,0,9),o.addMany(l(28,32),9,0,9),o.addMany(l(32,48),9,9,12),o.addMany(l(48,60),9,8,10),o.addMany([60,61,62,63],9,9,10),o.addMany(v,11,0,11),o.addMany(l(32,128),11,0,11),o.addMany(l(28,32),11,0,11),o.addMany(v,10,0,10),o.add(127,10,0,10),o.addMany(l(28,32),10,0,10),o.addMany(l(48,60),10,8,10),o.addMany([60,61,62,63],10,0,11),o.addMany(l(32,48),10,9,12),o.addMany(v,12,0,12),o.add(127,12,0,12),o.addMany(l(28,32),12,0,12),o.addMany(l(32,48),12,9,12),o.addMany(l(48,64),12,0,11),o.addMany(l(64,127),12,12,13),o.addMany(l(64,127),10,12,13),o.addMany(l(64,127),9,12,13),o.addMany(v,13,13,13),o.addMany(f,13,13,13),o.add(127,13,0,13),o.addMany([27,156,24,26],13,14,0),o.add(w,0,2,0),o.add(w,8,5,8),o.add(w,6,0,6),o.add(w,11,0,11),o.add(w,13,13,13),o}();class m extends u.Disposable{constructor(h=n.VT500_TRANSITION_TABLE){super(),this._transitions=h,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new p.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(l,f,v)=>{},this._executeHandlerFb=l=>{},this._csiHandlerFb=(l,f)=>{},this._escHandlerFb=l=>{},this._errorHandlerFb=l=>l,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,u.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new c.OscParser),this._dcsParser=this.register(new g.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(h,l=[64,126]){let f=0;if(h.prefix){if(h.prefix.length>1)throw new Error("only one byte as prefix supported");if(f=h.prefix.charCodeAt(0),f&&60>f||f>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(h.intermediates){if(h.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let b=0;b<h.intermediates.length;++b){const C=h.intermediates.charCodeAt(b);if(32>C||C>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");f<<=8,f|=C}}if(h.final.length!==1)throw new Error("final must be a single byte");const v=h.final.charCodeAt(0);if(l[0]>v||v>l[1])throw new Error(`final must be in range ${l[0]} .. ${l[1]}`);return f<<=8,f|=v,f}identToString(h){const l=[];for(;h;)l.push(String.fromCharCode(255&h)),h>>=8;return l.reverse().join("")}setPrintHandler(h){this._printHandler=h}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(h,l){const f=this._identifier(h,[48,126]);this._escHandlers[f]===void 0&&(this._escHandlers[f]=[]);const v=this._escHandlers[f];return v.push(l),{dispose:()=>{const b=v.indexOf(l);b!==-1&&v.splice(b,1)}}}clearEscHandler(h){this._escHandlers[this._identifier(h,[48,126])]&&delete this._escHandlers[this._identifier(h,[48,126])]}setEscHandlerFallback(h){this._escHandlerFb=h}setExecuteHandler(h,l){this._executeHandlers[h.charCodeAt(0)]=l}clearExecuteHandler(h){this._executeHandlers[h.charCodeAt(0)]&&delete this._executeHandlers[h.charCodeAt(0)]}setExecuteHandlerFallback(h){this._executeHandlerFb=h}registerCsiHandler(h,l){const f=this._identifier(h);this._csiHandlers[f]===void 0&&(this._csiHandlers[f]=[]);const v=this._csiHandlers[f];return v.push(l),{dispose:()=>{const b=v.indexOf(l);b!==-1&&v.splice(b,1)}}}clearCsiHandler(h){this._csiHandlers[this._identifier(h)]&&delete this._csiHandlers[this._identifier(h)]}setCsiHandlerFallback(h){this._csiHandlerFb=h}registerDcsHandler(h,l){return this._dcsParser.registerHandler(this._identifier(h),l)}clearDcsHandler(h){this._dcsParser.clearHandler(this._identifier(h))}setDcsHandlerFallback(h){this._dcsParser.setHandlerFallback(h)}registerOscHandler(h,l){return this._oscParser.registerHandler(h,l)}clearOscHandler(h){this._oscParser.clearHandler(h)}setOscHandlerFallback(h){this._oscParser.setHandlerFallback(h)}setErrorHandler(h){this._errorHandler=h}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(h,l,f,v,b){this._parseStack.state=h,this._parseStack.handlers=l,this._parseStack.handlerPos=f,this._parseStack.transition=v,this._parseStack.chunkPos=b}parse(h,l,f){let v,b=0,C=0,M=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,M=this._parseStack.chunkPos+1;else{if(f===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const y=this._parseStack.handlers;let E=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(f===!1&&E>-1){for(;E>=0&&(v=y[E](this._params),v!==!0);E--)if(v instanceof Promise)return this._parseStack.handlerPos=E,v}this._parseStack.handlers=[];break;case 4:if(f===!1&&E>-1){for(;E>=0&&(v=y[E](),v!==!0);E--)if(v instanceof Promise)return this._parseStack.handlerPos=E,v}this._parseStack.handlers=[];break;case 6:if(b=h[this._parseStack.chunkPos],v=this._dcsParser.unhook(b!==24&&b!==26,f),v)return v;b===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(b=h[this._parseStack.chunkPos],v=this._oscParser.end(b!==24&&b!==26,f),v)return v;b===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,M=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let y=M;y<l;++y){switch(b=h[y],C=this._transitions.table[this.currentState<<8|(b<160?b:w)],C>>4){case 2:for(let D=y+1;;++D){if(D>=l||(b=h[D])<32||b>126&&b<w){this._printHandler(h,y,D),y=D-1;break}if(++D>=l||(b=h[D])<32||b>126&&b<w){this._printHandler(h,y,D),y=D-1;break}if(++D>=l||(b=h[D])<32||b>126&&b<w){this._printHandler(h,y,D),y=D-1;break}if(++D>=l||(b=h[D])<32||b>126&&b<w){this._printHandler(h,y,D),y=D-1;break}}break;case 3:this._executeHandlers[b]?this._executeHandlers[b]():this._executeHandlerFb(b),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:y,code:b,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const E=this._csiHandlers[this._collect<<8|b];let B=E?E.length-1:-1;for(;B>=0&&(v=E[B](this._params),v!==!0);B--)if(v instanceof Promise)return this._preserveStack(3,E,B,C,y),v;B<0&&this._csiHandlerFb(this._collect<<8|b,this._params),this.precedingCodepoint=0;break;case 8:do switch(b){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(b-48)}while(++y<l&&(b=h[y])>47&&b<60);y--;break;case 9:this._collect<<=8,this._collect|=b;break;case 10:const T=this._escHandlers[this._collect<<8|b];let R=T?T.length-1:-1;for(;R>=0&&(v=T[R](),v!==!0);R--)if(v instanceof Promise)return this._preserveStack(4,T,R,C,y),v;R<0&&this._escHandlerFb(this._collect<<8|b),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|b,this._params);break;case 13:for(let D=y+1;;++D)if(D>=l||(b=h[D])===24||b===26||b===27||b>127&&b<w){this._dcsParser.put(h,y,D),y=D-1;break}break;case 14:if(v=this._dcsParser.unhook(b!==24&&b!==26),v)return this._preserveStack(6,[],0,C,y),v;b===27&&(C|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let D=y+1;;D++)if(D>=l||(b=h[D])<32||b>127&&b<w){this._oscParser.put(h,y,D),y=D-1;break}break;case 6:if(v=this._oscParser.end(b!==24&&b!==26),v)return this._preserveStack(5,[],0,C,y),v;b===27&&(C|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&C}}}n.EscapeSequenceParser=m},6242:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.OscHandler=n.OscParser=void 0;const u=a(5770),p=a(482),c=[];n.OscParser=class{constructor(){this._state=0,this._active=c,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(g,S){this._handlers[g]===void 0&&(this._handlers[g]=[]);const w=this._handlers[g];return w.push(S),{dispose:()=>{const m=w.indexOf(S);m!==-1&&w.splice(m,1)}}}clearHandler(g){this._handlers[g]&&delete this._handlers[g]}setHandlerFallback(g){this._handlerFb=g}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=c}reset(){if(this._state===2)for(let g=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;g>=0;--g)this._active[g].end(!1);this._stack.paused=!1,this._active=c,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||c,this._active.length)for(let g=this._active.length-1;g>=0;g--)this._active[g].start();else this._handlerFb(this._id,"START")}_put(g,S,w){if(this._active.length)for(let m=this._active.length-1;m>=0;m--)this._active[m].put(g,S,w);else this._handlerFb(this._id,"PUT",(0,p.utf32ToString)(g,S,w))}start(){this.reset(),this._state=1}put(g,S,w){if(this._state!==3){if(this._state===1)for(;S<w;){const m=g[S++];if(m===59){this._state=2,this._start();break}if(m<48||57<m)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+m-48}this._state===2&&w-S>0&&this._put(g,S,w)}}end(g,S=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let w=!1,m=this._active.length-1,o=!1;if(this._stack.paused&&(m=this._stack.loopPosition-1,w=S,o=this._stack.fallThrough,this._stack.paused=!1),!o&&w===!1){for(;m>=0&&(w=this._active[m].end(g),w!==!0);m--)if(w instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=m,this._stack.fallThrough=!1,w;m--}for(;m>=0;m--)if(w=this._active[m].end(!1),w instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=m,this._stack.fallThrough=!0,w}else this._handlerFb(this._id,"END",g);this._active=c,this._id=-1,this._state=0}}},n.OscHandler=class{constructor(g){this._handler=g,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(g,S,w){this._hitLimit||(this._data+=(0,p.utf32ToString)(g,S,w),this._data.length>u.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(g){let S=!1;if(this._hitLimit)S=!1;else if(g&&(S=this._handler(this._data),S instanceof Promise))return S.then(w=>(this._data="",this._hitLimit=!1,w));return this._data="",this._hitLimit=!1,S}}},8742:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Params=void 0;const a=2147483647;class u{static fromArray(c){const g=new u;if(!c.length)return g;for(let S=Array.isArray(c[0])?1:0;S<c.length;++S){const w=c[S];if(Array.isArray(w))for(let m=0;m<w.length;++m)g.addSubParam(w[m]);else g.addParam(w)}return g}constructor(c=32,g=32){if(this.maxLength=c,this.maxSubParamsLength=g,g>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(c),this.length=0,this._subParams=new Int32Array(g),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(c),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const c=new u(this.maxLength,this.maxSubParamsLength);return c.params.set(this.params),c.length=this.length,c._subParams.set(this._subParams),c._subParamsLength=this._subParamsLength,c._subParamsIdx.set(this._subParamsIdx),c._rejectDigits=this._rejectDigits,c._rejectSubDigits=this._rejectSubDigits,c._digitIsSub=this._digitIsSub,c}toArray(){const c=[];for(let g=0;g<this.length;++g){c.push(this.params[g]);const S=this._subParamsIdx[g]>>8,w=255&this._subParamsIdx[g];w-S>0&&c.push(Array.prototype.slice.call(this._subParams,S,w))}return c}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(c){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(c<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=c>a?a:c}}addSubParam(c){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(c<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=c>a?a:c,this._subParamsIdx[this.length-1]++}}hasSubParams(c){return(255&this._subParamsIdx[c])-(this._subParamsIdx[c]>>8)>0}getSubParams(c){const g=this._subParamsIdx[c]>>8,S=255&this._subParamsIdx[c];return S-g>0?this._subParams.subarray(g,S):null}getSubParamsAll(){const c={};for(let g=0;g<this.length;++g){const S=this._subParamsIdx[g]>>8,w=255&this._subParamsIdx[g];w-S>0&&(c[g]=this._subParams.slice(S,w))}return c}addDigit(c){let g;if(this._rejectDigits||!(g=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const S=this._digitIsSub?this._subParams:this.params,w=S[g-1];S[g-1]=~w?Math.min(10*w+c,a):c}}n.Params=u},5741:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.AddonManager=void 0,n.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let a=this._addons.length-1;a>=0;a--)this._addons[a].instance.dispose()}loadAddon(a,u){const p={instance:u,dispose:u.dispose,isDisposed:!1};this._addons.push(p),u.dispose=()=>this._wrappedAddonDispose(p),u.activate(a)}_wrappedAddonDispose(a){if(a.isDisposed)return;let u=-1;for(let p=0;p<this._addons.length;p++)if(this._addons[p]===a){u=p;break}if(u===-1)throw new Error("Could not dispose an addon that has not been loaded");a.isDisposed=!0,a.dispose.apply(a.instance),this._addons.splice(u,1)}}},8771:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferApiView=void 0;const u=a(3785),p=a(511);n.BufferApiView=class{constructor(c,g){this._buffer=c,this.type=g}init(c){return this._buffer=c,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(c){const g=this._buffer.lines.get(c);if(g)return new u.BufferLineApiView(g)}getNullCell(){return new p.CellData}}},3785:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferLineApiView=void 0;const u=a(511);n.BufferLineApiView=class{constructor(p){this._line=p}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(p,c){if(!(p<0||p>=this._line.length))return c?(this._line.loadCell(p,c),c):this._line.loadCell(p,new u.CellData)}translateToString(p,c,g){return this._line.translateToString(p,c,g)}}},8285:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferNamespaceApi=void 0;const u=a(8771),p=a(8460),c=a(844);class g extends c.Disposable{constructor(w){super(),this._core=w,this._onBufferChange=this.register(new p.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new u.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new u.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}n.BufferNamespaceApi=g},7975:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ParserApi=void 0,n.ParserApi=class{constructor(a){this._core=a}registerCsiHandler(a,u){return this._core.registerCsiHandler(a,p=>u(p.toArray()))}addCsiHandler(a,u){return this.registerCsiHandler(a,u)}registerDcsHandler(a,u){return this._core.registerDcsHandler(a,(p,c)=>u(p,c.toArray()))}addDcsHandler(a,u){return this.registerDcsHandler(a,u)}registerEscHandler(a,u){return this._core.registerEscHandler(a,u)}addEscHandler(a,u){return this.registerEscHandler(a,u)}registerOscHandler(a,u){return this._core.registerOscHandler(a,u)}addOscHandler(a,u){return this.registerOscHandler(a,u)}}},7090:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeApi=void 0,n.UnicodeApi=class{constructor(a){this._core=a}register(a){this._core.unicodeService.register(a)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(a){this._core.unicodeService.activeVersion=a}}},744:function(_,n,a){var u=this&&this.__decorate||function(o,h,l,f){var v,b=arguments.length,C=b<3?h:f===null?f=Object.getOwnPropertyDescriptor(h,l):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(o,h,l,f);else for(var M=o.length-1;M>=0;M--)(v=o[M])&&(C=(b<3?v(C):b>3?v(h,l,C):v(h,l))||C);return b>3&&C&&Object.defineProperty(h,l,C),C},p=this&&this.__param||function(o,h){return function(l,f){h(l,f,o)}};Object.defineProperty(n,"__esModule",{value:!0}),n.BufferService=n.MINIMUM_ROWS=n.MINIMUM_COLS=void 0;const c=a(8460),g=a(844),S=a(5295),w=a(2585);n.MINIMUM_COLS=2,n.MINIMUM_ROWS=1;let m=n.BufferService=class extends g.Disposable{get buffer(){return this.buffers.active}constructor(o){super(),this.isUserScrolling=!1,this._onResize=this.register(new c.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new c.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(o.rawOptions.cols||0,n.MINIMUM_COLS),this.rows=Math.max(o.rawOptions.rows||0,n.MINIMUM_ROWS),this.buffers=this.register(new S.BufferSet(o,this))}resize(o,h){this.cols=o,this.rows=h,this.buffers.resize(o,h),this._onResize.fire({cols:o,rows:h})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(o,h=!1){const l=this.buffer;let f;f=this._cachedBlankLine,f&&f.length===this.cols&&f.getFg(0)===o.fg&&f.getBg(0)===o.bg||(f=l.getBlankLine(o,h),this._cachedBlankLine=f),f.isWrapped=h;const v=l.ybase+l.scrollTop,b=l.ybase+l.scrollBottom;if(l.scrollTop===0){const C=l.lines.isFull;b===l.lines.length-1?C?l.lines.recycle().copyFrom(f):l.lines.push(f.clone()):l.lines.splice(b+1,0,f.clone()),C?this.isUserScrolling&&(l.ydisp=Math.max(l.ydisp-1,0)):(l.ybase++,this.isUserScrolling||l.ydisp++)}else{const C=b-v+1;l.lines.shiftElements(v+1,C-1,-1),l.lines.set(b,f.clone())}this.isUserScrolling||(l.ydisp=l.ybase),this._onScroll.fire(l.ydisp)}scrollLines(o,h,l){const f=this.buffer;if(o<0){if(f.ydisp===0)return;this.isUserScrolling=!0}else o+f.ydisp>=f.ybase&&(this.isUserScrolling=!1);const v=f.ydisp;f.ydisp=Math.max(Math.min(f.ydisp+o,f.ybase),0),v!==f.ydisp&&(h||this._onScroll.fire(f.ydisp))}};n.BufferService=m=u([p(0,w.IOptionsService)],m)},7994:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CharsetService=void 0,n.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(a){this.glevel=a,this.charset=this._charsets[a]}setgCharset(a,u){this._charsets[a]=u,this.glevel===a&&(this.charset=u)}}},1753:function(_,n,a){var u=this&&this.__decorate||function(f,v,b,C){var M,y=arguments.length,E=y<3?v:C===null?C=Object.getOwnPropertyDescriptor(v,b):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(f,v,b,C);else for(var B=f.length-1;B>=0;B--)(M=f[B])&&(E=(y<3?M(E):y>3?M(v,b,E):M(v,b))||E);return y>3&&E&&Object.defineProperty(v,b,E),E},p=this&&this.__param||function(f,v){return function(b,C){v(b,C,f)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CoreMouseService=void 0;const c=a(2585),g=a(8460),S=a(844),w={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:f=>f.button!==4&&f.action===1&&(f.ctrl=!1,f.alt=!1,f.shift=!1,!0)},VT200:{events:19,restrict:f=>f.action!==32},DRAG:{events:23,restrict:f=>f.action!==32||f.button!==3},ANY:{events:31,restrict:f=>!0}};function m(f,v){let b=(f.ctrl?16:0)|(f.shift?4:0)|(f.alt?8:0);return f.button===4?(b|=64,b|=f.action):(b|=3&f.button,4&f.button&&(b|=64),8&f.button&&(b|=128),f.action===32?b|=32:f.action!==0||v||(b|=3)),b}const o=String.fromCharCode,h={DEFAULT:f=>{const v=[m(f,!1)+32,f.col+32,f.row+32];return v[0]>255||v[1]>255||v[2]>255?"":`\x1B[M${o(v[0])}${o(v[1])}${o(v[2])}`},SGR:f=>{const v=f.action===0&&f.button!==4?"m":"M";return`\x1B[<${m(f,!0)};${f.col};${f.row}${v}`},SGR_PIXELS:f=>{const v=f.action===0&&f.button!==4?"m":"M";return`\x1B[<${m(f,!0)};${f.x};${f.y}${v}`}};let l=n.CoreMouseService=class extends S.Disposable{constructor(f,v){super(),this._bufferService=f,this._coreService=v,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new g.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const b of Object.keys(w))this.addProtocol(b,w[b]);for(const b of Object.keys(h))this.addEncoding(b,h[b]);this.reset()}addProtocol(f,v){this._protocols[f]=v}addEncoding(f,v){this._encodings[f]=v}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(f){if(!this._protocols[f])throw new Error(`unknown protocol "${f}"`);this._activeProtocol=f,this._onProtocolChange.fire(this._protocols[f].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(f){if(!this._encodings[f])throw new Error(`unknown encoding "${f}"`);this._activeEncoding=f}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(f){if(f.col<0||f.col>=this._bufferService.cols||f.row<0||f.row>=this._bufferService.rows||f.button===4&&f.action===32||f.button===3&&f.action!==32||f.button!==4&&(f.action===2||f.action===3)||(f.col++,f.row++,f.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,f,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(f))return!1;const v=this._encodings[this._activeEncoding](f);return v&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(v):this._coreService.triggerDataEvent(v,!0)),this._lastEvent=f,!0}explainEvents(f){return{down:!!(1&f),up:!!(2&f),drag:!!(4&f),move:!!(8&f),wheel:!!(16&f)}}_equalEvents(f,v,b){if(b){if(f.x!==v.x||f.y!==v.y)return!1}else if(f.col!==v.col||f.row!==v.row)return!1;return f.button===v.button&&f.action===v.action&&f.ctrl===v.ctrl&&f.alt===v.alt&&f.shift===v.shift}};n.CoreMouseService=l=u([p(0,c.IBufferService),p(1,c.ICoreService)],l)},6975:function(_,n,a){var u=this&&this.__decorate||function(l,f,v,b){var C,M=arguments.length,y=M<3?f:b===null?b=Object.getOwnPropertyDescriptor(f,v):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(l,f,v,b);else for(var E=l.length-1;E>=0;E--)(C=l[E])&&(y=(M<3?C(y):M>3?C(f,v,y):C(f,v))||y);return M>3&&y&&Object.defineProperty(f,v,y),y},p=this&&this.__param||function(l,f){return function(v,b){f(v,b,l)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CoreService=void 0;const c=a(1439),g=a(8460),S=a(844),w=a(2585),m=Object.freeze({insertMode:!1}),o=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let h=n.CoreService=class extends S.Disposable{constructor(l,f,v){super(),this._bufferService=l,this._logService=f,this._optionsService=v,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new g.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new g.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new g.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new g.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,c.clone)(m),this.decPrivateModes=(0,c.clone)(o)}reset(){this.modes=(0,c.clone)(m),this.decPrivateModes=(0,c.clone)(o)}triggerDataEvent(l,f=!1){if(this._optionsService.rawOptions.disableStdin)return;const v=this._bufferService.buffer;f&&this._optionsService.rawOptions.scrollOnUserInput&&v.ybase!==v.ydisp&&this._onRequestScrollToBottom.fire(),f&&this._onUserInput.fire(),this._logService.debug(`sending data "${l}"`,()=>l.split("").map(b=>b.charCodeAt(0))),this._onData.fire(l)}triggerBinaryEvent(l){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${l}"`,()=>l.split("").map(f=>f.charCodeAt(0))),this._onBinary.fire(l))}};n.CoreService=h=u([p(0,w.IBufferService),p(1,w.ILogService),p(2,w.IOptionsService)],h)},9074:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DecorationService=void 0;const u=a(8055),p=a(8460),c=a(844),g=a(6106);let S=0,w=0;class m extends c.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new g.SortedList(l=>l==null?void 0:l.marker.line),this._onDecorationRegistered=this.register(new p.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new p.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,c.toDisposable)(()=>this.reset()))}registerDecoration(l){if(l.marker.isDisposed)return;const f=new o(l);if(f){const v=f.marker.onDispose(()=>f.dispose());f.onDispose(()=>{f&&(this._decorations.delete(f)&&this._onDecorationRemoved.fire(f),v.dispose())}),this._decorations.insert(f),this._onDecorationRegistered.fire(f)}return f}reset(){for(const l of this._decorations.values())l.dispose();this._decorations.clear()}*getDecorationsAtCell(l,f,v){var b,C,M;let y=0,E=0;for(const B of this._decorations.getKeyIterator(f))y=(b=B.options.x)!==null&&b!==void 0?b:0,E=y+((C=B.options.width)!==null&&C!==void 0?C:1),l>=y&&l<E&&(!v||((M=B.options.layer)!==null&&M!==void 0?M:"bottom")===v)&&(yield B)}forEachDecorationAtCell(l,f,v,b){this._decorations.forEachByKey(f,C=>{var M,y,E;S=(M=C.options.x)!==null&&M!==void 0?M:0,w=S+((y=C.options.width)!==null&&y!==void 0?y:1),l>=S&&l<w&&(!v||((E=C.options.layer)!==null&&E!==void 0?E:"bottom")===v)&&b(C)})}}n.DecorationService=m;class o extends c.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=u.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=u.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(l){super(),this.options=l,this.onRenderEmitter=this.register(new p.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new p.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=l.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.InstantiationService=n.ServiceCollection=void 0;const u=a(2585),p=a(8343);class c{constructor(...S){this._entries=new Map;for(const[w,m]of S)this.set(w,m)}set(S,w){const m=this._entries.get(S);return this._entries.set(S,w),m}forEach(S){for(const[w,m]of this._entries.entries())S(w,m)}has(S){return this._entries.has(S)}get(S){return this._entries.get(S)}}n.ServiceCollection=c,n.InstantiationService=class{constructor(){this._services=new c,this._services.set(u.IInstantiationService,this)}setService(g,S){this._services.set(g,S)}getService(g){return this._services.get(g)}createInstance(g,...S){const w=(0,p.getServiceDependencies)(g).sort((h,l)=>h.index-l.index),m=[];for(const h of w){const l=this._services.get(h.id);if(!l)throw new Error(`[createInstance] ${g.name} depends on UNKNOWN service ${h.id}.`);m.push(l)}const o=w.length>0?w[0].index:S.length;if(S.length!==o)throw new Error(`[createInstance] First service dependency of ${g.name} at position ${o+1} conflicts with ${S.length} static arguments`);return new g(...S,...m)}}},7866:function(_,n,a){var u=this&&this.__decorate||function(o,h,l,f){var v,b=arguments.length,C=b<3?h:f===null?f=Object.getOwnPropertyDescriptor(h,l):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(o,h,l,f);else for(var M=o.length-1;M>=0;M--)(v=o[M])&&(C=(b<3?v(C):b>3?v(h,l,C):v(h,l))||C);return b>3&&C&&Object.defineProperty(h,l,C),C},p=this&&this.__param||function(o,h){return function(l,f){h(l,f,o)}};Object.defineProperty(n,"__esModule",{value:!0}),n.traceCall=n.setTraceLogger=n.LogService=void 0;const c=a(844),g=a(2585),S={trace:g.LogLevelEnum.TRACE,debug:g.LogLevelEnum.DEBUG,info:g.LogLevelEnum.INFO,warn:g.LogLevelEnum.WARN,error:g.LogLevelEnum.ERROR,off:g.LogLevelEnum.OFF};let w,m=n.LogService=class extends c.Disposable{get logLevel(){return this._logLevel}constructor(o){super(),this._optionsService=o,this._logLevel=g.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),w=this}_updateLogLevel(){this._logLevel=S[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(o){for(let h=0;h<o.length;h++)typeof o[h]=="function"&&(o[h]=o[h]())}_log(o,h,l){this._evalLazyOptionalParams(l),o.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+h,...l)}trace(o,...h){var l,f;this._logLevel<=g.LogLevelEnum.TRACE&&this._log((f=(l=this._optionsService.options.logger)===null||l===void 0?void 0:l.trace.bind(this._optionsService.options.logger))!==null&&f!==void 0?f:console.log,o,h)}debug(o,...h){var l,f;this._logLevel<=g.LogLevelEnum.DEBUG&&this._log((f=(l=this._optionsService.options.logger)===null||l===void 0?void 0:l.debug.bind(this._optionsService.options.logger))!==null&&f!==void 0?f:console.log,o,h)}info(o,...h){var l,f;this._logLevel<=g.LogLevelEnum.INFO&&this._log((f=(l=this._optionsService.options.logger)===null||l===void 0?void 0:l.info.bind(this._optionsService.options.logger))!==null&&f!==void 0?f:console.info,o,h)}warn(o,...h){var l,f;this._logLevel<=g.LogLevelEnum.WARN&&this._log((f=(l=this._optionsService.options.logger)===null||l===void 0?void 0:l.warn.bind(this._optionsService.options.logger))!==null&&f!==void 0?f:console.warn,o,h)}error(o,...h){var l,f;this._logLevel<=g.LogLevelEnum.ERROR&&this._log((f=(l=this._optionsService.options.logger)===null||l===void 0?void 0:l.error.bind(this._optionsService.options.logger))!==null&&f!==void 0?f:console.error,o,h)}};n.LogService=m=u([p(0,g.IOptionsService)],m),n.setTraceLogger=function(o){w=o},n.traceCall=function(o,h,l){if(typeof l.value!="function")throw new Error("not supported");const f=l.value;l.value=function(...v){if(w.logLevel!==g.LogLevelEnum.TRACE)return f.apply(this,v);w.trace(`GlyphRenderer#${f.name}(${v.map(C=>JSON.stringify(C)).join(", ")})`);const b=f.apply(this,v);return w.trace(`GlyphRenderer#${f.name} return`,b),b}}},7302:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.OptionsService=n.DEFAULT_OPTIONS=void 0;const u=a(8460),p=a(844),c=a(6114);n.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:c.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const g=["normal","bold","100","200","300","400","500","600","700","800","900"];class S extends p.Disposable{constructor(m){super(),this._onOptionChange=this.register(new u.EventEmitter),this.onOptionChange=this._onOptionChange.event;const o=Object.assign({},n.DEFAULT_OPTIONS);for(const h in m)if(h in o)try{const l=m[h];o[h]=this._sanitizeAndValidateOption(h,l)}catch(l){console.error(l)}this.rawOptions=o,this.options=Object.assign({},o),this._setupOptions()}onSpecificOptionChange(m,o){return this.onOptionChange(h=>{h===m&&o(this.rawOptions[m])})}onMultipleOptionChange(m,o){return this.onOptionChange(h=>{m.indexOf(h)!==-1&&o()})}_setupOptions(){const m=h=>{if(!(h in n.DEFAULT_OPTIONS))throw new Error(`No option with key "${h}"`);return this.rawOptions[h]},o=(h,l)=>{if(!(h in n.DEFAULT_OPTIONS))throw new Error(`No option with key "${h}"`);l=this._sanitizeAndValidateOption(h,l),this.rawOptions[h]!==l&&(this.rawOptions[h]=l,this._onOptionChange.fire(h))};for(const h in this.rawOptions){const l={get:m.bind(this,h),set:o.bind(this,h)};Object.defineProperty(this.options,h,l)}}_sanitizeAndValidateOption(m,o){switch(m){case"cursorStyle":if(o||(o=n.DEFAULT_OPTIONS[m]),!function(h){return h==="block"||h==="underline"||h==="bar"}(o))throw new Error(`"${o}" is not a valid value for ${m}`);break;case"wordSeparator":o||(o=n.DEFAULT_OPTIONS[m]);break;case"fontWeight":case"fontWeightBold":if(typeof o=="number"&&1<=o&&o<=1e3)break;o=g.includes(o)?o:n.DEFAULT_OPTIONS[m];break;case"cursorWidth":o=Math.floor(o);case"lineHeight":case"tabStopWidth":if(o<1)throw new Error(`${m} cannot be less than 1, value: ${o}`);break;case"minimumContrastRatio":o=Math.max(1,Math.min(21,Math.round(10*o)/10));break;case"scrollback":if((o=Math.min(o,4294967295))<0)throw new Error(`${m} cannot be less than 0, value: ${o}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(o<=0)throw new Error(`${m} cannot be less than or equal to 0, value: ${o}`);break;case"rows":case"cols":if(!o&&o!==0)throw new Error(`${m} must be numeric, value: ${o}`);break;case"windowsPty":o=o??{}}return o}}n.OptionsService=S},2660:function(_,n,a){var u=this&&this.__decorate||function(S,w,m,o){var h,l=arguments.length,f=l<3?w:o===null?o=Object.getOwnPropertyDescriptor(w,m):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(S,w,m,o);else for(var v=S.length-1;v>=0;v--)(h=S[v])&&(f=(l<3?h(f):l>3?h(w,m,f):h(w,m))||f);return l>3&&f&&Object.defineProperty(w,m,f),f},p=this&&this.__param||function(S,w){return function(m,o){w(m,o,S)}};Object.defineProperty(n,"__esModule",{value:!0}),n.OscLinkService=void 0;const c=a(2585);let g=n.OscLinkService=class{constructor(S){this._bufferService=S,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(S){const w=this._bufferService.buffer;if(S.id===void 0){const v=w.addMarker(w.ybase+w.y),b={data:S,id:this._nextId++,lines:[v]};return v.onDispose(()=>this._removeMarkerFromLink(b,v)),this._dataByLinkId.set(b.id,b),b.id}const m=S,o=this._getEntryIdKey(m),h=this._entriesWithId.get(o);if(h)return this.addLineToLink(h.id,w.ybase+w.y),h.id;const l=w.addMarker(w.ybase+w.y),f={id:this._nextId++,key:this._getEntryIdKey(m),data:m,lines:[l]};return l.onDispose(()=>this._removeMarkerFromLink(f,l)),this._entriesWithId.set(f.key,f),this._dataByLinkId.set(f.id,f),f.id}addLineToLink(S,w){const m=this._dataByLinkId.get(S);if(m&&m.lines.every(o=>o.line!==w)){const o=this._bufferService.buffer.addMarker(w);m.lines.push(o),o.onDispose(()=>this._removeMarkerFromLink(m,o))}}getLinkData(S){var w;return(w=this._dataByLinkId.get(S))===null||w===void 0?void 0:w.data}_getEntryIdKey(S){return`${S.id};;${S.uri}`}_removeMarkerFromLink(S,w){const m=S.lines.indexOf(w);m!==-1&&(S.lines.splice(m,1),S.lines.length===0&&(S.data.id!==void 0&&this._entriesWithId.delete(S.key),this._dataByLinkId.delete(S.id)))}};n.OscLinkService=g=u([p(0,c.IBufferService)],g)},8343:(_,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createDecorator=n.getServiceDependencies=n.serviceRegistry=void 0;const a="di$target",u="di$dependencies";n.serviceRegistry=new Map,n.getServiceDependencies=function(p){return p[u]||[]},n.createDecorator=function(p){if(n.serviceRegistry.has(p))return n.serviceRegistry.get(p);const c=function(g,S,w){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(m,o,h){o[a]===o?o[u].push({id:m,index:h}):(o[u]=[{id:m,index:h}],o[a]=o)})(c,g,w)};return c.toString=()=>p,n.serviceRegistry.set(p,c),c}},2585:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.IDecorationService=n.IUnicodeService=n.IOscLinkService=n.IOptionsService=n.ILogService=n.LogLevelEnum=n.IInstantiationService=n.ICharsetService=n.ICoreService=n.ICoreMouseService=n.IBufferService=void 0;const u=a(8343);var p;n.IBufferService=(0,u.createDecorator)("BufferService"),n.ICoreMouseService=(0,u.createDecorator)("CoreMouseService"),n.ICoreService=(0,u.createDecorator)("CoreService"),n.ICharsetService=(0,u.createDecorator)("CharsetService"),n.IInstantiationService=(0,u.createDecorator)("InstantiationService"),function(c){c[c.TRACE=0]="TRACE",c[c.DEBUG=1]="DEBUG",c[c.INFO=2]="INFO",c[c.WARN=3]="WARN",c[c.ERROR=4]="ERROR",c[c.OFF=5]="OFF"}(p||(n.LogLevelEnum=p={})),n.ILogService=(0,u.createDecorator)("LogService"),n.IOptionsService=(0,u.createDecorator)("OptionsService"),n.IOscLinkService=(0,u.createDecorator)("OscLinkService"),n.IUnicodeService=(0,u.createDecorator)("UnicodeService"),n.IDecorationService=(0,u.createDecorator)("DecorationService")},1480:(_,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeService=void 0;const u=a(8460),p=a(225);n.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new u.EventEmitter,this.onChange=this._onChange.event;const c=new p.UnicodeV6;this.register(c),this._active=c.version,this._activeProvider=c}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(c){if(!this._providers[c])throw new Error(`unknown Unicode version "${c}"`);this._active=c,this._activeProvider=this._providers[c],this._onChange.fire(c)}register(c){this._providers[c.version]=c}wcwidth(c){return this._activeProvider.wcwidth(c)}getStringCellWidth(c){let g=0;const S=c.length;for(let w=0;w<S;++w){let m=c.charCodeAt(w);if(55296<=m&&m<=56319){if(++w>=S)return g+this.wcwidth(m);const o=c.charCodeAt(w);56320<=o&&o<=57343?m=1024*(m-55296)+o-56320+65536:g+=this.wcwidth(o)}g+=this.wcwidth(m)}return g}}}},r={};function s(_){var n=r[_];if(n!==void 0)return n.exports;var a=r[_]={exports:{}};return e[_].call(a.exports,a,a.exports,s),a.exports}var d={};return(()=>{var _=d;Object.defineProperty(_,"__esModule",{value:!0}),_.Terminal=void 0;const n=s(9042),a=s(3236),u=s(844),p=s(5741),c=s(8285),g=s(7975),S=s(7090),w=["cols","rows"];class m extends u.Disposable{constructor(h){super(),this._core=this.register(new a.Terminal(h)),this._addonManager=this.register(new p.AddonManager),this._publicOptions=Object.assign({},this._core.options);const l=v=>this._core.options[v],f=(v,b)=>{this._checkReadonlyOptions(v),this._core.options[v]=b};for(const v in this._core.options){const b={get:l.bind(this,v),set:f.bind(this,v)};Object.defineProperty(this._publicOptions,v,b)}}_checkReadonlyOptions(h){if(w.includes(h))throw new Error(`Option "${h}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new g.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new S.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new c.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const h=this._core.coreService.decPrivateModes;let l="none";switch(this._core.coreMouseService.activeProtocol){case"X10":l="x10";break;case"VT200":l="vt200";break;case"DRAG":l="drag";break;case"ANY":l="any"}return{applicationCursorKeysMode:h.applicationCursorKeys,applicationKeypadMode:h.applicationKeypad,bracketedPasteMode:h.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:l,originMode:h.origin,reverseWraparoundMode:h.reverseWraparound,sendFocusMode:h.sendFocus,wraparoundMode:h.wraparound}}get options(){return this._publicOptions}set options(h){for(const l in h)this._publicOptions[l]=h[l]}blur(){this._core.blur()}focus(){this._core.focus()}resize(h,l){this._verifyIntegers(h,l),this._core.resize(h,l)}open(h){this._core.open(h)}attachCustomKeyEventHandler(h){this._core.attachCustomKeyEventHandler(h)}registerLinkProvider(h){return this._core.registerLinkProvider(h)}registerCharacterJoiner(h){return this._checkProposedApi(),this._core.registerCharacterJoiner(h)}deregisterCharacterJoiner(h){this._checkProposedApi(),this._core.deregisterCharacterJoiner(h)}registerMarker(h=0){return this._verifyIntegers(h),this._core.registerMarker(h)}registerDecoration(h){var l,f,v;return this._checkProposedApi(),this._verifyPositiveIntegers((l=h.x)!==null&&l!==void 0?l:0,(f=h.width)!==null&&f!==void 0?f:0,(v=h.height)!==null&&v!==void 0?v:0),this._core.registerDecoration(h)}hasSelection(){return this._core.hasSelection()}select(h,l,f){this._verifyIntegers(h,l,f),this._core.select(h,l,f)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(h,l){this._verifyIntegers(h,l),this._core.selectLines(h,l)}dispose(){super.dispose()}scrollLines(h){this._verifyIntegers(h),this._core.scrollLines(h)}scrollPages(h){this._verifyIntegers(h),this._core.scrollPages(h)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(h){this._verifyIntegers(h),this._core.scrollToLine(h)}clear(){this._core.clear()}write(h,l){this._core.write(h,l)}writeln(h,l){this._core.write(h),this._core.write(`\r
`,l)}paste(h){this._core.paste(h)}refresh(h,l){this._verifyIntegers(h,l),this._core.refresh(h,l)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(h){this._addonManager.loadAddon(this,h)}static get strings(){return n}_verifyIntegers(...h){for(const l of h)if(l===1/0||isNaN(l)||l%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...h){for(const l of h)if(l&&(l===1/0||isNaN(l)||l%1!=0||l<0))throw new Error("This API only accepts positive integers")}}_.Terminal=m})(),d})())})(Ks);var Uh=Ks.exports,Xs={exports:{}};(function(i,t){(function(e,r){i.exports=r()})(self,()=>(()=>{var e={};return(()=>{var r=e;Object.defineProperty(r,"__esModule",{value:!0}),r.FitAddon=void 0,r.FitAddon=class{activate(s){this._terminal=s}dispose(){}fit(){const s=this.proposeDimensions();if(!s||!this._terminal||isNaN(s.cols)||isNaN(s.rows))return;const d=this._terminal._core;this._terminal.rows===s.rows&&this._terminal.cols===s.cols||(d._renderService.clear(),this._terminal.resize(s.cols,s.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const s=this._terminal._core,d=s._renderService.dimensions;if(d.css.cell.width===0||d.css.cell.height===0)return;const _=this._terminal.options.scrollback===0?0:s.viewport.scrollBarWidth,n=window.getComputedStyle(this._terminal.element.parentElement),a=parseInt(n.getPropertyValue("height")),u=Math.max(0,parseInt(n.getPropertyValue("width"))),p=window.getComputedStyle(this._terminal.element),c=a-(parseInt(p.getPropertyValue("padding-top"))+parseInt(p.getPropertyValue("padding-bottom"))),g=u-(parseInt(p.getPropertyValue("padding-right"))+parseInt(p.getPropertyValue("padding-left")))-_;return{cols:Math.max(2,Math.floor(g/d.css.cell.width)),rows:Math.max(1,Math.floor(c/d.css.cell.height))}}}})(),e})())})(Xs);var Vh=Xs.exports;const Kh=()=>{const i=X.useRef(null),t=X.useRef(null),e=X.useRef(new Vh.FitAddon);return X.useEffect(()=>{if(i.current&&!t.current){t.current=new Uh.Terminal({fontSize:13,fontFamily:'"Fira Code", monospace',theme:{background:"#161b22",foreground:"#c9d1d9",cursor:"#c9d1d9",black:"#21262d",red:"#ff7b72",green:"#56d364",yellow:"#e3b341",blue:"#58a6ff",magenta:"#bc8cff",cyan:"#79c0ff",white:"#c9d1d9"},convertEol:!0,disableStdin:!0});const s=t.current;s.loadAddon(e.current),s.open(i.current),e.current.fit(),s.writeln("[\x1B[34mHelios AI Quant Engine\x1B[0m] Rationale Log Initialized."),s.writeln("Awaiting analysis commands...")}const r=new ResizeObserver(()=>{e.current.fit()});return i.current&&r.observe(i.current),()=>{r.disconnect()}},[]),Q.jsx("div",{ref:i,style:{height:"100%",width:"100%"}})},Xh=()=>{const{t:i}=vn(),t=X.useRef(null),[e,r]=X.useState("1h"),[s,d]=X.useState([]),[_,n]=X.useState(!0);return X.useEffect(()=>{(async()=>{n(!0);try{const p=await(await fetch(`http://localhost:3001/api/analysis/history?timeframe=${e}`)).json();d(p)}catch(u){console.error("Error fetching dynamic timeframe data:",u)}finally{n(!1)}})()},[e]),Q.jsxs(se,{className:"workspace-technical",sx:{display:"flex",flexDirection:"column",height:"100%"},children:[Q.jsxs(se,{className:"chart-controls-toolbar",sx:{mb:2,display:"flex",gap:2},children:[Q.jsx(jo,{variant:"outlined","aria-label":"chart timeframe",children:["15m","1h","4h","1d"].map(a=>Q.jsx(mr,{onClick:()=>r(a),variant:e===a?"contained":"outlined",children:a.toUpperCase()},a))}),Q.jsx(Yo,{title:i("analysisCenter.drawingToolsTooltip"),children:Q.jsx("span",{children:Q.jsx(mr,{variant:"outlined",disabled:!0,children:i("analysisCenter.drawingToolsLabel")})})})]}),Q.jsxs(se,{className:"technical-layout",sx:{display:"flex",flexGrow:1,height:"calc(100% - 52px)"},children:[Q.jsx(se,{className:"main-chart-container",sx:{flexGrow:1,position:"relative"},children:_||s.length===0?Q.jsx(se,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:Q.jsx(ls,{})}):Q.jsx(jh,{ref:t,initialData:s})}),Q.jsx(se,{className:"explainer-log-wrapper",sx:{width:"30%",maxWidth:"450px",height:"100%",borderLeft:"1px solid #30363d",pl:2},children:Q.jsx(Kh,{})})]})]})};export{Xh as default};
//# sourceMappingURL=WorkspaceTechnical-BKkEAjQP.js.map
